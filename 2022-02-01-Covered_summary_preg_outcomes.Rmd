---
title: "COVERED summary pregnancy and infant oucomes" 
author: "Arianne Albert, PhD, and Ulrike Mayer, PhD"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---
  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, include = FALSE)
# options(digits = 2)
library(Gmisc)  #needed for table
library(broman)
library(pander)
library(knitr)
library(dplyr)
library(MASS)
library(multcomp)
library(effects)
library(emmeans)
library(DescTools)
library(tidyverse)
library(margins)
library(sjPlot)
library(here)
library(janitor)
library(huxtable)
library(flextable)
library(haven)
library(mgcv)
library(ggeffects)
library(lme4)
library(lmerTest)
library(interactions)
library(pubh)
library(lubridate) #for time_length()
library(ggpubr)
library(ggplot2)
library(ggthemes)
library(MatchIt)  #install.packages("MatchIt")
library(Gmisc)
library(RColorBrewer)
library(lubridate)
library(Hmisc)
library(broman)
#library(rcompanion)
#library(directlabels)
#library(survey)
#library(kableExtra)
#library(psych)
#library(quantreg)
#library(zoo)
#library(geepack)
#library(sjstats)
#library(stringr)   # for str.glue
#library(ordinal)   #for clm ordered logistic regression
#library(summarytools)
#library(plyr)
#library("colorspace")
#library(summarytools)

my.swatch <- c("#111111", "#551A8B", "#a6db5c", "#65ADC2", "#E84646", "#233B43",  "#C29365", "#362C21", "#316675", "#168E7F", "#109B37")

```

```{r load data}

data1 <- read.csv(here("2021-12-01_COVERED_DATA.csv"))#, stringsAsFactors = TRUE, strip.white = TRUE)
head(data1)
nrow(data1)  #5076
#view(data1)

data1 <- data1[!is.na(data1$record_id),]
nrow(data1) #5076


# internal comparison group: women who were not vaccinated during pregnancy - answered yes to bl3_after_march
# bl3_after_march only visible for those who are currently not pregnant
# keep the missing numbers as those are the pregnant ones.
describeFactors(data1$bl3_after_march)
data1$bl3_after_march <- factor(data1$bl3_after_march, levels = c(1), labels = c("Yes"))
describeFactors(data1$bl3_after_march)
#Yes     "2,623 (51.7%)"
#Missing "2,453 (48.3%)"

```



```{r preprocess pregnancy outcomes}

#Baby DOB (p3ii_babydob is only preterm birth - otherwise i1_dob1 baby DOB)
data1$i1_dob1.comb <- mapply(paste, data1$i1_dob1, data1$i1_dob1.2mo, data1$i1_dob1.4mo, sep="/")

describeFactors(data1$i1_dob1.comb)
data1$i1_dob1.comb <- gsub("/NA","",data1$i1_dob1.comb)
data1$i1_dob1.comb <- gsub("NA/","",data1$i1_dob1.comb)
describeFactors(data1$i1_dob1.comb)

#three dates are typos 2022-04-16, 2010-09-10 and 0821-04-01
#check estimated delivery date for those dates
#View(data1[(data1$i1_dob1.comb == "2022-04-16"| data1$i1_dob1.comb == "2010-09-10" | data1$i1_dob1.comb == "0821-04-01") & !is.na(data1$i1_dob1.comb), c("i1_dob1.comb", "bl1a_delive.4mo_date", "bl6_dose1_date","dose1_preg","bl10_dose2_date", "dose2_preg")])

data1$record_id[data1$i1_dob1.comb == "2010-09-10"] #3316
data1$i1_dob1.comb[data1$i1_dob1.comb == "2010-09-10"] <- "2020-09-10"
data1$i1_dob1.comb[data1$record_id == 3316]  #"2020-09-10"

data1[data1$i1_dob1.comb == "2022-04-16", c("record_id","bl6_dose1_date","bl10_dose2_date")] #980 #2021-06-01 #2021-06-09
data1$i1_dob1.comb[data1$record_id == "980"] <- "2021-04-16"
data1$bl6_dose1_date[data1$record_id == "980"] <- "2021-01-06"
data1$bl10_dose2_date[data1$record_id == "980"] <- "2021-09-06"

data1[data1$i1_dob1.comb == "0821-04-01", c("record_id","i1_dob1.comb","bl1a_delive.4mo_date")]  #4928, "0821-04-01" #0921-04-01
data1$i1_dob1.comb[data1$record_id == "4928"] <- "2021-08-04"
data1$bl1a_delive.4mo_date[data1$record_id == "4928"] <- "2021-09-04"
data1$p3i_preterm.4mo[data1$record_id == "4928"] #No preterm

#TABLE WITH CORRECTIONS:
data1[ , " *** "] <- NA
data1[ , " **** "] <- NA
correction_date_of_birth_i1dob1 <- data1[data1$record_id %in% c("3316", "980", "4928","2287","4032"), c("record_id", "i1_dob1.comb", " *** ", "i1_dob1", "i1_dob1.2mo","i1_dob1.4mo", " **** ", "bl1a_delive.4mo_date", "bl6_dose1_date","dose1_preg","bl10_dose2_date", "dose2_preg")]
#View(correction_date_of_birth_i1dob1)
#library("xtable")
#print(xtable(correction_date_of_birth_i1dob1), type = "html", file="Corrections/correction_date_of_birth_i1dob1.html")
#write.csv(correction_date_of_birth_i1dob1,'Corrections/correction_date_of_birth_i1dob1.csv')


#gestational age (see below) realistic? 
#View(data2[(data2$gestational_age_dosis2 >38 | data2$gestational_age_dosis2 < 0) & !is.na(data2$gestational_age_dosis2), c("record_id", "gestational_age_dosis2", "dose2_preg",  "bl9_dose2_timing", "bl9_dose2_timing2___2", "bl10_dose2_date", "bl1a_delive.4mo_date", "i1_dob1.comb",  "gestational_age_dosis1", "dose1_preg", "bl5_dose1_timing", "bl5_dose1_timing2___2", "bl6_dose1_date")])
#View(data2[(data2$gestational_age_dosis1 >38 | data2$gestational_age_dosis1 < 0) & !is.na(data2$gestational_age_dosis1), c("record_id", "gestational_age_dosis2", "dose2_preg",  "bl9_dose2_timing", "bl9_dose2_timing2___2", "bl10_dose2_date", "bl1a_delive.4mo_date", "i1_dob1.comb",  "gestational_age_dosis1", "dose1_preg", "bl5_dose1_timing", "bl5_dose1_timing2___2", "bl6_dose1_date")])

### correcting data where the gestational age was negative or larger than 40 weeks. 
data1$bl1a_delivery_date_OLD <- data1$bl1a_delive.4mo_date
data1$bl10_dose2_date_OLD <- data1$bl10_dose2_date
data1$bl6_dose1_date_OLD <- data1$bl6_dose1_date

data1$bl1a_delive.4mo_date[data1$record_id == 183] <- "2021-06-02" #"0621-06-02"
data1$dose2_preg[data1$record_id == 648] <- "post-partum/post-miscarriage"
data1$bl1a_delive.4mo_date[data1$record_id == 999] <- "2021-08-18" #"2022-08-18"
data1$bl10_dose2_date[data1$record_id == 999] <- "2021-07-23"  #"2021-06-29"
data1$bl6_dose1_date[data1$record_id == 999] <- "2021-06-29" #"2021-07-23"
data1$bl1a_delive.4mo_date[data1$record_id == 1280] <- "2021-12-07"   #"2022-12-07"
data1$bl1a_delive.4mo_date[data1$record_id == 1349] <- "2021-07-22"  # "2022-07-22"
data1$bl1a_delive.4mo_date[data1$record_id == 1867] <- "2021-08-06" # "2021-06-08"
data1$i1_dob1.comb[data1$record_id == 2287] <- "2021-06-11"  #"2021-11-06"
data1$dose2_preg[data1$record_id == 2287] <- "post-partum/post-miscarriage"  #"During pregnancy"
data1$bl1a_delive.4mo_date[data1$record_id == 2506] <- "2022-02-25" #"2021-02-25"
data1$bl1a_delive.4mo_date[data1$record_id == 2949] <- "2022-02-15" #"2021-02-15"
data1$bl1a_delive.4mo_date[data1$record_id == 3059] <- "2022-02-15" #"2021-02-15"
data1$bl1a_delive.4mo_date[data1$record_id == 3123] <- "2021-07-15" #"2022-07-15"
data1$bl10_dose2_date[data1$record_id == 3496] <- "2021-06-20"  #"2020-06-20"
data1$bl1a_delive.4mo_date[data1$record_id == 3836] <- "2022-02-10" #"2021-02-10"
data1$bl1a_delive.4mo_date[data1$record_id == 3993] <- "2022-02-10" #"2021-02-10"
data1$i1_dob1.comb[data1$record_id == 4032] <- "2021-07-10" #"2021-10-07"
data1$dose2_preg[data1$record_id == 4032] <- "post-partum/post-miscarriage"  #"During pregnancy"
data1$bl1a_delive.4mo_date[data1$record_id == 4099] <- "2022-03-08" # "2023-03-08"
data1$dose1_preg[data1$record_id == 4099] <- "Before pregnancy"  #"During pregnancy"
data1$bl1a_delive.4mo_date[data1$record_id == 4198] <- "2022-01-07" #"2021-01-07"
data1$bl1a_delive.4mo_date[data1$record_id == 4279] <- "2022-01-14" #"2021-01-14"
data1$bl1a_delive.4mo_date[data1$record_id == 4538] <- "2022-01-25" #"2021-01-25"
data1$bl1a_delive.4mo_date[data1$record_id == 5094] <- "2022-01-11" #"2021-01-11"
data1$bl1a_delive.4mo_date[data1$record_id == 5327] <- "2022-04-01" #"2021-04-01"
data1$bl1a_delive.4mo_date[data1$record_id == 5415] <- "2022-03-13" #"2021-03-13"
data1$bl6_dose1_date[data1$record_id == 5441] <- "2021-07-13"  #"2022-07-13"
data1$bl10_dose2_date[data1$record_id == 5441] <- "2021-09-03"  #"2022-09-03"
data1$bl1a_delive.4mo_date[data1$record_id == 5571] <- "2022-01-07" #"2021-01-07"

data1$dose1_preg[data1$record_id == 1033] <- "Before pregnancy" # "During pregnancy"
data1$dose1_preg[data1$record_id == 1552] <- "Before pregnancy" # "During pregnancy"
data1$dose1_preg[data1$record_id == 1711] <- "Before pregnancy" # "During pregnancy"
data1$dose1_preg[data1$record_id == 2033] <- "Before pregnancy" # "During pregnancy"
data1$dose1_preg[data1$record_id == 3069] <- "Before pregnancy" # "During pregnancy"
data1$bl6_dose1_date[data1$record_id == 4158] <- "2021-05-11" #"2022-05-11"
data1$bl6_dose1_date[data1$record_id == 4652] <- "2021-01-27"  # "2020-01-27"
data1$bl1a_delive.4mo_date[data1$record_id == 4652] <- "2021-01-14" #"2022-01-14"
data1$bl1a_delive.4mo_date[data1$record_id == 5404] <- "2022-02-20" #"2021-02-20"
data1$bl1a_delive.4mo_date[data1$record_id == 5502] <- "2022-01-17" # "2023-01-17"
data1$dose1_preg[data1$record_id == 5664] <- "Before pregnancy" # "During pregnancy"
data1$bl1a_delive.4mo_date[data1$record_id == 5878] <- "2022-05-15" #"2021-05-15"

#exclude 126, 5804, 614, 1337 because it is not clear if the Covid doses were before or during pregnancy. 
nrow(data1) #5076
data2 <- data1[!data1$record_id %in% c(126, 5804, 614, 1337),]
nrow(data2) #5072


#TABLE WITH CORRECTIONS:
#correction_estimated_delivery_date_bl1a_delivery_date <- data2[data2$record_id %in% c(183, 999,1280,1349,1867, 2506,2949,3059,3123,3836,3993,4099,4198,4279,4538,5094,5327,5415,5571,4652,5404,5502,5878), c("record_id", "bl1a_delive.4mo_date", " *** ","bl1a_delivery_date_OLD",  " **** ", "gestational_age_dosis2", "dose2_preg",  "bl9_dose2_timing", "bl9_dose2_timing2___2", "bl10_dose2_date_OLD", "i1_dob1.comb",  "gestational_age_dosis1", "dose1_preg", "bl5_dose1_timing", "bl5_dose1_timing2___2", "bl6_dose1_date_OLD")]
#View(correction_estimated_delivery_date_bl1a_delivery_date)
#correction_EXCLUDED_datesdonotmatch <- data1[data1$record_id %in% c(126, 5804, 614, 1337), c("record_id", " **** ", "dose2_preg",  "bl9_dose2_timing", "bl9_dose2_timing2___2", "bl10_dose2_date", "bl1a_delive.4mo_date", "i1_dob1.comb", "dose1_preg", "bl5_dose1_timing", "bl5_dose1_timing2___2", "bl6_dose1_date")]
#View(correction_EXCLUDED_datesdonotmatch)
#corrected_dose2_date_bl10_dose2_date <- data2[data2$record_id %in% c(999, 3496,5441), c("record_id", "bl10_dose2_date", " *** ","bl10_dose2_date_OLD",  " **** ", "gestational_age_dosis2", "dose2_preg",  "bl9_dose2_timing", "bl9_dose2_timing2___2", "bl1a_delivery_date_OLD", "i1_dob1.comb",  "gestational_age_dosis1", "dose1_preg", "bl5_dose1_timing", "bl5_dose1_timing2___2", "bl6_dose1_date_OLD")]
#View(corrected_dose2_date_bl10_dose2_date)
#corrected_dose1_date_bl6_dose1_date <- data2[data2$record_id %in% c(999,5441,4158,4652), c("record_id", "bl6_dose1_date", " *** ","bl6_dose1_date_OLD",  " **** ", "gestational_age_dosis2", "dose2_preg",  "bl9_dose2_timing", "bl9_dose2_timing2___2", "bl10_dose2_date_OLD", "bl1a_delivery_date_OLD", "i1_dob1.comb",  "gestational_age_dosis1", "dose1_preg", "bl5_dose1_timing", "bl5_dose1_timing2___2")]
#View(corrected_dose1_date_bl6_dose1_date)
#corrected_dose2_timing <- data2[data2$record_id %in% c(648, 2287,4032), c("record_id", "dose2_preg", " *** ", "bl9_dose2_timing", "bl5_dose1_timing2___2",  " **** ", "gestational_age_dosis2", "bl9_dose2_timing2___2", "bl10_dose2_date_OLD", "bl1a_delivery_date_OLD", "i1_dob1.comb",  "gestational_age_dosis1", "dose1_preg", "bl5_dose1_timing", "bl6_dose1_date_OLD")]
#View(corrected_dose2_timing)
#corrected_dose1_timing <- data2[data2$record_id %in% c(4099,1033,1552,1711,2033,3069,5664), c("record_id", "dose1_preg", " *** ", "bl5_dose1_timing", "bl5_dose1_timing2___2",  " **** ", "gestational_age_dosis2", "dose2_preg",  "bl9_dose2_timing", "bl9_dose2_timing2___2", "bl10_dose2_date_OLD", "bl1a_delivery_date_OLD", "i1_dob1.comb",  "gestational_age_dosis1", "bl6_dose1_date_OLD")]
#View(corrected_dose1_timing)
  
#library("xtable")
#print(xtable(correction_estimated_delivery_date_bl1a_delivery_date), type = "html", file="Corrections/correction_estimated_delivery_date_bl1a_delivery_date.html")
#write.csv(correction_estimated_delivery_date_bl1a_delivery_date,'Corrections/correction_estimated_delivery_date_bl1a_delivery_date.csv')
#print(xtable(correction_EXCLUDED_datesdonotmatch), type = "html", file="Corrections/correction_EXCLUDED_datesdonotmatch.html")
#write.csv(correction_EXCLUDED_datesdonotmatch,'Corrections/correction_EXCLUDED_datesdonotmatch.csv')
#print(xtable(corrected_dose2_date_bl10_dose2_date), type = "html", file="Corrections/corrected_dose2_date_bl10_dose2_date.html")
#write.csv(corrected_dose2_date_bl10_dose2_date,'Corrections/corrected_dose2_date_bl10_dose2_date.csv')
#print(xtable(corrected_dose1_date_bl6_dose1_date), type = "html", file="Corrections/corrected_dose1_date_bl6_dose1_date.html")
#write.csv(corrected_dose1_date_bl6_dose1_date,'Corrections/corrected_dose1_date_bl6_dose1_date.csv')
#print(xtable(corrected_dose2_timing), type = "html", file="Corrections/4_corrected_dose2_timing.html")
#write.csv(corrected_dose2_timing,'Corrections/4_corrected_dose2_timing.csv')
#print(xtable(corrected_dose1_timing), type = "html", file="Corrections/corrected_dose1_timing.html")
#write.csv(corrected_dose1_timing,'Corrections/corrected_dose1_timing.csv')



#Among those who were vaccinated during pregnancy:
#bl7_dose1_type and, if dose 2 was during pregnancy, bl11_dose2_type (what vaccine did they get)

describeFactors(data2$bl7_dose1_.4mope)
data2$bl7_dose1_.4mope <- factor(data2$bl7_dose1_.4mope, levels = c(1,2,3,4), labels = c("Pfizer-BioNTech", "Moderna", "AstraZeneca/COVISHIELD", "Johnson & Johnson/Janssen"))
describeFactors(data2$bl7_dose1_.4mope)

describeFactors(data2$bl11_dose2_.4mope)
data2$bl11_dose2_.4mope <- factor(data2$bl11_dose2_.4mope, levels = c(1,2,3,999), labels = c("Pfizer-BioNTech", "Moderna", "AstraZeneca/COVISHIELD", "Unknown"))
describeFactors(data2$bl11_dose2_.4mope)


#Timing of vaccination during pregnancy (use bl6_dose1_date and if relevant bl10_dose2_date combined with estimated delivery date to determine what trimester of pregnancy the dose was given in)


data2$timing_dosis1_days <- difftime(as.Date(data2$bl1a_delive.4mo_date,"%Y-%m-%d"), as.Date(data2$bl6_dose1_date,"%Y-%m-%d"), units = c("days")) #possible units “auto”, “secs”, “mins”, “hours”, “days”, “weeks” #or simply a-b
describeFactors(data2$timing_dosis1_days)

data2$gestational_age_dosis1_indays <- 280 - data2$timing_dosis1_days     #pregnancy is 40 weeks or 280 days

data2$gestational_age_dosis1_old <- floor(time_length(data2$gestational_age_dosis1_indays, "week"))
summary(data2$gestational_age_dosis1_old)
describeFactors(data2$gestational_age_dosis1_old)

data2 <- data2 %>% 
  mutate(gestational_age_dosis1 = case_when(
    dose1_preg == "During pregnancy" ~  floor(time_length(data2$gestational_age_dosis1_indays, "week")),
    TRUE ~ as.numeric(NA)
  ))
describeFactors(data2$gestational_age_dosis1)

#trimester 1: week 1-12
#trimester 2: week 13-26
#trimester 3: week 27-40

data2 <- data2 %>% 
  mutate(trimester_dosis1 = case_when(
    gestational_age_dosis1 <= 12 ~ "Trimester 1 (Week 0-12)",
    gestational_age_dosis1 <= 26 & gestational_age_dosis1 >= 13 ~ "Trimester 2 (Week 13-26)",
    gestational_age_dosis1 >= 27 ~ "Trimester 3 (Week 27-delivery)",
    TRUE ~ "NA"
  ))
describeFactors(data2$trimester_dosis1)
data2$trimester_dosis1 <- factor(data2$trimester_dosis1, levels = c("Trimester 1 (Week 0-12)", "Trimester 2 (Week 13-26)", "Trimester 3 (Week 27-delivery)"))
describeFactors(data2$trimester_dosis1)


data2$timing_dosis2_days <- difftime(as.Date(data2$bl1a_delive.4mo_date,"%Y-%m-%d"), as.Date(data2$bl10_dose2_date,"%Y-%m-%d"), units = c("days")) #possible units “auto”, “secs”, “mins”, “hours”, “days”, “weeks” #or simply a-b
describeFactors(data2$timing_dosis2_days)

data2$gestational_age_dosis2_indays <- 280 - data2$timing_dosis2_days     #pregnancy is 40 weeks or 280 days

data2$gestational_age_dosis2_old <- floor(time_length(data2$gestational_age_dosis2_indays, "week"))
summary(data2$gestational_age_dosis2_old)
describeFactors(data2$gestational_age_dosis2_old)

data2 <- data2 %>% 
  mutate(gestational_age_dosis2 = case_when(
    dose2_preg == "During pregnancy" ~ floor(time_length(data2$gestational_age_dosis2_indays, "week")),
    TRUE ~ as.numeric(NA)
  ))
describeFactors(data2$gestational_age_dosis2)

#View(data2[!is.na(data2$gestational_age_dosis2), c("record_id", "gestational_age_dosis2", "dose2_preg",  "bl9_dose2_timing", "bl9_dose2_timing2___2", "bl1a_delive.4mo_date", "i1_dob1.comb","bl10_dose2_date")])



#trimester 1: week 1-12
#trimester 2: week 13-26
#trimester 3: week 27-40

data2 <- data2 %>% 
  mutate(trimester_dosis2 = case_when(
    gestational_age_dosis2 <= 12 ~ "Trimester 1 (Week 0-12)",
    gestational_age_dosis2 <= 26 & gestational_age_dosis2 >= 13 ~ "Trimester 2 (Week 13-26)",
    gestational_age_dosis2 >= 27 ~ "Trimester 3 (Week 27-delivery)",
    TRUE ~ "NA"
  ))

describeFactors(data2$trimester_dosis2)
data2$trimester_dosis2 <- factor(data2$trimester_dosis2, levels = c("Trimester 1 (Week 0-12)", "Trimester 2 (Week 13-26)", "Trimester 3 (Week 27-delivery)"))
describeFactors(data2$trimester_dosis2)

### Maternal age at delivery (bl14_dob combined with delivery date/baby DOB to determine this)
#age
#Baseline completion date
describe(data2$bl_completed_date) #14 missing
describeFactors(data2$bl14_dob_month) #11 missing
describeFactors(data2$bl14_dob.4moear) #12 missing
data2$birth_day <- 01

data2$bl14_dob_month_OLD <- data2$bl14_dob_month
data2$bl14_dob.year_OLD <- data2$bl14_dob.4moear
data2$record_id[data2$bl14_dob.4moear == "1992.06"& !is.na(data2$bl14_dob.4moear)] #3414
data2$bl14_dob_month[data2$bl14_dob.4moear == "1992.06"& !is.na(data2$bl14_dob.4moear)]
data2$bl14_dob.4moear[data2$bl14_dob.4moear == "1992.06"& !is.na(data2$bl14_dob.4moear)]
data2$bl14_dob_month[data2$bl14_dob.4moear == "1992.06"& !is.na(data2$bl14_dob.4moear)] <- 06
data2$bl14_dob.4moear[data2$bl14_dob.4moear == "1992.06"& !is.na(data2$bl14_dob.4moear)] <- 1992


## Set Month to January if only birth year is known:
#View(data2[!is.na(data2$bl14_dob.4moear) & is.na(data2$bl14_dob_month), c("bl14_dob.4moear","bl14_dob_month")])  #"birthday",
data2$record_id[!is.na(data2$bl14_dob.4moear) & is.na(data2$bl14_dob_month)] #830 1932 2812 2885 4222 4974 5657
data2$bl14_dob_month[!is.na(data2$bl14_dob.4moear) & is.na(data2$bl14_dob_month)] <- 01

data2$birthday <- as.Date(paste(data2$bl14_dob.4moear, data2$bl14_dob_month, data2$birth_day, sep="-"))#,  "%Y-%M-")
describeFactors(data2$birthday)
#year: 26 and month: 3 seem to be a typo. Set to NA
data2$record_id[data2$birthday == "0026-03-01" & is.na(data2$birthday)] #2081
data2$bl14_dob.4moear[data2$record_id == 2081] <- NA 
data2$birthday[data2$birthday == "0026-03-01"& is.na(data2$birthday)] <- NA 



#some people gave the birthdate of their babies instead of the mother's birth date
#View(data2[data2$maternal_age_delivery %in% c(0,1), c("birthday","maternal_age_delivery","i1_dob1.comb")])
data2$record_id[data2$bl14_dob.4moear >= 2020 & !is.na(data2$bl14_dob.4moear)] #145  220  700  729 1289 1627 2345 2878 3375 3646 3948 4083 4144 4386 5827
data2$birthday[data2$record_id %in% c(145, 220, 700, 729, 1289, 1627, 2345, 2878, 3375, 3646, 3948, 4083, 4144, 4386, 5827)] <- NA
data2$bl14_dob.4moear[data2$record_id %in% c(145, 220, 700, 729, 1289, 1627, 2345, 2878, 3375, 3646, 3948, 4083, 4144, 4386, 5827)] <- NA
data2$bl14_dob_month[data2$record_id %in% c(145, 220, 700, 729, 1289, 1627, 2345, 2878, 3375, 3646, 3948, 4083, 4144, 4386, 5827)] <- NA

#View(data2[is.na(data2$birthday), c("birthday","bl14_dob.4moear","bl14_dob_month")])


data2$maternal_age_delivery_indays <- difftime(as.Date(data2$i1_dob1.comb,"%Y-%m-%d"), data2$birthday) #possible units “auto”, “secs”, “mins”, “hours”, “days”, “weeks” #or simply a-b
data2$maternal_age_delivery <- floor(time_length(data2$maternal_age_delivery_indays, "year"))
describeFactors(data2$maternal_age_delivery)
summary(data2$maternal_age_delivery)

#TABLE WITH CORRECTIONS:
#corrected_birthmonth <- data2[data2$record_id %in% c(3414, 145, 220, 700, 729, 1289, 1627, 2345, 2878, 3375, 3646, 3948, 4083, 4144, 4386, 5827), c("record_id", "bl14_dob_month", " *** ", "bl14_dob_month_OLD" ," **** ", "bl14_dob.year_OLD")]
#View(corrected_birthmonth)
#corrected_birthyear <- data2[data2$record_id %in% c(2081, 3414, 145, 220, 700, 729, 1289, 1627, 2345, 2878, 3375, 3646, 3948, 4083, 4144, 4386, 5827), c("record_id", "bl14_dob.4moear", " *** ", "bl14_dob.year_OLD"," **** ", "bl14_dob_month_OLD"  )]
#View(corrected_birthyear)
#library("xtable")
#print(xtable(corrected_birthmonth), type = "html", file="Corrections/corrected_birthmonth.html")
#write.csv(corrected_birthmonth,'Corrections/corrected_birthmonth.csv')
#print(xtable(corrected_birthyear), type = "html", file="Corrections/corrected_birthyear.html")
#write.csv(corrected_birthyear,'Corrections/corrected_birthyear.csv')

#describeFactors(data2$p3i_preterm.comb)
#describeFactors(data2$p3ii_ba.4modob.comb)
#describeFactors(data2$bl1a_delive.4mo_date)  #2627 missing
#describeFactors(data2$i1_dob1.comb)

#View(data2[,c("p3i_preterm.comb", "p3ii_ba.4modob.comb","bl1a_delive.4mo_date","i1_dob1.comb")])
#If it was a preterm birth, then the date of birth is not only mentioned as p3ii_ba.4modob.comb but also i1_dob1.comb.



### Pre-existing conditions are all in the baseline survey

describeFactors(data2$bl24_diabetes)
data2$bl24_diabetes <- factor(data2$bl24_diabetes, levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl24_diabetes)

describeFactors(data2$bl24_diabetes_.4mope)  #diabetes type
data2$bl24_diabetes_.4mope <- factor(data2$bl24_diabetes_.4mope, levels = c(1,2), labels = c("Type 1", "Type 2"))
describeFactors(data2$bl24_diabetes_.4mope)

describeFactors(data2$bl24_diabetes_med)
data2$bl24_diabetes_med <- factor(data2$bl24_diabetes_med, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$bl24_diabetes_med)

describeFactors(data2$bl24_diabetes_med_other)
data2$bl24_diabetes_med_other <- factor(data2$bl24_diabetes_med_other, levels = c(
  "Fiasp insulin ", 
  "Humalog ",
  "Humalog insulin",
  "insulin",
  "Insulin",
  "Insulin (Humalog)",
  "Insulin lispro",
  "Metformin",
  "Metformin ",
  "novorapid insulin pump",
  "on insulin pump",
  "Tresiba and Novorapid "
), labels = c(
  "Fiasp insulin ", 
  "Humalog insulin",
  "Humalog insulin",
  "Insulin",
  "Insulin",
  "Humalog insulin",
  "Insulin lispro",
  "Metformin",
  "Metformin",
  "novorapid insulin pump",
  "on insulin pump",
  "Tresiba and Novorapid ")
)
describeFactors(data2$bl24_diabetes_med_other)


describeFactors(data2$bl24_asthma)
data2$bl24_asthma <- factor(data2$bl24_asthma, levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl24_asthma)

describeFactors(data2$bl24_asthma_med)
data2$bl24_asthma_med <- factor(data2$bl24_asthma_med, levels = c(0,1,997), labels = c("No", "Yes","Prefer not to say"))
describeFactors(data2$bl24_asthma_med)

describeFactors(data2$bl24_asthma_med_other)

describeFactors(data2$bl24_otherlung)
data2$bl24_otherlung <- factor(data2$bl24_otherlung, levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl24_otherlung)

describeFactors(data2$bl24_otherlung_other)

describeFactors(data2$bl24_otherlung_med)
data2$bl24_otherlung_med <- factor(data2$bl24_otherlung_med, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$bl24_otherlung_med)

describeFactors(data2$bl24_htn)
data2$bl24_htn <- factor(data2$bl24_htn, levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl24_htn)

describeFactors(data2$bl24_htn_med)
data2$bl24_htn_med <- factor(data2$bl24_htn_med, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$bl24_htn_med)

describeFactors(data2$bl24_othercardio)
data2$bl24_othercardio <- factor(data2$bl24_othercardio, levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl24_othercardio)

describeFactors(data2$bl24_othercardio_other)

describeFactors(data2$bl24_othercardio_med)
data2$bl24_othercardio_med <- factor(data2$bl24_othercardio_med, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$bl24_othercardio_med)

describeFactors(data2$bl24_t.4moroid)  #thyroid
data2$bl24_t.4moroid <- factor(data2$bl24_t.4moroid, levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl24_t.4moroid)

describeFactors(data2$bl24_t.4moroid_other)

describeFactors(data2$bl24_t.4moroid_med)
data2$bl24_t.4moroid_med <- factor(data2$bl24_t.4moroid_med, levels = c(0,1,997), labels = c("No", "Yes","Prefer not to say"))
describeFactors(data2$bl24_t.4moroid_med)

describeFactors(data2$bl24_neuro)  
data2$bl24_neuro <- factor(data2$bl24_neuro, levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl24_neuro)

describeFactors(data2$bl24_neuro_med)
data2$bl24_neuro_med <- factor(data2$bl24_neuro_med, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$bl24_neuro_med)

describeFactors(data2$bl24_autoimmune)
data2$bl24_autoimmune <- factor(data2$bl24_autoimmune, levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl24_autoimmune)

describeFactors(data2$bl24_autoimmune_med)
data2$bl24_autoimmune_med <- factor(data2$bl24_autoimmune_med, levels = c(0,1,999), labels = c("No", "Yes", "Don't know"))
describeFactors(data2$bl24_autoimmune_med)

describeFactors(data2$bl24_hiv)
data2$bl24_hiv <- factor(data2$bl24_hiv, levels = c(0,997), labels = c("No", "Prefer not to say"))
describeFactors(data2$bl24_hiv)


describeFactors(data2$bl24_otherimmune)
data2$bl24_otherimmune <- factor(data2$bl24_otherimmune, levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl24_otherimmune)

describeFactors(data2$bl24_otherimmune_other)

describeFactors(data2$bl24_otherimmune_med)
data2$bl24_otherimmune_med <- factor(data2$bl24_otherimmune_med, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$bl24_otherimmune_med)


describeFactors(data2$bl24_hepc)
data2$bl24_hepc <- factor(data2$bl24_hepc, levels = c(0,1,997), labels = c("No", "Yes", "Prefer not to say"))
describeFactors(data2$bl24_hepc)

data2$bl24_hepc_med  #NULL

describeFactors(data2$bl24_hepb)
data2$bl24_hepb <- factor(data2$bl24_hepb,levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl24_hepb)

describeFactors(data2$bl24_hepb_med)
data2$bl24_hepb_med <- factor(data2$bl24_hepb_med,levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$bl24_hepb_med)

describeFactors(data2$bl24_mh)
data2$bl24_mh <- factor(data2$bl24_mh,levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl24_mh)



describeFactors(data2$bl24_mh_med)
data2$bl24_mh_med <- factor(data2$bl24_mh_med,levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl24_mh_med)

describeFactors(data2$bl24_other)
data2$bl24_other <- factor(data2$bl24_other,levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl24_other)


describeFactors(data2$bl24_other_med)
data2$bl24_other_med <- factor(data2$bl24_other_med,levels = c(0,1,997), labels = c("No", "Yes", "Prefer not to say"))
describeFactors(data2$bl24_other_med)




describeFactors(data2$bl25_height_inches)
#between 4.1 and 6.1 are feet. Multiply by 12 to get inches:
data2$bl25_height_inches2 <- sapply(data2$bl25_height_inches, function(x) ifelse((x >= 4.1 & x <= 6.1) %in% TRUE, 12*x, x))
describeFactors(data2$bl25_height_inches2)
#INCH TO CM: 1 in = 2.54 cm
data2$bl25_height_inches_to_cm <- sapply(data2$bl25_height_inches2, function(x) ifelse((x < 125) %in% TRUE, x * 2.54, x))
describeFactors(data2$bl25_height_inches_to_cm)

describeFactors(data2$bl25_height_cm)
#1.57-1.7 are m instead of cm -> multiply by 100
data2$bl25_height_cm2 <- sapply(data2$bl25_height_cm, function(x) ifelse((x >= 1.57 & x <= 1.7) %in% TRUE, 100*x, x))
#5.4 and 5.6 are feet -> multiply by 30.48
data2$bl25_height_cm3 <- sapply(data2$bl25_height_cm2, function(x) ifelse((x >= 5.4 & x <= 5.6) %in% TRUE, 30.48*x, x))
#53-65 are inches -> multiply by 2.54
data2$bl25_height_cm4 <- sapply(data2$bl25_height_cm3, function(x) ifelse((x < 125) %in% TRUE, x * 2.54, x))
describeFactors(data2$bl25_height_cm4)

#combine cm with inches variable
data2$bl25_height_comb2 <- mapply(paste, data2$bl25_height_cm4, data2$bl25_height_inches_to_cm, sep="/")
describeFactors(data2$bl25_height_comb2)
data2$bl25_height_comb2 <- gsub("/NA","",data2$bl25_height_comb2)
data2$bl25_height_comb2 <- gsub("NA/","",data2$bl25_height_comb2)
describeFactors(data2$bl25_height_comb2)

#keep only heights between 125 cm and 193 cm
data2$bl25_height_comb <- sapply(data2$bl25_height_comb2, function(x) ifelse((x >= 125 & x <= 193) %in% TRUE, x, NA))
describeFactors(data2$bl25_height_comb)
data2$bl25_height_comb <- as.numeric(data2$bl25_height_comb)


#TABLE WITH CORRECTIONS:
#data2$bl25_height_inches3 <- sapply(data2$bl25_height_inches2, function(x) ifelse((x >= 125) %in% TRUE, x / 2.54, x))

#corrected_height_inch <- data2[!is.na(data2$bl25_height_inches) & ((data2$bl25_height_inches>= 4.1 & data2$bl25_height_inches <= 6.1)|(data2$bl25_height_inches >= 125)), c("record_id", "bl25_height_inches3", " *** ", "bl25_height_inches")]
#View(corrected_height_inch)

#corrected_height_cm <- data2[!is.na(data2$bl25_height_cm) & 
#                               ((data2$bl25_height_cm >= 1.57 & data2$bl25_height_cm <= 1.7)
#                                |(data2$bl25_height_cm >= 5.4 & data2$bl25_height_cm <= 5.6)
#                                |(data2$bl25_height_cm < 125)), 
#                             c("record_id", "bl25_height_cm4", " *** ", "bl25_height_cm")]
#View(corrected_height_cm)

#library("xtable")
#print(xtable(corrected_height_inch), type = "html", file="Corrections/corrected_height_inch.html")
#write.csv(corrected_height_inch,'Corrections/corrected_height_inch.csv')
#print(xtable(corrected_height_cm), type = "html", file="Corrections/corrected_height_cm.html")
#write.csv(corrected_height_cm,'Corrections/corrected_height_cm.csv')

#record_id of people with height smaller 125 or larger 193: 
#height_bigger193_smaller125 <- data2[(data2$bl25_height_comb2 < 125 | data2$bl25_height_comb2 > 193) & !(data2$bl25_height_comb2=="NA"), c("record_id", "bl25_height_comb2"," *** ", "bl25_height_inches","bl25_height_cm")]
#print(xtable(height_bigger193_smaller125), type = "html", file="Corrections/height_bigger193_smaller125.html")
#write.csv(height_bigger193_smaller125,'Corrections/height_bigger193_smaller125.csv')




describeFactors(data2$bl26_weight_kg)
describeFactors(data2$bl26_weight_lbs)

#Set 1300 to NA
#Set everything below 90 to NA because we don't know if these are typos (10,14), are kg or real
data2$bl26_weight_lbs_OLD <- data2$bl26_weight_lbs
data2$bl26_weight_lbs[data2$bl26_weight_lbs==1300 & !is.na(data2$bl26_weight_lbs)] <- NA #2551
data2$bl26_weight_lbs[data2$bl26_weight_lbs < 90 & !is.na(data2$bl26_weight_lbs)] <- NA


#LBS to KG: Pound (lbs) / 2.2046 = Result in Kilograms (kg)
data2$bl26_weight_lbs_to_kg <- round(data2$bl26_weight_lbs/ 2.2046,3)
describeFactors(data2$bl26_weight_lbs_to_kg)

data2$bl26_weight_comb <- mapply(paste, data2$bl26_weight_kg, data2$bl26_weight_lbs_to_kg, sep="/")
describeFactors(data2$bl26_weight_comb)
data2$bl26_weight_comb <- gsub("/NA","",data2$bl26_weight_comb)
data2$bl26_weight_comb <- gsub("NA/","",data2$bl26_weight_comb)
describeFactors(data2$bl26_weight_comb)
data2$bl26_weight_comb <- as.numeric(data2$bl26_weight_comb)


#TABLE WITH CORRECTIONS:
#corrected_bl26_weight_lbs <- data2[!is.na(data2$bl26_weight_lbs_OLD) & ((data2$bl26_weight_lbs_OLD < 90)|(data2$bl26_weight_lbs_OLD==1300)), c("record_id", "bl26_weight_lbs", " *** ", "bl26_weight_lbs_OLD")]
#View(corrected_bl26_weight_lbs)

#library("xtable")
#print(xtable(corrected_bl26_weight_lbs), type = "html", file="Corrections/corrected_bl26_weight_lbs.html")
#write.csv(corrected_bl26_weight_lbs,'Corrections/corrected_bl26_weight_lbs.csv')




#BMI = weight in kilograms divided by height in meters squared
#BMI under 18.5 is underweight (under 16 is increased risk of death)
#BMI between 18.5 and 25 is normal range
#BMI between 25 and 30 is overweight
#BMI over 30 is obese
data2$BMI <- 10000 * data2$bl26_weight_comb/(data2$bl25_height_comb^2)
tail(data2$BMI)
summary(data2$BMI)

### Tobacco, vape, alcohol, heroin, cocaine, solvents, marijuana, other from baseline survey

describeFactors(data2$bl27_tobacco)
data2$bl27_tobacco <- factor(data2$bl27_tobacco, levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to answer", "Don't know"))
describeFactors(data2$bl27_tobacco)

describeFactors(data2$bl28_vape)
data2$bl28_vape <- factor(data2$bl28_vape, levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to answer", "Don't know"))
describeFactors(data2$bl28_vape)

describeFactors(data2$bl29_alcohol)
data2$bl29_alcohol <- factor(data2$bl29_alcohol, levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to answer", "Don't know"))
describeFactors(data2$bl29_alcohol)

describeFactors(data2$bl30_heroin)
data2$bl30_heroin <- factor(data2$bl30_heroin, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$bl30_heroin)

describeFactors(data2$bl30_cocaine)
data2$bl30_cocaine <- factor(data2$bl30_cocaine, levels = c(0,999), labels = c("No", "Don't know"))
describeFactors(data2$bl30_cocaine)

describeFactors(data2$bl30_solvents)
data2$bl30_solvents <- factor(data2$bl30_solvents, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$bl30_solvents)

describeFactors(data2$bl30_marijuana)
data2$bl30_marijuana <- factor(data2$bl30_marijuana, levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl30_marijuana)

describeFactors(data2$bl30_other)
data2$bl30_other <- factor(data2$bl30_other, levels = c(0,1,997,999), labels = c("No", "Yes", "Prefer not to say", "Don't know"))
describeFactors(data2$bl30_other)


describeFactors(data2$bl30_other_speci.4mo)


### bl37_timespreg_desc 

describeFactors(data2$bl37_timespreg)

describeFactors(data2$bl37_timespreg_unknown___999)
data2$bl37_timespreg_unknown___999 <- factor(data2$bl37_timespreg_unknown___999, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$bl37_timespreg_unknown___999)

### bl38_livebirths_desc
describeFactors(data2$bl38_livebirths)

describeFactors(data2$bl38_livebirths_unknown___999)
data2$bl38_livebirths_unknown___999 <- factor(data2$bl38_livebirths_unknown___999,  levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$bl38_livebirths_unknown___999)


### bl39_preterm (preterm birth history) 

describeFactors(data2$bl39_preterm)
data2$bl39_preterm <- factor(data2$bl39_preterm,  levels = c(0,1,999), labels = c("No", "Yes","Unknown"))
describeFactors(data2$bl39_preterm)

### bl39_stillbirth (history of)

describeFactors(data2$bl39_stillbirth)
data2$bl39_stillbirth <- factor(data2$bl39_stillbirth,  levels = c(0,1,999), labels = c("No", "Yes","Unknown"))
describeFactors(data2$bl39_stillbirth)

### bl39_preeclampsia (history of) 

describeFactors(data2$bl39_preeclampsia)
data2$bl39_preeclampsia <- factor(data2$bl39_preeclampsia,  levels = c(0,1,999), labels = c("No", "Yes","Unknown"))
describeFactors(data2$bl39_preeclampsia)

### p1_situation (this describes live birth, SA, TA, stillbirth, neonatal death)



describeFactors(mapply(paste, data2$p1_situation___1, data2$p1_situation___1.2mo, data2$p1_situation___1.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p1_situation___1.comb = case_when(
    apply(data2[,c("p1_situation___1", "p1_situation___1.2mo","p1_situation___1.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p1_situation___1) & is.na(data2$p1_situation___1.2mo) & is.na(data2$p1_situation___1.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))

describeFactors(mapply(paste, data2$p1_situation___2, data2$p1_situation___2.2mo, data2$p1_situation___2.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p1_situation___2.comb = case_when(
    apply(data2[,c("p1_situation___2", "p1_situation___2.2mo","p1_situation___2.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p1_situation___2) & is.na(data2$p1_situation___2.2mo) & is.na(data2$p1_situation___2.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))

describeFactors(mapply(paste, data2$p1_situation___3, data2$p1_situation___3.2mo, data2$p1_situation___3.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p1_situation___3.comb = case_when(
    apply(data2[,c("p1_situation___3", "p1_situation___3.2mo","p1_situation___3.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p1_situation___3) & is.na(data2$p1_situation___3.2mo) & is.na(data2$p1_situation___3.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))

describeFactors(mapply(paste, data2$p1_situation___4, data2$p1_situation___4.2mo, data2$p1_situation___4.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p1_situation___4.comb = case_when(
    apply(data2[,c("p1_situation___4", "p1_situation___4.2mo","p1_situation___4.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p1_situation___4) & is.na(data2$p1_situation___4.2mo) & is.na(data2$p1_situation___4.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))

describeFactors(mapply(paste, data2$p1_situation___5, data2$p1_situation___5.2mo, data2$p1_situation___5.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p1_situation___5.comb = case_when(
    apply(data2[,c("p1_situation___5", "p1_situation___5.2mo","p1_situation___5.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p1_situation___5) & is.na(data2$p1_situation___5.2mo) & is.na(data2$p1_situation___5.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))

describeFactors(mapply(paste, data2$p1_situation___6, data2$p1_situation___6.2mo, data2$p1_situation___6.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p1_situation___6.comb = case_when(
    apply(data2[,c("p1_situation___6", "p1_situation___6.2mo","p1_situation___6.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p1_situation___6) & is.na(data2$p1_situation___6.2mo) & is.na(data2$p1_situation___6.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))

describeFactors(mapply(paste, data2$p1_situation___7, data2$p1_situation___7.2mo, data2$p1_situation___7.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p1_situation___7.comb = case_when(
    apply(data2[,c("p1_situation___7", "p1_situation___7.2mo","p1_situation___7.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p1_situation___7) & is.na(data2$p1_situation___7.2mo) & is.na(data2$p1_situation___7.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))

describeFactors(mapply(paste, data2$p1_situation___988, data2$p1_situation___988.2mo, data2$p1_situation___988.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p1_situation___988.comb = case_when(
    apply(data2[,c("p1_situation___988", "p1_situation___988.2mo","p1_situation___988.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p1_situation___988) & is.na(data2$p1_situation___988.2mo) & is.na(data2$p1_situation___988.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))

describeFactors(mapply(paste, data2$p1_situation___997, data2$p1_situation___997.2mo, data2$p1_situation___997.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p1_situation___997.comb = case_when(
    apply(data2[,c("p1_situation___997", "p1_situation___997.2mo","p1_situation___997.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p1_situation___997) & is.na(data2$p1_situation___997.2mo) & is.na(data2$p1_situation___997.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))


#data2 <- data2 %>% 
#  mutate(across(.cols = c("p1_situation___1.comb", "p1_situation___2.comb", "p1_situation___3.comb", #"p1_situation___4.comb", "p1_situation___5.comb", "p1_situation___6.comb", "p1_situation___7.comb", #"p1_situation___988.comb", "p1_situation___997.comb"), ~ case_when(
#   .x == "Yes" ~ 1,
#   .x == "No" ~ 0
#)))

data2$p1_situation.comb <- apply(data2[,c("p1_situation___1.comb", "p1_situation___2.comb", "p1_situation___3.comb", "p1_situation___4.comb", "p1_situation___5.comb", "p1_situation___6.comb", "p1_situation___7.comb", "p1_situation___988.comb", "p1_situation___997.comb")], 1, function(i) paste(names(i[i != 0 ]), collapse = '/'))  #str_sub(names(i[i != 0 ]), end=-6)

describeFactors(data2$p1_situation.comb)

data2$p1_situation.comb <- factor(data2$p1_situation.comb, levels = c(
  "p1_situation___1.comb", 
  "p1_situation___1.comb/p1_situation___2.comb", 
  "p1_situation___1.comb/p1_situation___3.comb", 
  "p1_situation___1.comb/p1_situation___4.comb",
  "p1_situation___1.comb/p1_situation___5.comb",
  "p1_situation___1.comb/p1_situation___988.comb",
  "p1_situation___2.comb", 
  "p1_situation___3.comb", 
  "p1_situation___4.comb", 
  "p1_situation___5.comb",
  "p1_situation___5.comb/p1_situation___6.comb",
  "p1_situation___6.comb", 
  "p1_situation___7.comb", 
  "p1_situation___988.comb"), labels = c(
    "baby lives at home with mother",
    "baby lives at home with mother/baby still in hospital",
    "baby lives at home with mother/baby adopted or in care",
    "baby lives at home with mother/miscarriage",
    "baby lives at home with mother/termination of pregnancy or therapeutic abortion",
    "baby lives at home with mother/other",
    "baby still in hospital",
    "baby adopted or in care",
    "miscarriage",
    "termination of pregnancy or therapeutic abortion",
    "termination of pregnancy or therapeutic abortion/stillbirth",
    "stillbirth",
    "baby passed away after delivery",
    "other"
  ))

describeFactors(data2$p1_situation.comb)

describeFactors(data2$p1_situation___1.comb)
data2$p1_situation___1.comb <- factor(data2$p1_situation___1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p1_situation___1.comb)

describeFactors(data2$p1_situation___2.comb)
data2$p1_situation___2.comb <- factor(data2$p1_situation___2.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p1_situation___2.comb)

describeFactors(data2$p1_situation___3.comb)
data2$p1_situation___3.comb <- factor(data2$p1_situation___3.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p1_situation___3.comb)

describeFactors(data2$p1_situation___4.comb)
data2$p1_situation___4.comb <- factor(data2$p1_situation___4.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p1_situation___4.comb)

describeFactors(data2$p1_situation___5.comb)
data2$p1_situation___5.comb <- factor(data2$p1_situation___5.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p1_situation___5.comb)

describeFactors(data2$p1_situation___6.comb)
data2$p1_situation___6.comb <- factor(data2$p1_situation___6.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p1_situation___6.comb)

describeFactors(data2$p1_situation___7.comb)
data2$p1_situation___7.comb <- factor(data2$p1_situation___7.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p1_situation___7.comb)

describeFactors(data2$p1_situation___988.comb)
data2$p1_situation___988.comb <- factor(data2$p1_situation___988.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p1_situation___988.comb)

describeFactors(data2$p1_situation___997.comb)
data2$p1_situation___997.comb <- factor(data2$p1_situation___997.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p1_situation___997.comb)



#CHECK THE DATES FOR THOSE COMBINATIONS WHICH DOES NOT MAKE SENSE
#data_p1_situation <- data2[(data2$p1_situation.comb == "baby lives at home with mother/baby still in hospital"|
#         data2$p1_situation.comb == "baby lives at home with mother/baby adopted or in care" | 
#         data2$p1_situation.comb == "baby lives at home with mother/miscarriage" | 
#         data2$p1_situation.comb == "baby lives at home with mother/termination of pregnancy or therapeutic abortion" | 
#         data2$p1_situation.comb == "baby lives at home with mother/other" | 
#         data2$p1_situation.comb == "termination of pregnancy or therapeutic abortion/stillbirth") & !is.na(data2$p1_situation.comb), c("p1_situation.comb","p11_numbabies.comb", "p1_situation___1", "p1_situation___1.2mo", "p1_situation___1.4mo","p1_situation___2", "p1_situation___2.2mo", "p1_situation___2.4mo", "p1_situation___3", "p1_situation___3.2mo", "p1_situation___3.4mo", "p1_situation___4", "p1_situation___4.2mo", "p1_situation___4.4mo", "p1_situation___5", "p1_situation___5.2mo", "p1_situation___5.4mo","p1_situation___6", "p1_situation___6.2mo", "p1_situation___6.4mo",  "p3i_preterm.comb", "i1_dob1.comb", "bl1a_delive.4mo_date", "bl6_dose1_date","dose1_preg","bl10_dose2_date", "dose2_preg")]

#library("xtable")
#print(xtable(data_p1_situation), type = "html", file="CheckDataRealistic/data_p1_situation.html")
#write.csv(data_p1_situation,'CheckDataRealistic/data_p1_situation.csv')

### p3i_preterm (also use p3ii_babydob in combination with estimated delivery date to calculate gestational age at delivery);
#categories should be <28 weeks, 28-31, 32-33, 34-36, 37-39, >39 weeks

data2$p3i_preterm.comb <- mapply(paste, data2$p3i_preterm, data2$p3i_preterm.2mo, data2$p3i_preterm.4mo, sep="/")
describeFactors(data2$p3i_preterm.comb)
data2$p3i_preterm.comb <- gsub("/NA","",data2$p3i_preterm.comb)
data2$p3i_preterm.comb <- gsub("NA/","",data2$p3i_preterm.comb)

describeFactors(data2$p3i_preterm.comb)
data2$p3i_preterm.comb <- factor(data2$p3i_preterm.comb, levels = c(0,1,999), labels = c("No", "Yes", "Unknown"))
describeFactors(data2$p3i_preterm.comb)

#gestational age at delivery
data2$p3ii_ba.4modob.comb <- mapply(paste, data2$p3ii_ba.4modob, data2$p3ii_ba.4modob.2mo, data2$p3ii_ba.4modob.4mo, sep="/")
describeFactors(data2$p3ii_ba.4modob.comb)
data2$p3ii_ba.4modob.comb <- gsub("/NA","",data2$p3ii_ba.4modob.comb)
data2$p3ii_ba.4modob.comb <- gsub("NA/","",data2$p3ii_ba.4modob.comb)
describeFactors(data2$p3ii_ba.4modob.comb)   #4,860 missing

describeFactors(data2$bl1a_delive.4mo_date)  #2627 missing


data2$Delivery_too_early_indays <- difftime(as.Date(data2$bl1a_delive.4mo_date,"%Y-%m-%d"), as.Date(data2$p3ii_ba.4modob.comb,"%Y-%m-%d"), units = c("days")) #possible units “auto”, “secs”, “mins”, “hours”, “days”, “weeks” #or simply a-b
describeFactors(data2$Delivery_too_early_indays)

data2$gestational_age_delivery_indays <- 280 - data2$Delivery_too_early_indays     #pregnancy is 40 weeks or 280 days

data2$gestational_age_delivery <- floor(time_length(data2$gestational_age_delivery_indays, "week"))
summary(data2$gestational_age_delivery)
describeFactors(data2$gestational_age_delivery)

#easier:
#data2$Delivery_too_early_inweeks <- difftime(as.Date(data2$bl1a_delive.4mo_date,"%Y-%m-%d"), as.Date(data2$p3ii_ba.4modob.comb,"%Y-%m-%d"), units = c("weeks")) 
#describeFactors(data2$Delivery_too_early_inweeks)
#data2$gestational_age_delivery_inweeks <- floor(40-data2$Delivery_too_early_inweeks)
#describeFactors(data2$gestational_age_delivery_inweeks)

data2 <- data2 %>% 
  mutate(
    gestational_age_cat = case_when(
      gestational_age_delivery < 28  ~ "<28 weeks",
      gestational_age_delivery >= 28 & gestational_age_delivery <= 31  ~ "28-31 weeks",
      gestational_age_delivery >= 32 & gestational_age_delivery <= 33 ~ "32-33 weeks",
      gestational_age_delivery >= 34 & gestational_age_delivery <= 36 ~ "34-36 weeks",
      gestational_age_delivery >= 37 & gestational_age_delivery <= 39 ~ "37-39 weeks",
      gestational_age_delivery > 39  ~ ">39 weeks",
    )
  )
describeFactors(data2$gestational_age_cat)
data2$gestational_age_cat <- factor(data2$gestational_age_cat, levels = c("<28 weeks", "28-31 weeks", "32-33 weeks", "34-36 weeks", "37-39 weeks", ">39 weeks"))




### p11_numbabies (tells if singleton, twins, etc – maybe we need to exclude or otherwise consider multiple pregnancies)

data2$p11_numbabies.comb <- mapply(paste, data2$p11_numbabies, data2$p11_numbabies.2mo, data2$p11_numbabies.4mo, sep="/")

data2$p11_numbabies.comb <- gsub("/NA","",data2$p11_numbabies.comb)
data2$p11_numbabies.comb <- gsub("NA/","",data2$p11_numbabies.comb)
describeFactors(data2$p11_numbabies.comb)
data2$p11_numbabies.comb <- factor(data2$p11_numbabies.comb, levels = c(1,2,3), labels = c("one baby", "twins", "triplets or more"))
describeFactors(data2$p11_numbabies.comb)


### p12_delivered (mode of delivery)
data2$p12_delivered.comb <- mapply(paste, data2$p12_delivered, data2$p12_delivered.2mo, data2$p12_delivered.4mo, sep="/")
describeFactors(data2$p12_delivered.comb)

data2$p12_delivered.comb <- gsub("/NA","",data2$p12_delivered.comb)
data2$p12_delivered.comb <- gsub("NA/","",data2$p12_delivered.comb)
describeFactors(data2$p12_delivered.comb)
data2$p12_delivered.comb <- factor(data2$p12_delivered.comb, levels = c(1,2,3), labels = c("Vaginal", "Assisted vaginal", "C-section"))
describeFactors(data2$p12_delivered.comb)

### p13_emergcs (emergency c section or not)
data2$p13_emergcs.comb <- mapply(paste, data2$p13_emergcs, data2$p13_emergcs.2mo, data2$p13_emergcs.4mo, sep="/")
describeFactors(data2$p13_emergcs.comb)

data2$p13_emergcs.comb <- gsub("/NA","",data2$p13_emergcs.comb)
data2$p13_emergcs.comb <- gsub("NA/","",data2$p13_emergcs.comb)
describeFactors(data2$p13_emergcs.comb)
data2$p13_emergcs.comb <- factor(data2$p13_emergcs.comb, levels = c(0,1,999), labels = c("No", "Yes", "Unknown"))
describeFactors(data2$p13_emergcs.comb)

### p14_emergcs_reason (reason for c section)
describeFactors(mapply(paste, data2$p14_emergcs_reason___1, data2$p14_emergcs_reason___1.2mo, data2$p14_emergcs_reason___1.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p14_emergcs_reason___1.comb = case_when(
    apply(data2[,c("p14_emergcs_reason___1", "p14_emergcs_reason___1.2mo","p14_emergcs_reason___1.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p14_emergcs_reason___1) & is.na(data2$p14_emergcs_reason___1.2mo) & is.na(data2$p14_emergcs_reason___1.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$p14_emergcs_reason___1.comb)
data2$p14_emergcs_reason___1.comb <- factor(data2$p14_emergcs_reason___1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p14_emergcs_reason___1.comb)


describeFactors(mapply(paste, data2$p14_emergcs_reason___2, data2$p14_emergcs_reason___2.2mo, data2$p14_emergcs_reason___2.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p14_emergcs_reason___2.comb = case_when(
    apply(data2[,c("p14_emergcs_reason___2", "p14_emergcs_reason___2.2mo","p14_emergcs_reason___2.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p14_emergcs_reason___2) & is.na(data2$p14_emergcs_reason___2.2mo) & is.na(data2$p14_emergcs_reason___2.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$p14_emergcs_reason___2.comb)
data2$p14_emergcs_reason___2.comb <- factor(data2$p14_emergcs_reason___2.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p14_emergcs_reason___2.comb)


describeFactors(mapply(paste, data2$p14_emergcs_reason___3, data2$p14_emergcs_reason___3.2mo, data2$p14_emergcs_reason___3.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p14_emergcs_reason___3.comb = case_when(
    apply(data2[,c("p14_emergcs_reason___3", "p14_emergcs_reason___3.2mo","p14_emergcs_reason___3.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p14_emergcs_reason___3) & is.na(data2$p14_emergcs_reason___3.2mo) & is.na(data2$p14_emergcs_reason___3.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$p14_emergcs_reason___3.comb)
data2$p14_emergcs_reason___3.comb <- factor(data2$p14_emergcs_reason___3.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p14_emergcs_reason___3.comb)


describeFactors(mapply(paste, data2$p14_emergcs_reason___4, data2$p14_emergcs_reason___4.2mo, data2$p14_emergcs_reason___4.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p14_emergcs_reason___4.comb = case_when(
    apply(data2[,c("p14_emergcs_reason___4", "p14_emergcs_reason___4.2mo","p14_emergcs_reason___4.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p14_emergcs_reason___4) & is.na(data2$p14_emergcs_reason___4.2mo) & is.na(data2$p14_emergcs_reason___4.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$p14_emergcs_reason___4.comb)
data2$p14_emergcs_reason___4.comb <- factor(data2$p14_emergcs_reason___4.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p14_emergcs_reason___4.comb)


describeFactors(mapply(paste, data2$p14_emergcs_reason___5, data2$p14_emergcs_reason___5.2mo, data2$p14_emergcs_reason___5.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p14_emergcs_reason___5.comb = case_when(
    apply(data2[,c("p14_emergcs_reason___5", "p14_emergcs_reason___5.2mo","p14_emergcs_reason___5.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p14_emergcs_reason___5) & is.na(data2$p14_emergcs_reason___5.2mo) & is.na(data2$p14_emergcs_reason___5.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$p14_emergcs_reason___5.comb)
data2$p14_emergcs_reason___5.comb <- factor(data2$p14_emergcs_reason___5.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p14_emergcs_reason___5.comb)



describeFactors(mapply(paste, data2$p14_emergcs_reason___998, data2$p14_emergcs_reason___998.2mo, data2$p14_emergcs_reason___998.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p14_emergcs_reason___998.comb = case_when(
    apply(data2[,c("p14_emergcs_reason___998", "p14_emergcs_reason___998.2mo","p14_emergcs_reason___998.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p14_emergcs_reason___998) & is.na(data2$p14_emergcs_reason___998.2mo) & is.na(data2$p14_emergcs_reason___998.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$p14_emergcs_reason___998.comb)
data2$p14_emergcs_reason___998.comb <- factor(data2$p14_emergcs_reason___998.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p14_emergcs_reason___998.comb)


describeFactors(mapply(paste, data2$p14_emergcs_reason___999, data2$p14_emergcs_reason___999.2mo, data2$p14_emergcs_reason___999.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(p14_emergcs_reason___999.comb = case_when(
    apply(data2[,c("p14_emergcs_reason___999", "p14_emergcs_reason___999.2mo","p14_emergcs_reason___999.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$p14_emergcs_reason___999) & is.na(data2$p14_emergcs_reason___999.2mo) & is.na(data2$p14_emergcs_reason___999.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$p14_emergcs_reason___999.comb)
data2$p14_emergcs_reason___999.comb <- factor(data2$p14_emergcs_reason___999.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$p14_emergcs_reason___999.comb)

data2$p14_emergcs_reason_other.comb <- mapply(paste, data2$p14_emergcs_reason_other, data2$p14_emergcs_reason_other.2mo, data2$p14_emergcs_reason_other.4mo, sep="/")
data2$p14_emergcs_reason_other.comb <- gsub("/NA","",data2$p14_emergcs_reason_other.comb)
data2$p14_emergcs_reason_other.comb <- gsub("NA/","",data2$p14_emergcs_reason_other.comb)
describeFactors(data2$p14_emergcs_reason_other.comb)

### p15_complications (delivery complications)
data2$p15_complications_fhr.comb <- mapply(paste, data2$p15_complications_fhr, data2$p15_complications_fhr.2mo, data2$p15_complications_fhr.4mo, sep="/")

describeFactors(data2$p15_complications_fhr.comb)
data2$p15_complications_fhr.comb <- gsub("/NA","",data2$p15_complications_fhr.comb)
data2$p15_complications_fhr.comb <- gsub("NA/","",data2$p15_complications_fhr.comb)
describeFactors(data2$p15_complications_fhr.comb)
data2$p15_complications_fhr.comb <- factor(data2$p15_complications_fhr.comb, levels = c(0,1,999), labels = c("No", "Yes", "Unknown"))
describeFactors(data2$p15_complications_fhr.comb)


data2$p15_complications_fever.comb <- mapply(paste, data2$p15_complications_fever, data2$p15_complications_fever.2mo, data2$p15_complications_fever.4mo, sep="/")

describeFactors(data2$p15_complications_fever.comb)
data2$p15_complications_fever.comb <- gsub("/NA","",data2$p15_complications_fever.comb)
data2$p15_complications_fever.comb <- gsub("NA/","",data2$p15_complications_fever.comb)
describeFactors(data2$p15_complications_fever.comb)
data2$p15_complications_fever.comb <- factor(data2$p15_complications_fever.comb, levels = c(0,1,999), labels = c("No", "Yes", "Unknown"))
describeFactors(data2$p15_complications_fever.comb)

data2$p15_complications_other.comb <- mapply(paste, data2$p15_complications_other, data2$p15_complications_other.2mo, data2$p15_complications_other.4mo, sep="/")

describeFactors(data2$p15_complications_other.comb)
data2$p15_complications_other.comb <- gsub("/NA","",data2$p15_complications_other.comb)
data2$p15_complications_other.comb <- gsub("NA/","",data2$p15_complications_other.comb)
describeFactors(data2$p15_complications_other.comb)
data2$p15_complications_other.comb <- factor(data2$p15_complications_other.comb, levels = c(0,1,999), labels = c("No", "Yes", "Unknown"))
describeFactors(data2$p15_complications_other.comb)


data2$p15_complications_info.comb <- mapply(paste, data2$p15_complications_info, data2$p15_complications_info.2mo, data2$p15_complications_info.4mo, sep="/")

describeFactors(data2$p15_complications_info.comb)
data2$p15_complications_info.comb <- gsub("/NA","",data2$p15_complications_info.comb)
data2$p15_complications_info.comb <- gsub("NA/","",data2$p15_complications_info.comb)
describeFactors(data2$p15_complications_info.comb)


### i3_birthweight1 combined with i3_birthweight_lb1 and i3_birthweight_g1 – please combine to just display all in grams; categories should be <2500 g, 2500-4000 g, >4000 g

data2$i3_birthweight_lb1.comb <- mapply(paste, data2$i3_birthweight_lb1, data2$i3_birthweight_lb1.2mo, data2$i3_birthweight_lb1.4mo, sep="/")


describeFactors(data2$i3_birthweight_lb1.comb)
data2$i3_birthweight_lb1.comb <- gsub("/NA","",data2$i3_birthweight_lb1.comb)
data2$i3_birthweight_lb1.comb <- gsub("NA/","",data2$i3_birthweight_lb1.comb)
describeFactors(data2$i3_birthweight_lb1.comb)


data2$i3_birthweight_g1.comb <- mapply(paste, data2$i3_birthweight_g1, data2$i3_birthweight_g1.2mo, data2$i3_birthweight_g1.4mo, sep="/")


describeFactors(data2$i3_birthweight_g1.comb)
data2$i3_birthweight_g1.comb <- gsub("/NA","",data2$i3_birthweight_g1.comb)
data2$i3_birthweight_g1.comb <- gsub("NA/","",data2$i3_birthweight_g1.comb)
describeFactors(data2$i3_birthweight_g1.comb)

data2$i3_birthweight_g1.comb[data2$i3_birthweight_g1.comb == "3700+"] <- "3700"
data2$record_id[data2$i3_birthweight_g1.comb == "350p"]  #2306
data2$i3_birthweight_g1.comb[data2$i3_birthweight_g1.comb == "350p"] <- "3500"


data2$i3_birthweight_lb1.comb2 <- data2$i3_birthweight_lb1.comb
data2$i3_birthweight_g1.comb2 <- data2$i3_birthweight_g1.comb
data2$record_id[data2$i3_birthweight_g1.comb2 == "70"] #932
data2$i3_birthweight_lb1.comb2[data2$i3_birthweight_g1.comb2 == "70"] <- "7+0"
data2$i3_birthweight_g1.comb2[data2$i3_birthweight_lb1.comb2 == "7+0" & data2$i3_birthweight_g1.comb2 == "70"] <- NA
data2$record_id[data2$i3_birthweight_lb1.comb2 == "3600"]  #179
data2$i3_birthweight_g1.comb2[data2$i3_birthweight_lb1.comb2 == "3600"] <- "3600"
data2$i3_birthweight_lb1.comb2[data2$i3_birthweight_lb1.comb2 == "3600" & data2$i3_birthweight_g1.comb2 == "3600"] <- NA
data2$record_id[data2$i3_birthweight_lb1.comb2 == "8kb+139z"] #1340
data2$i3_birthweight_lb1.comb2[data2$i3_birthweight_lb1.comb2 == "8kb+139z"] <- "8 lbs 13"
data2$record_id[data2$i3_birthweight_lb1.comb2 == "8.e"]  #2914
data2$i3_birthweight_lb1.comb2[data2$i3_birthweight_lb1.comb2 == "8.e"] <- "8"
data2$i3_birthweight_lb1.comb2[data2$i3_birthweight_lb1.comb2 == "612"] <- "6 + 12"
data2$i3_birthweight_lb1.comb2[data2$i3_birthweight_lb1.comb2 == "707"] <- "7 + 7"
data2$i3_birthweight_lb1.comb2[data2$i3_birthweight_lb1.comb2 == "710"] <- "7 + 10"
data2$i3_birthweight_lb1.comb2[data2$i3_birthweight_lb1.comb2 == "714"] <- "7 + 14"
data2$i3_birthweight_lb1.comb2[data2$i3_birthweight_lb1.comb2 == "73"] <- "7 + 3"
data2$i3_birthweight_lb1.comb2[data2$i3_birthweight_lb1.comb2 == "76"] <- "7 + 6"
data2$i3_birthweight_lb1.comb2[data2$i3_birthweight_lb1.comb2 == "81"] <- "8 + 1"
data2$i3_birthweight_lb1.comb2[data2$i3_birthweight_lb1.comb2 == "87"] <- "8 + 7"
data2$i3_birthweight_lb1.comb2[data2$i3_birthweight_lb1.comb2 == "99"] <- "9 + 9"
data2$i3_birthweight_lb1.comb2[data2$i3_birthweight_lb1.comb2 == "99"] <- "9 + 9"

data2$i3_birthweight_lb1.comb2 <- gsub("lbs,","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("lbs  ","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("lbs","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("lds","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("lba","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("lb.","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("lb","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("Lbs","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("Lb","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("ibs","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("and","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("pounds","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("pound","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("plus","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("bs, ","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("&","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("'","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("\"","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub(",","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("-","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub(":","+",data2$i3_birthweight_lb1.comb2)

data2$i3_birthweight_lb1.comb2 <- gsub("ozs","",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("oz","",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("ox","",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("iz","",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("ounces","",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("ounced","",data2$i3_birthweight_lb1.comb2)

data2$i3_birthweight_lb1.comb2 <- gsub(" \\+","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("\\+ ","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- gsub("\\+\\+","+",data2$i3_birthweight_lb1.comb2)
data2$i3_birthweight_lb1.comb2 <- sub("\\+$", "", data2$i3_birthweight_lb1.comb2)

#remove empty spaces at the beginning and end of string
data2$i3_birthweight_lb1.comb2 <- trimws(data2$i3_birthweight_lb1.comb2, which = c("both"))  #which = c("right", "left", "both")
data2$i3_birthweight_lb1.comb2 <- gsub(" ","+",data2$i3_birthweight_lb1.comb2)
describeFactors(data2$i3_birthweight_lb1.comb2)

#splits a+b into two separate columns a and b
data2$birthweight_lbs_prelim <- sapply(strsplit(as.character(data2$i3_birthweight_lb1.comb2),"\\+"), "[", 1)
data2$birthweight_oz1 <- sapply(strsplit(as.character(data2$i3_birthweight_lb1.comb2),"\\+"), "[", 2)

#set those to NA where the decimal places are <=16 as we do not know as these are decimal places or oz
#data2$birthweight_lbs_prelim[as.numeric(sapply(strsplit(as.character(data2$birthweight_lbs_prelim),"\\."), "[", 2)) > 0 & as.numeric(sapply(strsplit(as.character(data2$birthweight_lbs_prelim),"\\."), "[", 2)) <= 16] <- NA

#splits a.b into two separate columns a and b if the decimal places are in (0,16]
data2$birthweight_oz2 <- sapply(data2$birthweight_lbs_prelim, function(x) ifelse((as.numeric(sapply(strsplit(as.character(x),"\\."), "[", 2)) > 0 & as.numeric(sapply(strsplit(as.character(x),"\\."), "[", 2)) <= 16) %in% TRUE, sapply(strsplit(as.character(x),"\\."), "[", 2), NA))
data2$birthweight_lbs_prelim <- sapply(data2$birthweight_lbs_prelim, function(x) ifelse((as.numeric(sapply(strsplit(as.character(x),"\\."), "[", 2)) > 0 & as.numeric(sapply(strsplit(as.character(x),"\\."), "[", 2)) <= 16) %in% TRUE, sapply(strsplit(as.character(x),"\\."), "[", 1), x))

data2$birthweight_oz <- mapply(paste, data2$birthweight_oz1, data2$birthweight_oz2, sep="/")
data2$birthweight_oz <- gsub("/NA","",data2$birthweight_oz)
data2$birthweight_oz <- gsub("NA/","",data2$birthweight_oz)
describeFactors(data2$birthweight_oz)
data2$birthweight_oz <- gsub("NA","0",data2$birthweight_oz)

#View(data2[c(4169,4110,3755),c("i3_birthweight_lb1.comb","i3_birthweight_lb1.comb2", "birthweight_lbs_prelim","birthweight_oz1", "birthweight_oz2", "birthweight_oz")])


describeFactors(data2$birthweight_oz)
data2$birthweight_lbs <- as.numeric(data2$birthweight_lbs_prelim) + as.numeric(data2$birthweight_oz)/16

#1 pound (lb) is equal to 453.59237 grams (g)
data2$birthweight_lbs_to_g <- round(data2$birthweight_lbs * 453.59237)
describeFactors(data2$birthweight_lbs_to_g)

#birthweight_interpretation <- data2[,c("i3_birthweight_lb1.comb", "birthweight_lbs_prelim", "birthweight_oz", "birthweight_lbs", "birthweight_lbs_to_g")]
#birthweight_interpretation <- birthweight_interpretation[order(birthweight_interpretation$birthweight_lbs_to_g),]
#library("xtable")
#print(xtable(birthweight_interpretation), type = "html", file="CheckDataRealistic/birthweight_interpretation.html")
#write.csv(birthweight_interpretation,'CheckDataRealistic/birthweight_interpretation.csv')


describeFactors(data2$i3_birthweight_g1.comb2)
data2$i3_birthweight_g1.comb2 <- gsub("KG","",data2$i3_birthweight_g1.comb2)
data2$i3_birthweight_g1.comb2 <- gsub("kg","",data2$i3_birthweight_g1.comb2)

#View(data2[data2$i3_birthweight_g1.comb2 == "418"|data2$i3_birthweight_g1.comb2 == "107-"|data2$i3_birthweight_g1.comb2 == "330"|data2$i3_birthweight_g1.comb2 == "313"|data2$i3_birthweight_g1.comb2 == "270"|  data2$i3_birthweight_g1.comb2 == "610" | data2$i3_birthweight_g1.comb2 == "750" | data2$i3_birthweight_g1.comb2 == "830", c("i3_birthweight_g1.comb2", "i1_dob1.comb", "bl1a_delive.4mo_date", "p3i_preterm.comb", "p3ii_ba.4modob.comb","p1_situation.comb")])

data2$record_id[data2$i3_birthweight_g1.comb2 == "107-"]  #5433
data2$i3_birthweight_g1.comb2[data2$i3_birthweight_g1.comb2 == "107-"] <- "1070"  #preterm, baby still in hospital
data2$record_id[data2$i3_birthweight_g1.comb2 == "330"] #5134
data2$i3_birthweight_g1.comb2[data2$i3_birthweight_g1.comb2 == "330"] <- NA #"3300"  #no preterm, baby lives at home with mother
data2$record_id[data2$i3_birthweight_g1.comb2 == "313"] #1269
data2$i3_birthweight_g1.comb2[data2$i3_birthweight_g1.comb2 == "313"] <- NA #"3130"  #no preterm, baby lives at home with mother
data2$record_id[data2$i3_birthweight_g1.comb2 == "270"]  #2502
data2$i3_birthweight_g1.comb2[data2$i3_birthweight_g1.comb2 == "270"] <- NA #"2700"  #no preterm, baby lives at home with mother
data2$record_id[data2$i3_birthweight_g1.comb2 == "418"]   #3010
data2$i3_birthweight_g1.comb2[data2$i3_birthweight_g1.comb2 == "418"] <- NA #probably "4180"  #no preterm, baby lives at home with mother
data2$i3_birthweight_g1.comb2[data2$i3_birthweight_g1.comb2 == "4,654"] <- 4654 
#data2$i3_birthweight_g1.comb2[data2$i3_birthweight_g1.comb2 == "610"] <- NA  #preterm, baby still in hospital
#data2$i3_birthweight_g1.comb2[data2$i3_birthweight_g1.comb2 == "750"] <- NA  #preterm, baby still in hospital
#data2$i3_birthweight_g1.comb2[data2$i3_birthweight_g1.comb2 == "830"] <- NA  #preterm, baby lives at home with mother  In general, preemies can maintain their own body temperature once they weigh about 4 pounds(2kg)



#describeFactors(data2$record_id[as.numeric(data2$i3_birthweight_g1.comb2) %% 1 != 0.000])
#224, 631, 751, 936, 1095, 1267, 1487, 1539, 2178, 2566, 2619, 2633, 2643, 3109, 3186, 3858, 4031, 4215, 4325, 4391, 4721, 4761, 4829, 4868, 4966, 5341 

#if it is a decimal number (modulo 1 unequal 0), multiply by 1000 
data2$i3_birthweight_g1.comb22 <- gsub("\\,","\\.",data2$i3_birthweight_g1.comb2)
data2$i3_birthweight_g1.comb22 <- sapply(as.numeric(data2$i3_birthweight_g1.comb2),function(x) ifelse(x%%1,x*1000,x))

data2$birthweight_in_g <- mapply(paste, data2$i3_birthweight_g1.comb22, data2$birthweight_lbs_to_g, sep="/")


describeFactors(data2$birthweight_in_g)
data2$birthweight_in_g <- gsub("/NA","",data2$birthweight_in_g)
data2$birthweight_in_g <- gsub("NA/","",data2$birthweight_in_g)
describeFactors(data2$birthweight_in_g)
data2$birthweight_in_g____1 <- as.numeric(data2$birthweight_in_g)

##CHECK IF BIRTHWEIGHT REALISTIC (normal range between 2500 and 4500)
#data_birthweight <-  data2[, c( "birthweight_in_g","i3_birthweight_g1.comb", "i3_birthweight_lb1.comb", "i1_dob1.comb", #"bl1a_delive.4mo_date", "p3i_preterm.comb", "p3ii_ba.4modob.comb","p1_situation.comb")]
#data_birthweight <- data_birthweight[order(data_birthweight$birthweight_in_g),]  
#library("xtable")
#print(xtable(data_birthweight), type = "html", file="CheckDataRealistic/data_birthweight.html")
#write.csv(data_birthweight,'CheckDataRealistic/data_birthweight.csv')





#TABLE WITH CORRECTIONS:
#corrected_birthweight <- data2[data2$record_id %in% c(2306, 932, 179, 1340, 2914, 5433, 5134, 1269, 2502, 3010), c("record_id", "i3_birthweight_g1.comb22", "i3_birthweight_lb1.comb2", " *** ", "i3_birthweight_lb1", "i3_birthweight_lb1.2mo", "i3_birthweight_lb1.4mo", "i3_birthweight_g1", "i3_birthweight_g1.2mo", "i3_birthweight_g1.4mo")]
##record_ids with kg instead of g
##224, 631, 751, 936, 1095, 1267, 1487, 1539, 2178, 2566, 2619, 2633, 2643, 3109, 3186, 3858, 4031, 4215, 4325, 4391, 4721, 4761, 4829, 4868, 4966, 5341
#View(corrected_birthweight)

#library("xtable")
#print(xtable(corrected_birthweight), type = "html", file="Corrections/corrected_birthweight.html")
#write.csv(corrected_birthweight,'Corrections/corrected_birthweight.csv')





### i4_birthlength1 – ibid, combine with the two variables below it to just display all in cm

data2$i4_birthlength_in1.comb <- mapply(paste, data2$i4_birthlength_in1, data2$i4_birthlength_in1.2mo, data2$i4_birthlength_in1.4mo, sep="/")

describeFactors(data2$i4_birthlength_in1.comb)
data2$i4_birthlength_in1.comb <- gsub("/NA","",data2$i4_birthlength_in1.comb)
data2$i4_birthlength_in1.comb <- gsub("NA/","",data2$i4_birthlength_in1.comb)
describeFactors(data2$i4_birthlength_in1.comb)


data2$i4_birthlength_in1.comb2 <- data2$i4_birthlength_in1.comb
data2$i4_birthlength_in1.comb2 <- gsub("inches","",data2$i4_birthlength_in1.comb2)
data2$i4_birthlength_in1.comb2 <- gsub("in","",data2$i4_birthlength_in1.comb2)
data2$i4_birthlength_in1.comb2 <- gsub(" and","",data2$i4_birthlength_in1.comb2)
data2$i4_birthlength_in1.comb2 <- gsub("\"","",data2$i4_birthlength_in1.comb2)
data2$i4_birthlength_in1.comb2 <- gsub(" 3/4",".75",data2$i4_birthlength_in1.comb2)
data2$i4_birthlength_in1.comb2 <- gsub("+3/4",".75",data2$i4_birthlength_in1.comb2)
data2$i4_birthlength_in1.comb2 <- gsub(" 1/4",".25",data2$i4_birthlength_in1.comb2)
data2$i4_birthlength_in1.comb2 <- gsub(" \\+","",data2$i4_birthlength_in1.comb2)
data2$i4_birthlength_in1.comb2 <- gsub("\\+","",data2$i4_birthlength_in1.comb2)
data2$i4_birthlength_in1.comb2 <- gsub(",",".",data2$i4_birthlength_in1.comb2)

describeFactors(data2$i4_birthlength_in1.comb2)

#set 31 to NA, everything bigger than 42.5 is already cm
data2$record_id[data2$i4_birthlength_in1.comb == 31]  #3620
data2$i4_birthlength_in1.comb2[data2$i4_birthlength_in1.comb2 == 31 & !is.na(data2$i4_birthlength_in1.comb2)] <- NA

#INCH TO CM: 1 in = 2.54 cm
data2$i4_birthlength_in1_to_cm <- sapply(as.numeric(data2$i4_birthlength_in1.comb2), function(x) ifelse((x < 42.5) %in% TRUE, x * 2.54, x))

data2$i4_birthlength_cm1.comb <- mapply(paste, data2$i4_birthlength_cm1, data2$i4_birthlength_cm1.2mo, data2$i4_birthlength_cm1.4mo, sep="/")
describeFactors(data2$i4_birthlength_cm1.comb)
data2$i4_birthlength_cm1.comb <- gsub("/NA","",data2$i4_birthlength_cm1.comb)
data2$i4_birthlength_cm1.comb <- gsub("NA/","",data2$i4_birthlength_cm1.comb)
describeFactors(data2$i4_birthlength_cm1.comb)

#View(data2[data2$i4_birthlength_cm1.comb == 21,c("i4_birthlength_cm1.comb", "p3i_preterm.comb", "p1_situation.comb")])  #all no preterm babies

data2$i4_birthlength_cm1.comb2 <- data2$i4_birthlength_cm1.comb
data2$record_id[data2$i4_birthlength_cm1.comb == "170"] #932
data2$i4_birthlength_cm1.comb2[data2$i4_birthlength_cm1.comb2 == "170"] <- NA
data2$record_id[data2$i4_birthlength_cm1.comb == "96.5"] #1927
data2$i4_birthlength_cm1.comb2[data2$i4_birthlength_cm1.comb2 == "96.5"] <- NA
data2$i4_birthlength_cm1.comb2 <- gsub("cm","",data2$i4_birthlength_cm1.comb2)
data2$i4_birthlength_cm1.comb2 <- gsub("\"","",data2$i4_birthlength_cm1.comb2)
data2$i4_birthlength_cm1.comb2 <- gsub(",",".",data2$i4_birthlength_cm1.comb2)
describeFactors(data2$i4_birthlength_cm1.comb2)

#x <= 27 might be inches: INCH TO CM: 1 in = 2.54 cm
data2$i4_birthlength_cm1.comb22 <- sapply(as.numeric(data2$i4_birthlength_cm1.comb2), function(x) ifelse((x <= 27) %in% TRUE, x * 2.54, x))
describeFactors(data2$i4_birthlength_cm1.comb22)



data2$birthlength_in_cm <- mapply(paste, data2$i4_birthlength_cm1.comb22, data2$i4_birthlength_in1_to_cm, sep="/")
data2$birthlength_in_cm <- gsub("/NA","",data2$birthlength_in_cm)
data2$birthlength_in_cm <- gsub("NA/","",data2$birthlength_in_cm)
describeFactors(data2$birthlength_in_cm)
data2$birthlength_in_cm____1 <- as.numeric(data2$birthlength_in_cm)

##CHECK IF BIRTHLENGTH IS REALISTIC (normal range is 46 cm (18 in.) to 56 cm (22 in.))
#data_birthlength <- data2[, c("birthlength_in_cm", "i4_birthlength_in1.comb","i4_birthlength_cm1.comb", "i1_dob1.comb", #"bl1a_delive.4mo_date", "p3i_preterm.comb", "p3ii_ba.4modob.comb","p1_situation.comb")]
#data_birthlength <- data_birthlength[order(data_birthlength$birthlength_in_cm),]  
#library("xtable")
#print(xtable(data_birthlength), type = "html", file="CheckDataRealistic/data_birthlength.html")
#write.csv(data_birthlength,'CheckDataRealistic/data_birthlength.csv')

#TABLE WITH CORRECTIONS:
#corrected_birthlength <- data2[data2$record_id %in% c(3620, 932, 1927), c("record_id", "i4_birthlength_cm1.comb2", "i4_birthlength_in1.comb2", " *** ", "i4_birthlength_in1", "i4_birthlength_in1.2mo", "i4_birthlength_in1.4mo", "i4_birthlength_cm1", "i4_birthlength_cm1.2mo", "i4_birthlength_cm1.4mo")]
#View(corrected_birthlength)

#library("xtable")
#print(xtable(corrected_birthlength), type = "html", file="Corrections/corrected_birthlength.html")
#write.csv(corrected_birthlength,'Corrections/corrected_birthlength.csv')





### i5_events1 and all info that follows about infant health events

data2$i5_events1.comb <- mapply(paste, data2$i5_events1, data2$i5_events1.2mo, data2$i5_events1.4mo, sep="/")

describeFactors(data2$i5_events1.comb)
data2$i5_events1.comb <- gsub("/NA","",data2$i5_events1.comb)
data2$i5_events1.comb <- gsub("NA/","",data2$i5_events1.comb)
describeFactors(data2$i5_events1.comb)

data2$i5_events.comb____1 <- factor(data2$i5_events1.comb, levels = c(0,1,999), labels = c("No", "Yes", "Unknown"))
describeFactors(data2$i5_events.comb____1)

data2$i5_events_jaundice1.comb <- mapply(paste, data2$i5_events_jaundice1, data2$i5_events_jaundice1.2mo, data2$i5_events_jaundice1.4mo, sep="/")

describeFactors(data2$i5_events_jaundice1.comb)
data2$i5_events_jaundice1.comb <- gsub("/NA","",data2$i5_events_jaundice1.comb)
data2$i5_events_jaundice1.comb <- gsub("NA/","",data2$i5_events_jaundice1.comb)
describeFactors(data2$i5_events_jaundice1.comb)

data2$i5_events_jaundice.comb____1 <- factor(data2$i5_events_jaundice1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$i5_events_jaundice.comb____1)


data2$i5_events_photo1.comb <- mapply(paste, data2$i5_events_photo1, data2$i5_events_photo1.2mo, data2$i5_events_photo1.4mo, sep="/")

describeFactors(data2$i5_events_photo1.comb)
data2$i5_events_photo1.comb <- gsub("/NA","",data2$i5_events_photo1.comb)
data2$i5_events_photo1.comb <- gsub("NA/","",data2$i5_events_photo1.comb)
describeFactors(data2$i5_events_photo1.comb)

data2$i5_events_photo.comb____1 <- factor(data2$i5_events_photo1.comb, levels = c(0,1,999), labels = c("No", "Yes","Unknown"))
describeFactors(data2$i5_events_photo.comb____1)


data2$i5_events_seizures1.comb <- mapply(paste, data2$i5_events_seizures1, data2$i5_events_seizures1.2mo, data2$i5_events_seizures1.4mo, sep="/")

describeFactors(data2$i5_events_seizures1.comb)
data2$i5_events_seizures1.comb <- gsub("/NA","",data2$i5_events_seizures1.comb)
data2$i5_events_seizures1.comb <- gsub("NA/","",data2$i5_events_seizures1.comb)
describeFactors(data2$i5_events_seizures1.comb)

data2$i5_events_seizures.comb____1 <- factor(data2$i5_events_seizures1.comb, levels = c(0,1,999), labels = c("No", "Yes","Unknown"))
describeFactors(data2$i5_events_seizures.comb____1)


data2$i5_events_.4mopog.4mo1.comb <- mapply(paste, data2$i5_events_.4mopog.4mo1, data2$i5_events_.4mopog.4mo1.2mo, data2$i5_events_.4mopog.4mo1.4mo, sep="/") #i5_events_hypogly1

describeFactors(data2$i5_events_.4mopog.4mo1.comb)
data2$i5_events_.4mopog.4mo1.comb <- gsub("/NA","",data2$i5_events_.4mopog.4mo1.comb)
data2$i5_events_.4mopog.4mo1.comb <- gsub("NA/","",data2$i5_events_.4mopog.4mo1.comb)
describeFactors(data2$i5_events_.4mopog.4mo1.comb)

data2$i5_events_.4mopog.4mo.comb____1 <- factor(data2$i5_events_.4mopog.4mo1.comb, levels = c(0,1,999), labels = c("No", "Yes","Unknown"))
describeFactors(data2$i5_events_.4mopog.4mo.comb____1)


data2$i5_events_fever1.comb <- mapply(paste, data2$i5_events_fever1, data2$i5_events_fever1.2mo, data2$i5_events_fever1.4mo, sep="/") 

describeFactors(data2$i5_events_fever1.comb)
data2$i5_events_fever1.comb <- gsub("/NA","",data2$i5_events_fever1.comb)
data2$i5_events_fever1.comb <- gsub("NA/","",data2$i5_events_fever1.comb)
describeFactors(data2$i5_events_fever1.comb)

data2$i5_events_fever.comb____1 <- factor(data2$i5_events_fever1.comb, levels = c(0,1,999), labels = c("No", "Yes","Unknown"))
describeFactors(data2$i5_events_fever.comb____1)



data2$i5_events_vent1.comb <- mapply(paste, data2$i5_events_vent1, data2$i5_events_vent1.2mo, data2$i5_events_vent1.4mo, sep="/") 

describeFactors(data2$i5_events_vent1.comb)
data2$i5_events_vent1.comb <- gsub("/NA","",data2$i5_events_vent1.comb)
data2$i5_events_vent1.comb <- gsub("NA/","",data2$i5_events_vent1.comb)
describeFactors(data2$i5_events_vent1.comb)

data2$i5_events_vent.comb____1 <- factor(data2$i5_events_vent1.comb, levels = c(0,1,999), labels = c("No", "Yes","Unknown"))
describeFactors(data2$i5_events_vent.comb____1)



data2$i5_events_other1.comb <- mapply(paste, data2$i5_events_other1, data2$i5_events_other1.2mo, data2$i5_events_other1.4mo, sep="/") 

describeFactors(data2$i5_events_other1.comb)
data2$i5_events_other1.comb <- gsub("/NA","",data2$i5_events_other1.comb)
data2$i5_events_other1.comb <- gsub("NA/","",data2$i5_events_other1.comb)
describeFactors(data2$i5_events_other1.comb)

data2$i5_events_other.comb____1 <- factor(data2$i5_events_other1.comb, levels = c(0,1,999), labels = c("No", "Yes","Unknown"))
describeFactors(data2$i5_events_other.comb____1)


describeFactors(data2$i5_events_other_info1)

### If there is a second infant: i3_birthweight2, i4_birthlength2, i5_events2 and all event info that follows

# i3_birthweight1 combined with i3_birthweight_lb1 and i3_birthweight_g1 – please combine to just display all in grams; categories should be <2500 g, 2500-4000 g, >4000 g

data2$i3_birthweight_lb2.comb <- mapply(paste, data2$i3_birthweight_lb2, data2$i3_birthweight_lb2.2mo, data2$i3_birthweight_lb2.4mo, sep="/")


describeFactors(data2$i3_birthweight_lb2.comb)
data2$i3_birthweight_lb2.comb <- gsub("/NA","",data2$i3_birthweight_lb2.comb)
data2$i3_birthweight_lb2.comb <- gsub("NA/","",data2$i3_birthweight_lb2.comb)
describeFactors(data2$i3_birthweight_lb2.comb)


data2$i3_birthweight_g2.comb <- mapply(paste, data2$i3_birthweight_g2, data2$i3_birthweight_g2.2mo, data2$i3_birthweight_g2.4mo, sep="/")

describeFactors(data2$i3_birthweight_g2.comb)
data2$i3_birthweight_g2.comb <- gsub("/NA","",data2$i3_birthweight_g2.comb)
data2$i3_birthweight_g2.comb <- gsub("NA/","",data2$i3_birthweight_g2.comb)
describeFactors(data2$i3_birthweight_g2.comb)

data2$i3_birthweight_lb2.comb2 <- data2$i3_birthweight_lb2.comb
data2$i3_birthweight_g2.comb2 <- data2$i3_birthweight_g2.comb

data2$i3_birthweight_lb2.comb2 <- gsub("lbs,","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("lbs","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("lb","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("Lbs","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("Lb","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("and","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("pounds","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("pound","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("plus","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("&","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("'","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("\"","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub(",","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("-","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub(":","+",data2$i3_birthweight_lb2.comb2)

data2$i3_birthweight_lb2.comb2 <- gsub("ozs","",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("oz","",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("ounces","",data2$i3_birthweight_lb2.comb2)

data2$i3_birthweight_lb2.comb2 <- gsub(" \\+","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("\\+ ","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- gsub("\\+\\+","+",data2$i3_birthweight_lb2.comb2)
data2$i3_birthweight_lb2.comb2 <- sub("\\+$", "", data2$i3_birthweight_lb2.comb2)

#remove empty spaces at the beginning and end of string
data2$i3_birthweight_lb2.comb2 <- trimws(data2$i3_birthweight_lb2.comb2, which = c("both"))  #which = c("right", "left", "both")
data2$i3_birthweight_lb2.comb2 <- gsub(" ","+",data2$i3_birthweight_lb2.comb2)
describeFactors(data2$i3_birthweight_lb2.comb2)

#splits a+b into two separate columns a and b
data2$birthweight2_lbs_prelim <- sapply(strsplit(as.character(data2$i3_birthweight_lb2.comb2),"\\+"), "[", 1)
data2$birthweight2_oz1 <- sapply(strsplit(as.character(data2$i3_birthweight_lb2.comb2),"\\+"), "[", 2)

#splits a.b into two separate columns a and b if the decimal places are in (0,16]
data2$birthweight2_oz2 <- sapply(data2$birthweight2_lbs_prelim, function(x) ifelse((as.numeric(sapply(strsplit(as.character(x),"\\."), "[", 2)) > 0 & as.numeric(sapply(strsplit(as.character(x),"\\."), "[", 2)) <= 16) %in% TRUE, sapply(strsplit(as.character(x),"\\."), "[", 2), NA))
data2$birthweight2_lbs_prelim <- sapply(data2$birthweight2_lbs_prelim, function(x) ifelse((as.numeric(sapply(strsplit(as.character(x),"\\."), "[", 2)) > 0 & as.numeric(sapply(strsplit(as.character(x),"\\."), "[", 2)) <= 16) %in% TRUE, sapply(strsplit(as.character(x),"\\."), "[", 1), x))

data2$birthweight2_oz <- mapply(paste, data2$birthweight2_oz1, data2$birthweight2_oz2, sep="/")
data2$birthweight2_oz <- gsub("/NA","",data2$birthweight2_oz)
data2$birthweight2_oz <- gsub("NA/","",data2$birthweight2_oz)
describeFactors(data2$birthweight2_oz)

#View(data2[,c("i3_birthweight2_lb1.comb","i3_birthweight2_lb1.comb2", "birthweight2_lbs_prelim","birthweight2_oz1", "birthweight2_oz2", "birthweight2_oz")])

data2$birthweight2_oz <- gsub("NA","0",data2$birthweight2_oz)
data2$birthweight2_lbs <- as.numeric(data2$birthweight2_lbs_prelim) + as.numeric(data2$birthweight2_oz)/16

#1 pound (lb) is equal to 453.59237 grams (g)
data2$birthweight2_lbs_to_g <- round(data2$birthweight2_lbs * 453.59237)
describeFactors(data2$birthweight2_lbs_to_g)

birthweight2_interpretation <- data2[,c("i3_birthweight_lb2.comb", "birthweight2_lbs_prelim", "birthweight2_oz", "birthweight2_lbs", "birthweight2_lbs_to_g")]
#library("xtable")
#print(xtable(birthweight2_interpretation), type = "html", file="CheckDataRealistic/birthweight2_interpretation.html")
#write.csv(birthweight2_interpretation,'CheckDataRealistic/birthweight2_interpretation.csv')


describeFactors(data2$i3_birthweight_g2.comb2)
#data2$i3_birthweight_g2.comb2 <- gsub("KG","",data2$i3_birthweight_g2.comb2)
#data2$i3_birthweight_g2.comb2 <- gsub("kg","",data2$i3_birthweight_g2.comb2)


#if it is a decimal number (modulo 1 unequal 0), multiply by 1000 
data2$i3_birthweight_g2.comb22 <- gsub(",",".",data2$i3_birthweight_g2.comb2)
data2$i3_birthweight_g2.comb22 <- sapply(as.numeric(data2$i3_birthweight_g2.comb2),function(x) ifelse(x%%1,x*1000,x))
describeFactors(data2$i3_birthweight_g2.comb22)
data2$birthweight2_in_g <- mapply(paste, data2$i3_birthweight_g2.comb22, data2$birthweight2_lbs_to_g, sep="/")


describeFactors(data2$birthweight2_in_g)
data2$birthweight2_in_g <- gsub("/NA","",data2$birthweight2_in_g)
data2$birthweight2_in_g <- gsub("NA/","",data2$birthweight2_in_g)
describeFactors(data2$birthweight2_in_g)
data2$birthweight_in_g____2 <- as.numeric(data2$birthweight2_in_g)

##CHECK IF BIRTHWEIGHT REALISTIC (normal range between 2500 and 4500)
#data_birthweight2 <-  data2[, c( "birthweight2_in_g","i3_birthweight_g2.comb", "i3_birthweight_lb2.comb", "i1_dob1.comb", "bl1a_delive.4mo_date", "p3i_preterm.comb", "p3ii_ba.4modob.comb","p1_situation.comb", "birthweight_in_g","i3_birthweight_g1.comb","i3_birthweight_lb1.comb")]
#data_birthweight2 <- data_birthweight2[order(data_birthweight2$birthweight2_in_g),]  
#library("xtable")
#print(xtable(data_birthweight2), type = "html", file="CheckDataRealistic/data_birthweight2.html")
#write.csv(data_birthweight2,'CheckDataRealistic/data_birthweight2.csv')


### i4_birthlength2 – ibid, combine with the two variables below it to just display all in cm

data2$i4_birthlength_in2.comb <- mapply(paste, data2$i4_birthlength_in2, data2$i4_birthlength_in2.2mo, data2$i4_birthlength_in2.4mo, sep="/")

describeFactors(data2$i4_birthlength_in2.comb)
data2$i4_birthlength_in2.comb <- gsub("/NA","",data2$i4_birthlength_in2.comb)
data2$i4_birthlength_in2.comb <- gsub("NA/","",data2$i4_birthlength_in2.comb)
describeFactors(data2$i4_birthlength_in2.comb)


data2$i4_birthlength_in2.comb2 <- data2$i4_birthlength_in2.comb
#data2$i4_birthlength_in2.comb2 <- gsub("inches","",data2$i4_birthlength_in2.comb2)
#data2$i4_birthlength_in2.comb2 <- gsub("in","",data2$i4_birthlength_in2.comb2)
#data2$i4_birthlength_in2.comb2 <- gsub(" and","",data2$i4_birthlength_in2.comb2)
#data2$i4_birthlength_in2.comb2 <- gsub("\"","",data2$i4_birthlength_in2.comb2)
#data2$i4_birthlength_in2.comb2 <- gsub(" 3/4",".75",data2$i4_birthlength_in2.comb2)
#data2$i4_birthlength_in2.comb2 <- gsub("+3/4",".75",data2$i4_birthlength_in2.comb2)
#data2$i4_birthlength_in2.comb2 <- gsub(" 1/4",".25",data2$i4_birthlength_in2.comb2)
#data2$i4_birthlength_in2.comb2 <- gsub(" \\+","",data2$i4_birthlength_in2.comb2)
#data2$i4_birthlength_in2.comb2 <- gsub("\\+","",data2$i4_birthlength_in2.comb2)
#data2$i4_birthlength_in2.comb2 <- gsub(",",".",data2$i4_birthlength_in2.comb2)
#describeFactors(data2$i4_birthlength_in2.comb2)

#INCH TO CM: 1 in = 2.54 cm
data2$i4_birthlength_in2_to_cm <- as.numeric(data2$i4_birthlength_in2.comb2)  * 2.54

data2$i4_birthlength_cm2.comb <- mapply(paste, data2$i4_birthlength_cm2, data2$i4_birthlength_cm2.2mo, data2$i4_birthlength_cm2.4mo, sep="/")

describeFactors(data2$i4_birthlength_cm2.comb)
data2$i4_birthlength_cm2.comb <- gsub("/NA","",data2$i4_birthlength_cm2.comb)
data2$i4_birthlength_cm2.comb <- gsub("NA/","",data2$i4_birthlength_cm2.comb)
describeFactors(data2$i4_birthlength_cm2.comb)

data2$i4_birthlength_cm2.comb2 <- data2$i4_birthlength_cm2.comb
#data2$i4_birthlength_cm2.comb2 <- gsub("cm","",data2$i4_birthlength_cm2.comb2)
#data2$i4_birthlength_cm2.comb2 <- gsub("\"","",data2$i4_birthlength_cm2.comb2)
#data2$i4_birthlength_cm2.comb2 <- gsub(",",".",data2$i4_birthlength_cm2.comb2)
#describeFactors(data2$i4_birthlength_cm2.comb2)

data2$i4_birthlength_cm2.comb22 <- sapply(as.numeric(data2$i4_birthlength_cm2.comb2), function(x) ifelse((x <= 21) %in% TRUE, x * 2.54, x))

data2$birthlength2_in_cm <- mapply(paste, data2$i4_birthlength_cm2.comb22, data2$i4_birthlength_in2_to_cm, sep="/")
data2$birthlength2_in_cm <- gsub("/NA","",data2$birthlength2_in_cm)
data2$birthlength2_in_cm <- gsub("NA/","",data2$birthlength2_in_cm)
describeFactors(data2$birthlength2_in_cm)
data2$birthlength_in_cm____2 <- as.numeric(data2$birthlength2_in_cm)

##CHECK IF BIRTHLENGTH IS REALISTIC (normal range is 46 cm (18 in.) to 56 cm (22 in.))
#data_birthlength2 <- data2[, c("birthlength2_in_cm", "i4_birthlength_in2.comb","i4_birthlength_cm2.comb", "i1_dob1.comb", #"bl1a_delive.4mo_date", "p3i_preterm.comb", "p3ii_ba.4modob.comb","p1_situation.comb", "birthlength_in_cm", #"i4_birthlength_in1.comb","i4_birthlength_cm1.comb")]
#data_birthlength2 <- data_birthlength2[order(data_birthlength2$birthlength2_in_cm),]  
#library("xtable")
#print(xtable(data_birthlength2), type = "html", file="CheckDataRealistic/data_birthlength2.html")
#write.csv(data_birthlength2,'CheckDataRealistic/data_birthlength2.csv')



### i5_events2 and all info that follows about infant health events

data2$i5_events2.comb <- mapply(paste, data2$i5_events2, data2$i5_events2.2mo, data2$i5_events2.4mo, sep="/")

describeFactors(data2$i5_events2.comb)
data2$i5_events2.comb <- gsub("/NA","",data2$i5_events2.comb)
data2$i5_events2.comb <- gsub("NA/","",data2$i5_events2.comb)
describeFactors(data2$i5_events2.comb)

data2$i5_events.comb____2 <- factor(data2$i5_events2.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$i5_events.comb____2)

data2$i5_events_jaundice2.comb <- mapply(paste, data2$i5_events_jaundice2, data2$i5_events_jaundice2.2mo, data2$i5_events_jaundice2.4mo, sep="/")

describeFactors(data2$i5_events_jaundice2.comb)
data2$i5_events_jaundice2.comb <- gsub("/NA","",data2$i5_events_jaundice2.comb)
data2$i5_events_jaundice2.comb <- gsub("NA/","",data2$i5_events_jaundice2.comb)
describeFactors(data2$i5_events_jaundice2.comb)

data2$i5_events_jaundice.comb____2 <- factor(data2$i5_events_jaundice2.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$i5_events_jaundice.comb____2)


data2$i5_events_photo2.comb <- mapply(paste, data2$i5_events_photo2, data2$i5_events_photo2.2mo, data2$i5_events_photo2.4mo, sep="/")

describeFactors(data2$i5_events_photo2.comb)
data2$i5_events_photo2.comb <- gsub("/NA","",data2$i5_events_photo2.comb)
data2$i5_events_photo2.comb <- gsub("NA/","",data2$i5_events_photo2.comb)
describeFactors(data2$i5_events_photo2.comb)

data2$i5_events_photo.comb____2 <- factor(data2$i5_events_photo2.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$i5_events_photo.comb____2)


data2$i5_events_seizures2.comb <- mapply(paste, data2$i5_events_seizures2, data2$i5_events_seizures2.2mo, data2$i5_events_seizures2.4mo, sep="/")

describeFactors(data2$i5_events_seizures2.comb)
data2$i5_events_seizures2.comb <- gsub("/NA","",data2$i5_events_seizures2.comb)
data2$i5_events_seizures2.comb <- gsub("NA/","",data2$i5_events_seizures2.comb)
describeFactors(data2$i5_events_seizures2.comb)

data2$i5_events_seizures.comb____2 <- factor(data2$i5_events_seizures2.comb, levels = c(0,999), labels = c("No", "Unknown"))
describeFactors(data2$i5_events_seizures.comb____2)


data2$i5_events_.4mopog.4mo2.comb <- mapply(paste, data2$i5_events_.4mopog.4mo2, data2$i5_events_.4mopog.4mo2.2mo, data2$i5_events_.4mopog.4mo2.4mo, sep="/") #i5_events_hypogly2

describeFactors(data2$i5_events_.4mopog.4mo2.comb)
data2$i5_events_.4mopog.4mo2.comb <- gsub("/NA","",data2$i5_events_.4mopog.4mo2.comb)
data2$i5_events_.4mopog.4mo2.comb <- gsub("NA/","",data2$i5_events_.4mopog.4mo2.comb)
describeFactors(data2$i5_events_.4mopog.4mo2.comb)

data2$i5_events_.4mopog.4mo.comb____2 <- factor(data2$i5_events_.4mopog.4mo2.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$i5_events_.4mopog.4mo.comb____2)


data2$i5_events_fever2.comb <- mapply(paste, data2$i5_events_fever2, data2$i5_events_fever2.2mo, data2$i5_events_fever2.4mo, sep="/") 

describeFactors(data2$i5_events_fever2.comb)
data2$i5_events_fever2.comb <- gsub("/NA","",data2$i5_events_fever2.comb)
data2$i5_events_fever2.comb <- gsub("NA/","",data2$i5_events_fever2.comb)
describeFactors(data2$i5_events_fever2.comb)

data2$i5_events_fever.comb____2 <- factor(data2$i5_events_fever2.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$i5_events_fever.comb____2)



data2$i5_events_vent2.comb <- mapply(paste, data2$i5_events_vent2, data2$i5_events_vent2.2mo, data2$i5_events_vent2.4mo, sep="/") 

describeFactors(data2$i5_events_vent2.comb)
data2$i5_events_vent2.comb <- gsub("/NA","",data2$i5_events_vent2.comb)
data2$i5_events_vent2.comb <- gsub("NA/","",data2$i5_events_vent2.comb)
describeFactors(data2$i5_events_vent2.comb)

data2$i5_events_vent.comb____2 <- factor(data2$i5_events_vent2.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$i5_events_vent.comb____2)



data2$i5_events_other2.comb <- mapply(paste, data2$i5_events_other2, data2$i5_events_other2.2mo, data2$i5_events_other2.4mo, sep="/") 

describeFactors(data2$i5_events_other2.comb)
data2$i5_events_other2.comb <- gsub("/NA","",data2$i5_events_other2.comb)
data2$i5_events_other2.comb <- gsub("NA/","",data2$i5_events_other2.comb)
describeFactors(data2$i5_events_other2.comb)

data2$i5_events_other.comb____2 <- factor(data2$i5_events_other2.comb, levels = c(0,1,999), labels = c("No", "Yes","Unknown"))
describeFactors(data2$i5_events_other.comb____2)


describeFactors(data2$i5_events_other_info2)


### If there is a third infant, same.

# i3_birthweight3 combined with i3_birthweight_lb3 and i3_birthweight_g3 – please combine to just display all in grams; categories should be <2500 g, 2500-4000 g, >4000 g

data2$i3_birthweight_lb3  #NULL
data2$i3_birthweight_lb3.2mo  #NULL
data2$i3_birthweight_lb3.4mo  #NULL

data2$i3_birthweight_g3.2mo  #NULL
data2$i3_birthweight_g3.4mo #NULL

describeFactors(data2$i3_birthweight_g3)
data2$birthweight_in_g____3 <- as.numeric(data2$i3_birthweight_g3)

### i4_birthlength2 – ibid, combine with the two variables below it to just display all in cm

data2$i4_birthlength_in3  #NULL
data2$i4_birthlength_in3.2mo  #NULL
data2$i4_birthlength_in3.4mo  #NULL

data2$i4_birthlength_cm3.2mo  #NULL
data2$i4_birthlength_cm3.4mo  #NULL

describeFactors(data2$i4_birthlength_cm3)
data2$birthlength_in_cm____3 <- as.numeric(data2$i4_birthlength_cm3)

### i5_events3 and all info that follows about infant health events

data2$i5_events3.2mo  #NULL
data2$i5_events3.4mo  #NULL

describeFactors(data2$i5_events3)
data2$i5_events.comb____3 <- factor(data2$i5_events3, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$i5_events.comb____3)

data2$i5_events_jaundice3.2mo  #NULL
data2$i5_events_jaundice3.4mo  #NULL

describeFactors(data2$i5_events_jaundice3)
data2$i5_events_jaundice.comb____3 <- factor(data2$i5_events_jaundice3, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$i5_events_jaundice.comb____3)

data2$i5_events_photo3  #NULL
data2$i5_events_photo3.2mo  #NULL
data2$i5_events_photo3.4mo  #NULL

data2$i5_events_seizures3.2mo  #NULL
data2$i5_events_seizures3.4mo  #NULL

describeFactors(data2$i5_events_seizures3)
data2$i5_events_seizures.comb____3 <- factor(data2$i5_events_seizures3, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$i5_events_seizures.comb____3)

data2$i5_events_.4mopog.4mo3.2mo  #NULL
data2$i5_events_.4mopog.4mo3.4mo  #NULL

describeFactors(data2$i5_events_.4mopog.4mo3)
data2$i5_events_.4mopog.4mo.comb____3 <- factor(data2$i5_events_.4mopog.4mo3, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$i5_events_.4mopog.4mo.comb____3)

data2$i5_events_fever3.2mo   #NULL
data2$i5_events_fever3.4mo  #NULL

describeFactors(data2$i5_events_fever3)
data2$i5_events_fever.comb____3 <- factor(data2$i5_events_fever3, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$i5_events_fever.comb____3)

data2$i5_events_vent3.2mo  #NULL
data2$i5_events_vent3.4mo  #NULL

describeFactors(data2$i5_events_vent3)
data2$i5_events_vent.comb____3 <- factor(data2$i5_events_vent3, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$i5_events_vent.comb____3)

data2$i5_events_other3.2mo  #NULL
data2$i5_events_other3.4mo  #NULL

describeFactors(data2$i5_events_other3)
data2$i5_events_other.comb____3 <- factor(data2$i5_events_other3, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$i5_events_other.comb____3)


describeFactors(data2$i5_events_other_info3)
```

```{r info NICU admission}

### All data under section header "INFORMATION from a special care nursery/ NICU admission” for all infants.

data2$n1_nicu1.comb <- mapply(paste, data2$n1_nicu1, data2$n1_nicu1.2mo, data2$n1_nicu1.4mo, sep="/")

describeFactors(data2$n1_nicu1.comb)
data2$n1_nicu1.comb <- gsub("/NA","",data2$n1_nicu1.comb)
data2$n1_nicu1.comb <- gsub("NA/","",data2$n1_nicu1.comb)
describeFactors(data2$n1_nicu1.comb)

data2$n1_nicu.comb____1 <- factor(data2$n1_nicu1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$n1_nicu.comb____1)


data2$n2_admission1.comb <- mapply(paste, data2$n2_admission1, data2$n2_admission1.2mo, data2$n2_admission1.4mo, sep="/") 

describeFactors(data2$n2_admission1.comb)
data2$n2_admission1.comb <- gsub("/NA","",data2$n2_admission1.comb)
data2$n2_admission1.comb <- gsub("NA/","",data2$n2_admission1.comb)
describeFactors(data2$n2_admission1.comb)

data2$n3_dicharge1.comb <- mapply(paste, data2$n3_dicharge1, data2$n3_dicharge1.2mo, data2$n3_dicharge1.4mo, sep="/") 

describeFactors(data2$n3_dicharge1.comb)
data2$n3_dicharge1.comb <- gsub("/NA","",data2$n3_dicharge1.comb)
data2$n3_dicharge1.comb <- gsub("NA/","",data2$n3_dicharge1.comb)
describeFactors(data2$n3_dicharge1.comb)

#for 1256, 2239, 4625 are admission and discharge date interchanged 
data2$n2_admission1.comb[data2$record_id == "1256"] #"2020-08-30"
data2$n3_dicharge1.comb[data2$record_id == "1256"] #"2020-08-04"
data2$n2_admission1.comb[data2$record_id == "1256"] <- "2020-08-04"
data2$n3_dicharge1.comb[data2$record_id == "1256"] <- "2020-08-30"
data2$n2_admission1.comb[data2$record_id == "2239"] #"2021-11-23"
data2$n3_dicharge1.comb[data2$record_id == "2239"] #"2021-10-23"
data2$n2_admission1.comb[data2$record_id == "2239"] <- "2021-10-23"
data2$n3_dicharge1.comb[data2$record_id == "2239"] <- "2021-11-23"
data2$n2_admission1.comb[data2$record_id == "4625"]  #"2021-08-09"
data2$n3_dicharge1.comb[data2$record_id == "4625"]   #"2021-08-05"
data2$n2_admission1.comb[data2$record_id == "4625"] <- "2021-08-05"
data2$n3_dicharge1.comb[data2$record_id == "4625"] <- "2021-08-09"

data2$time_in_NICU <- difftime(as.Date(data2$n3_dicharge1.comb,"%Y-%m-%d"), as.Date(data2$n2_admission1.comb,"%Y-%m-%d"), units = c("days"))
describeFactors(data2$time_in_NICU)
data2$time_in_NICU____1 <- as.numeric(data2$time_in_NICU)
summary(data2$time_in_NICU____1)

#CHECK IF HUGE NUMBERS COULD BE TRUE
#Huge_NICU_numbers <- data2[(data2$time_in_NICU > 100) & !is.na(data2$time_in_NICU), c("time_in_NICU", "n2_admission1.comb", "n4_diagnoses_info.comb", "n3_dicharge1.comb", "n4_diagnoses1.comb", "p1_situation.comb", "p3i_preterm.comb", "i1_dob1.comb", "bl1a_delive.4mo_date", "bl6_dose1_date","dose1_preg","bl10_dose2_date", "dose2_preg")]
#Huge_NICU_numbers <- Huge_NICU_numbers[order(Huge_NICU_numbers$time_in_NICU),]  
#library("xtable")
#print(xtable(Huge_NICU_numbers), type = "html", file="CheckDataRealistic/Huge_NICU_numbers.html")
#write.csv(Huge_NICU_numbers,'CheckDataRealistic/Huge_NICU_numbers.csv')


#TABLE WITH CORRECTIONS:
#corrected_admission_discharge <- data2[data2$record_id %in% c(1256, 2239, 4625), c("record_id", "n2_admission1.comb", "n3_dicharge1.comb", " *** ", "n2_admission1", "n2_admission1.2mo", "n2_admission1.4mo", "n3_dicharge1", "n3_dicharge1.2mo", "n3_dicharge1.4mo")]
#View(corrected_admission_discharge)

#library("xtable")
#print(xtable(corrected_admission_discharge), type = "html", file="Corrections/corrected_admission_discharge.html")
#write.csv(corrected_admission_discharge,'Corrections/corrected_admission_discharge.csv')




data2$n4_diagnoses1.comb <- mapply(paste, data2$n4_diagnoses1, data2$n4_diagnoses1.2mo, data2$n4_diagnoses1.4mo, sep="/")

describeFactors(data2$n4_diagnoses1.comb)
data2$n4_diagnoses1.comb <- gsub("/NA","",data2$n4_diagnoses1.comb)
data2$n4_diagnoses1.comb <- gsub("NA/","",data2$n4_diagnoses1.comb)
describeFactors(data2$n4_diagnoses1.comb)

data2$n4_diagnoses.comb____1 <- factor(data2$n4_diagnoses1.comb, levels = c(2,1,999), labels = c("No", "Yes", "Unknown"))
describeFactors(data2$n4_diagnoses.comb____1)


data2$n4_diagnoses_info.comb <- mapply(paste, data2$n4_diagnoses_info, data2$n4_diagnoses_info.2mo, data2$n4_diagnoses_info.4mo, sep="/")

describeFactors(data2$n4_diagnoses_info.comb)
data2$n4_diagnoses_info.comb <- gsub("/NA","",data2$n4_diagnoses_info.comb)
data2$n4_diagnoses_info.comb <- gsub("NA/","",data2$n4_diagnoses_info.comb)
describeFactors(data2$n4_diagnoses_info.comb)


#### Infant 2

data2$n1_nicu2.comb <- mapply(paste, data2$n1_nicu2, data2$n1_nicu2.2mo, data2$n1_nicu2.4mo, sep="/")

describeFactors(data2$n1_nicu2.comb)
data2$n1_nicu2.comb <- gsub("/NA","",data2$n1_nicu2.comb)
data2$n1_nicu2.comb <- gsub("NA/","",data2$n1_nicu2.comb)
describeFactors(data2$n1_nicu2.comb)

data2$n1_nicu.comb____2 <- factor(data2$n1_nicu2.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$n1_nicu.comb____2)


data2$n2_admission2.comb <- mapply(paste, data2$n2_admission2, data2$n2_admission2.2mo, data2$n2_admission2.4mo, sep="/") 

describeFactors(data2$n2_admission2.comb)
data2$n2_admission2.comb <- gsub("/NA","",data2$n2_admission2.comb)
data2$n2_admission2.comb <- gsub("NA/","",data2$n2_admission2.comb)
describeFactors(data2$n2_admission2.comb)

data2$n3_dicharge2.comb <- mapply(paste, data2$n3_dicharge2, data2$n3_dicharge2.2mo, data2$n3_dicharge2.4mo, sep="/") 

describeFactors(data2$n3_dicharge2.comb)
data2$n3_dicharge2.comb <- gsub("/NA","",data2$n3_dicharge2.comb)
data2$n3_dicharge2.comb <- gsub("NA/","",data2$n3_dicharge2.comb)
describeFactors(data2$n3_dicharge2.comb)

data2$time_in_NICU2 <- difftime(as.Date(data2$n3_dicharge2.comb,"%Y-%m-%d"), as.Date(data2$n2_admission2.comb,"%Y-%m-%d"), units = c("days"))
describeFactors(data2$time_in_NICU2)
data2$time_in_NICU____2 <- as.numeric(data2$time_in_NICU2)
summary(data2$time_in_NICU____2)

data2$n4_diagnoses2.comb <- mapply(paste, data2$n4_diagnoses2, data2$n4_diagnoses2.2mo, data2$n4_diagnoses2.4mo, sep="/")

describeFactors(data2$n4_diagnoses2.comb)
data2$n4_diagnoses2.comb <- gsub("/NA","",data2$n4_diagnoses2.comb)
data2$n4_diagnoses2.comb <- gsub("NA/","",data2$n4_diagnoses2.comb)
describeFactors(data2$n4_diagnoses2.comb)

data2$n4_diagnoses.comb____2 <- factor(data2$n4_diagnoses2.comb, levels = c(2,1,999), labels = c("No", "Yes", "Unknown"))
describeFactors(data2$n4_diagnoses.comb____2)


data2$n4_diagnoses_info_2.comb <- mapply(paste, data2$n4_diagnoses_info_2.2mo, data2$n4_diagnoses_info_2.4mo, sep="/")

describeFactors(data2$n4_diagnoses_info_2.comb)
data2$n4_diagnoses_info_2.comb <- gsub("/NA","",data2$n4_diagnoses_info_2.comb)
data2$n4_diagnoses_info_2.comb <- gsub("NA/","",data2$n4_diagnoses_info_2.comb)
describeFactors(data2$n4_diagnoses_info_2.comb)

#### Infant 3

describeFactors(data2$n1_nicu3)

data2$n1_nicu.comb____3 <- factor(data2$n1_nicu3, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$n1_nicu.comb____3)


describeFactors(data2$n2_admission3)
describeFactors(data2$n3_dicharge3)

data2$time_in_NICU____3 <- difftime(as.Date(data2$n3_dicharge3,"%Y-%m-%d"), as.Date(data2$n2_admission3,"%Y-%m-%d"), units = c("days"))
describeFactors(data2$time_in_NICU____3)
data2$time_in_NICU____3 <- as.numeric(data2$time_in_NICU____3)
summary(data2$time_in_NICU____3)


describeFactors(data2$n4_diagnoses3)

data2$n4_diagnoses.comb____3 <- factor(data2$n4_diagnoses3, levels = c(2,1), labels = c("No", "Yes"))
describeFactors(data2$n4_diagnoses.comb____3)


```


```{r INFANT COVID-19 TESTING}
### All data under section header "INFANT COVID-19 TESTING” for all infants except you can ignore variable c3_when as the variable doesn’t make sense.

data2$c1_covid1.comb <- mapply(paste, data2$c1_covid1, data2$c1_covid1.2mo, data2$c1_covid1.4mo, sep="/")

describeFactors(data2$c1_covid1.comb)
data2$c1_covid1.comb <- gsub("/NA","",data2$c1_covid1.comb)
data2$c1_covid1.comb <- gsub("NA/","",data2$c1_covid1.comb)
describeFactors(data2$c1_covid1.comb)

data2$c1_covid.comb____1 <- factor(data2$c1_covid1.comb, levels = c(0,1,999), labels = c("No", "Yes", "Unknown"))
describeFactors(data2$c1_covid.comb____1)


data2$c2_result1.comb <- mapply(paste, data2$c2_result1, data2$c2_result1.2mo, data2$c2_result1.4mo, sep="/")

describeFactors(data2$c2_result1.comb)
data2$c2_result1.comb <- gsub("/NA","",data2$c2_result1.comb)
data2$c2_result1.comb <- gsub("NA/","",data2$c2_result1.comb)
describeFactors(data2$c2_result1.comb)

data2$c2_result.comb____1 <- factor(data2$c2_result1.comb, levels = c(0,1), labels = c("Negative (no COVID)", "Positive (COVID)"))
describeFactors(data2$c2_result.comb____1)

#### Infant 2


data2$c1_covid2.comb <- mapply(paste, data2$c1_covid2, data2$c1_covid2.2mo, data2$c1_covid2.4mo, sep="/")

describeFactors(data2$c1_covid2.comb)
data2$c1_covid2.comb <- gsub("/NA","",data2$c1_covid2.comb)
data2$c1_covid2.comb <- gsub("NA/","",data2$c1_covid2.comb)
describeFactors(data2$c1_covid2.comb)

data2$c1_covid.comb____2 <- factor(data2$c1_covid2.comb, levels = c(0,1,999), labels = c("No", "Yes", "Unknown"))
describeFactors(data2$c1_covid.comb____2)


data2$c2_result2.comb <- mapply(paste, data2$c2_result2.2mo, data2$c2_result2.4mo, sep="/")

describeFactors(data2$c2_result2.comb)
data2$c2_result2.comb <- gsub("/NA","",data2$c2_result2.comb)
data2$c2_result2.comb <- gsub("NA/","",data2$c2_result2.comb)
describeFactors(data2$c2_result2.comb)

data2$c2_result.comb____2 <- factor(data2$c2_result2.comb, levels = c(0,1), labels = c("Negative (no COVID)", "Positive (COVID)"))
describeFactors(data2$c2_result.comb____2)

#### Infant 3

describeFactors(data2$c1_covid3)

data2$c1_covid.comb____3 <- factor(data2$c1_covid3, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$c1_covid.comb____3)

describeFactors(data2$c2_result3)

data2$c2_result.comb____3 <- factor(data2$c2_result3, levels = c(0,1), labels = c("Negative (no COVID)", "Positive (COVID)"))
describeFactors(data2$c2_result.comb____3)


```


```{r 6 months infant follow up}

### All data in the module “6-month infant follow up survey” for all infants except not the text fields
data2$io1_height_1  #NULL
describeFactors(data2$io1_height_1.2mo)
describeFactors(data2$io1_height_1.4mo)

describeFactors(data2$io1_height_cm_1)
data2$io1_height_cm_1.2mo  #NULL
data2$io1_height_cm_1.4mo  #NULL

data2$io1_height_cm_1_OLD <- data2$io1_height_cm_1
data2$record_id[data2$io1_height_cm_1_OLD=="170" & !is.na(data2$io1_height_cm_1_OLD)]   #629
data2$record_id[data2$io1_height_cm_1_OLD=="22" & !is.na(data2$io1_height_cm_1_OLD)] #3888
#for record_id 3888, the height 6 months after birth is the same as the birthlengt:
data2$birthlength_in_cm[data2$io1_height_cm_1_OLD=="22"& !is.na(data2$io1_height_cm_1_OLD)]  #"55.88"

data2$io1_height_cm_1[data2$io1_height_cm_1=="170"] <- NA
data2$io1_height_cm_1[data2$io1_height_cm_1=="22"] <- NA


#42-43.3 unclear -> NA
data2$io1_height_cm_1[data2$io1_height_cm_1 >= 42 & data2$io1_height_cm_1 < 52] <- NA
#24.50-27.4 seem to be inches
data2$io1_height_cm_1 <- sapply(as.numeric(data2$io1_height_cm_1),function(x) ifelse(x <= 27.4,x* 2.54,x))

describeFactors(data2$io1_height_cm_1)

describeFactors(data2$io1_height_inches_1)
data2$io1_height_inches_1.2mo  #NULL
data2$io1_height_inches_1.4mo  #NULL

#INCH TO CM: 1 in = 2.54 cm   #63 and 67 are cm and not inches
data2$io1_height_inches_1_to_cm <- sapply(as.numeric(data2$io1_height_inches_1),function(x) ifelse(x < 63,x* 2.54,x))
#view(data2[,c("io1_height_inches_1_to_cm", "io1_height_inches_1")])

data2$io1_height_cminches_1.comb <- mapply(paste, data2$io1_height_inches_1_to_cm, data2$io1_height_cm_1, sep="/")

describeFactors(data2$io1_height_cminches_1.comb)
data2$io1_height_cminches_1.comb <- gsub("/NA","",data2$io1_height_cminches_1.comb)
data2$io1_height_cminches_1.comb <- gsub("NA/","",data2$io1_height_cminches_1.comb)
describeFactors(data2$io1_height_cminches_1.comb)

data2$io1_height_cminches.comb____1 <- as.numeric(data2$io1_height_cminches_1.comb)

#CHECK PLAUSIBILITY
#data_FU_height <- data2[,c("record_id", "io1_height_cminches_1.comb", "io1_height_cm_1","io1_height_inches_1","birthlength_in_cm", "i4_birthlength_in1.comb","i4_birthlength_cm1.comb", "i1_dob1.comb", "bl1a_delive.4mo_date", "p3i_preterm.comb", "p3ii_ba.4modob.comb","p1_situation.comb")] #"birthweight_in_g"
#data_FU_height <- data_FU_height[order(data_FU_height$io1_height_cminches_1.comb),]
#library("xtable")
#print(xtable(data_FU_height), type = "html", file="CheckDataRealistic/data_FU_height.html")
#write.csv(data_FU_height,'CheckDataRealistic/data_FU_height.csv')


#TABLE WITH CORRECTIONS:
#corrected_FU_height <- data2[data2$record_id %in% c(629, 3888), c("record_id", "io1_height_cm_1", " *** ", "io1_height_cm_1_OLD")]
#View(corrected_FU_height)

#library("xtable")
#print(xtable(corrected_FU_height), type = "html", file="Corrections/corrected_FU_height.html")
#write.csv(corrected_FU_height,'Corrections/corrected_FU_height.csv')






data2$io2_weight_kg_1  #NULL
data2$io2_weight_kg_1.comb <- mapply(paste, data2$io2_weight_kg_1.2mo, data2$io2_weight_kg_1.4mo, sep="/")

describeFactors(data2$io2_weight_kg_1.comb)
data2$io2_weight_kg_1.comb <- gsub("/NA","",data2$io2_weight_kg_1.comb)
data2$io2_weight_kg_1.comb <- gsub("NA/","",data2$io2_weight_kg_1.comb)
describeFactors(data2$io2_weight_kg_1.comb)

data2$record_id[data2$io2_weight_kg_1.4mo == 8730 & !is.na(data2$io2_weight_kg_1.4mo)]#111
data2$record_id[data2$io2_weight_kg_1.2mo == 7847 & !is.na(data2$io2_weight_kg_1.2mo)] #3286
data2$record_id[data2$io2_weight_kg_1.2mo == 628 & !is.na(data2$io2_weight_kg_1.2mo)] #2042
data2$record_id[data2$io2_weight_kg_1.2mo == 3410 & !is.na(data2$io2_weight_kg_1.2mo)] #3916
data2$io2_weight_kg_1.comb[data2$io2_weight_kg_1.comb == 8730] <- 8.73
data2$io2_weight_kg_1.comb[data2$io2_weight_kg_1.comb == 7847] <- 7.847
data2$io2_weight_kg_1.comb[data2$io2_weight_kg_1.comb == 628] <- 6.28
data2$io2_weight_kg_1.comb[data2$io2_weight_kg_1.comb == 3410] <- 3.410

#18.5 and 18.6 are lbs instead of kg
data2$io2_weight_kg_1.comb[data2$io2_weight_kg_1.comb == 18.50] <- round(18.50/ 2.2046, 3)
data2$io2_weight_kg_1.comb[data2$io2_weight_kg_1.comb == 18.60] <- round(18.60/ 2.2046, 3)

#The weight 3.41 did not increase compared to birthweight -> set to NA
data2$io2_weight_kg_1.comb_OLD <- data2$io2_weight_kg_1.comb
data2$record_id[data2$io2_weight_kg_1.comb_OLD == 3.41] #3916
data2$io2_weight_kg_1.comb[data2$io2_weight_kg_1.comb == 3.41] <- NA



data2$io2_weight_lbs_1.2mo  #NULL
data2$io2_weight_lbs_1.4mo  #NULL

#LBS to KG: Pound (lbs) / 2.2046 = Result in Kilograms (kg)
describeFactors(data2$io2_weight_lbs_1)
# 6.4 and 7.3 are probably kg and not lbs
data2$io2_weight_lbs_1_to_kg <-  round(sapply(as.numeric(data2$io2_weight_lbs_1),function(x) ifelse(x > 7.3,x/ 2.2046, x)),3)
#view(data2[,c("io2_weight_lbs_1", "io2_weight_lbs_1_to_kg")])

data2$io2_weight_lbskg_1.comb <- mapply(paste, data2$io2_weight_lbs_1_to_kg, data2$io2_weight_kg_1.comb, sep="/")
describeFactors(data2$io2_weight_lbskg_1.comb)
data2$io2_weight_lbskg_1.comb <- gsub("/NA","",data2$io2_weight_lbskg_1.comb)
data2$io2_weight_lbskg_1.comb <- gsub("NA/","",data2$io2_weight_lbskg_1.comb)
describeFactors(data2$io2_weight_lbskg_1.comb)

data2$io2_weight_lbskg.comb____1 <- as.numeric(data2$io2_weight_lbskg_1.comb)

#CHECK PLAUSIBILITY
#data_FU_weight <- data2[,c("record_id", "io2_weight_lbskg_1.comb", "io2_weight_kg_1.comb", "io2_weight_lbs_1", "birthweight_in_g","i3_birthweight_g1.comb", "i3_birthweight_lb1.comb", "i1_dob1.comb", "bl1a_delive.4mo_date", "p3i_preterm.comb", "p3ii_ba.4modob.comb","p1_situation.comb")] #"birthweight_in_g"
#data_FU_weight <- data_FU_weight[order(data_FU_weight$io2_weight_lbskg_1.comb),]
#library("xtable")
#print(xtable(data_FU_weight), type = "html", file="CheckDataRealistic/data_FU_weight.html")
#write.csv(data_FU_weight,'CheckDataRealistic/data_FU_weight.csv')


#TABLE WITH CORRECTIONS:
#corrected_FU_weight <- data2[data2$record_id %in% c(3916), c("record_id", "io2_weight_kg_1.comb", " *** ", "io2_weight_kg_1.2mo", "io2_weight_kg_1.4mo")]
#View(corrected_FU_weight)

#library("xtable")
#print(xtable(corrected_FU_weight), type = "html", file="Corrections/corrected_FU_weight.html")
#write.csv(corrected_FU_weight,'Corrections/corrected_FU_weight.csv')




data2$io3_feed_1 #NULL
data2$io3_feed_1.comb <- mapply(paste, data2$io3_feed_1.2mo   ,data2$io3_feed_1.4mo, sep="/")

describeFactors(data2$io3_feed_1.comb)
data2$io3_feed_1.comb <- gsub("/NA","",data2$io3_feed_1.comb)
data2$io3_feed_1.comb <- gsub("NA/","",data2$io3_feed_1.comb)
describeFactors(data2$io3_feed_1.comb)

data2$io3_feed.comb____1 <- factor(data2$io3_feed_1.comb, levels = c(1,2,3,4,5,6), labels = c("Breastmilk only", "Formula only", "Breastmilk & formula", "Semi-solid foods & breast milk", "Semi-solid foods, breast milk & formula", "Semi-solid foods & formula"))
describeFactors(data2$io3_feed.comb____1)


data2$io4_routinev.2mo_1  #NULL 
data2$io4_routinev.2mo_1.comb <- mapply(paste, data2$io4_routinev.2mo_1.2mo,data2$io4_routinev.2mo_1.4mo, sep="/")

describeFactors(data2$io4_routinev.2mo_1.comb)
data2$io4_routinev.2mo_1.comb <- gsub("/NA","",data2$io4_routinev.2mo_1.comb)
data2$io4_routinev.2mo_1.comb <- gsub("NA/","",data2$io4_routinev.2mo_1.comb)
describeFactors(data2$io4_routinev.2mo_1.comb)

data2$io4_routinev.2mo.comb____1 <- factor(data2$io4_routinev.2mo_1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io4_routinev.2mo.comb____1)





describeFactors(mapply(paste, data2$io5_wellchild_1___1, data2$io5_wellchild_1___1.2mo,data2$io5_wellchild_1___1.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_1___1.comb = case_when(
    apply(data2[,c("io5_wellchild_1___1", "io5_wellchild_1___1.2mo","io5_wellchild_1___1.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_1___1) & is.na(data2$io5_wellchild_1___1.2mo) & is.na(data2$io5_wellchild_1___1.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_1___1.comb)
data2$io5_wellchild___1.comb____1 <- factor(data2$io5_wellchild_1___1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___1.comb____1)


describeFactors(mapply(paste, data2$io5_wellchild_1___2, data2$io5_wellchild_1___2.2mo,data2$io5_wellchild_1___2.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_1___2.comb = case_when(
    apply(data2[,c("io5_wellchild_1___2", "io5_wellchild_1___2.2mo","io5_wellchild_1___2.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_1___2) & is.na(data2$io5_wellchild_1___2.2mo) & is.na(data2$io5_wellchild_1___2.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_1___2.comb)
data2$io5_wellchild___2.comb____1 <- factor(data2$io5_wellchild_1___2.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___2.comb____1)


describeFactors(mapply(paste, data2$io5_wellchild_1___3, data2$io5_wellchild_1___3.2mo,data2$io5_wellchild_1___3.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_1___3.comb = case_when(
    apply(data2[,c("io5_wellchild_1___3", "io5_wellchild_1___3.2mo","io5_wellchild_1___3.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_1___3) & is.na(data2$io5_wellchild_1___3.2mo) & is.na(data2$io5_wellchild_1___3.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_1___3.comb)
data2$io5_wellchild___3.comb____1 <- factor(data2$io5_wellchild_1___3.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___3.comb____1)


describeFactors(mapply(paste, data2$io5_wellchild_1___4, data2$io5_wellchild_1___4.2mo,data2$io5_wellchild_1___4.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_1___4.comb = case_when(
    apply(data2[,c("io5_wellchild_1___4", "io5_wellchild_1___4.2mo","io5_wellchild_1___4.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_1___4) & is.na(data2$io5_wellchild_1___4.2mo) & is.na(data2$io5_wellchild_1___4.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_1___4.comb)
data2$io5_wellchild___4.comb____1 <- factor(data2$io5_wellchild_1___4.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___4.comb____1)


describeFactors(mapply(paste, data2$io5_wellchild_1___5, data2$io5_wellchild_1___5.2mo,data2$io5_wellchild_1___5.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_1___5.comb = case_when(
    apply(data2[,c("io5_wellchild_1___5", "io5_wellchild_1___5.2mo","io5_wellchild_1___5.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_1___5) & is.na(data2$io5_wellchild_1___5.2mo) & is.na(data2$io5_wellchild_1___5.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_1___5.comb)
data2$io5_wellchild___5.comb____1 <- factor(data2$io5_wellchild_1___5.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___5.comb____1)


describeFactors(mapply(paste, data2$io5_wellchild_1___998, data2$io5_wellchild_1___998.2mo,data2$io5_wellchild_1___998.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_1___998.comb = case_when(
    apply(data2[,c("io5_wellchild_1___998", "io5_wellchild_1___998.2mo","io5_wellchild_1___998.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_1___998) & is.na(data2$io5_wellchild_1___998.2mo) & is.na(data2$io5_wellchild_1___998.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_1___998.comb)
data2$io5_wellchild___998.comb____1 <- factor(data2$io5_wellchild_1___998.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___998.comb____1)


describeFactors(mapply(paste, data2$io5_wellchild_1___997, data2$io5_wellchild_1___997.2mo,data2$io5_wellchild_1___997.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_1___997.comb = case_when(
    apply(data2[,c("io5_wellchild_1___997", "io5_wellchild_1___997.2mo","io5_wellchild_1___997.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_1___997) & is.na(data2$io5_wellchild_1___997.2mo) & is.na(data2$io5_wellchild_1___997.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_1___997.comb)
data2$io5_wellchild___997.comb____1 <- factor(data2$io5_wellchild_1___997.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___997.comb____1)

describeFactors(mapply(paste, data2$io5_wellchild_1___999, data2$io5_wellchild_1___999.2mo,data2$io5_wellchild_1___999.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_1___999.comb = case_when(
    apply(data2[,c("io5_wellchild_1___999", "io5_wellchild_1___999.2mo","io5_wellchild_1___999.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_1___999) & is.na(data2$io5_wellchild_1___999.2mo) & is.na(data2$io5_wellchild_1___999.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_1___999.comb)
data2$io5_wellchild___999.comb____1 <- factor(data2$io5_wellchild_1___999.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___999.comb____1)

describeFactors(mapply(paste, data2$io5_wellchild_1___0, data2$io5_wellchild_1___0.2mo,data2$io5_wellchild_1___0.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_1___0.comb = case_when(
    apply(data2[,c("io5_wellchild_1___0", "io5_wellchild_1___0.2mo","io5_wellchild_1___0.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_1___0) & is.na(data2$io5_wellchild_1___0.2mo) & is.na(data2$io5_wellchild_1___0.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))

describeFactors(data2$io5_wellchild_1___0.comb)
data2$io5_wellchild___0.comb____1 <- factor(data2$io5_wellchild_1___0.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___0.comb____1)



data2$io6_hosp_1  #NULL 
data2$io6_hosp_1.comb <- mapply(paste, data2$io6_hosp_1.2mo,data2$io6_hosp_1.4mo, sep="/")

describeFactors(data2$io6_hosp_1.comb)
data2$io6_hosp_1.comb <- gsub("/NA","",data2$io6_hosp_1.comb)
data2$io6_hosp_1.comb <- gsub("NA/","",data2$io6_hosp_1.comb)
describeFactors(data2$io6_hosp_1.comb)

data2$io6_hosp.comb____1 <- factor(data2$io6_hosp_1.comb, levels = c(0,1,997), labels = c("No", "Yes", "Prefer not to answer"))
describeFactors(data2$io6_hosp.comb____1)


data2$io8_er_1  #NULL 
data2$io8_er_1.comb <- mapply(paste, data2$io8_er_1.2mo, data2$io8_er_1.4mo, sep="/")

describeFactors(data2$io8_er_1.comb)
data2$io8_er_1.comb <- gsub("/NA","",data2$io8_er_1.comb)
data2$io8_er_1.comb <- gsub("NA/","",data2$io8_er_1.comb)
describeFactors(data2$io8_er_1.comb)

data2$io8_er.comb____1 <- factor(data2$io8_er_1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io8_er.comb____1)


data2$io10_diag_1  #NULL 
data2$io10_diag_1.comb <- mapply(paste, data2$io10_diag_1.2mo, data2$io10_diag_1.4mo, sep="/")

describeFactors(data2$io10_diag_1.comb)
data2$io10_diag_1.comb <- gsub("/NA","",data2$io10_diag_1.comb)
data2$io10_diag_1.comb <- gsub("NA/","",data2$io10_diag_1.comb)
describeFactors(data2$io10_diag_1.comb)

data2$io10_diag.comb____1 <- factor(data2$io10_diag_1.comb, levels = c(0,1,997), labels = c("No", "Yes", "Prefer not to answer"))
describeFactors(data2$io10_diag.comb____1)


data2$io12_meds_1  #NULL 
data2$io12_meds_1.comb <- mapply(paste, data2$io12_meds_1.2mo, data2$io12_meds_1.4mo, sep="/")

describeFactors(data2$io12_meds_1.comb)
data2$io12_meds_1.comb <- gsub("/NA","",data2$io12_meds_1.comb)
data2$io12_meds_1.comb <- gsub("NA/","",data2$io12_meds_1.comb)
describeFactors(data2$io12_meds_1.comb)

data2$io12_meds.comb____1 <- factor(data2$io12_meds_1.comb, levels = c(0,1,997), labels = c("No", "Yes", "Prefer not to answer"))
describeFactors(data2$io12_meds.comb____1)


data2$io14_squeals_1  #NULL 
data2$io14_squeals_1.comb <- mapply(paste, data2$io14_squeals_1.2mo, data2$io14_squeals_1.4mo, sep="/")

describeFactors(data2$io14_squeals_1.comb)
data2$io14_squeals_1.comb <- gsub("/NA","",data2$io14_squeals_1.comb)
data2$io14_squeals_1.comb <- gsub("NA/","",data2$io14_squeals_1.comb)
describeFactors(data2$io14_squeals_1.comb)

data2$io14_squeals.comb____1 <- factor(data2$io14_squeals_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io14_squeals.comb____1)

data2$io15_deep_1  #NULL 
data2$io15_deep_1.comb <- mapply(paste, data2$io15_deep_1.2mo, data2$io15_deep_1.4mo, sep="/")

describeFactors(data2$io15_deep_1.comb)
data2$io15_deep_1.comb <- gsub("/NA","",data2$io15_deep_1.comb)
data2$io15_deep_1.comb <- gsub("NA/","",data2$io15_deep_1.comb)
describeFactors(data2$io15_deep_1.comb)

data2$io15_deep.comb____1 <- factor(data2$io15_deep_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io15_deep.comb____1)


data2$io16_look_1  #NULL 
data2$io16_look_1.comb <- mapply(paste, data2$io16_look_1.2mo, data2$io16_look_1.4mo, sep="/")

describeFactors(data2$io16_look_1.comb)
data2$io16_look_1.comb <- gsub("/NA","",data2$io16_look_1.comb)
data2$io16_look_1.comb <- gsub("NA/","",data2$io16_look_1.comb)
describeFactors(data2$io16_look_1.comb)

data2$io16_look.comb____1 <- factor(data2$io16_look_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io16_look.comb____1)

data2$io17_loud_1  #NULL 
data2$io17_loud_1.comb <- mapply(paste, data2$io17_loud_1.2mo, data2$io17_loud_1.4mo, sep="/")

describeFactors(data2$io17_loud_1.comb)
data2$io17_loud_1.comb <- gsub("/NA","",data2$io17_loud_1.comb)
data2$io17_loud_1.comb <- gsub("NA/","",data2$io17_loud_1.comb)
describeFactors(data2$io17_loud_1.comb)

data2$io17_loud.comb____1 <- factor(data2$io17_loud_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io17_loud.comb____1)

data2$io18_asounds_1  #NULL 
data2$io18_asounds_1.comb <- mapply(paste, data2$io18_asounds_1.2mo, data2$io18_asounds_1.4mo, sep="/")

describeFactors(data2$io18_asounds_1.comb)
data2$io18_asounds_1.comb <- gsub("/NA","",data2$io18_asounds_1.comb)
data2$io18_asounds_1.comb <- gsub("NA/","",data2$io18_asounds_1.comb)
describeFactors(data2$io18_asounds_1.comb)

data2$io18_asounds.comb____1 <- factor(data2$io18_asounds_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io18_asounds.comb____1)

data2$io19_repeat_1  #NULL 
data2$io19_repeat_1.comb <- mapply(paste, data2$io19_repeat_1.2mo, data2$io19_repeat_1.4mo, sep="/")

describeFactors(data2$io19_repeat_1.comb)
data2$io19_repeat_1.comb <- gsub("/NA","",data2$io19_repeat_1.comb)
data2$io19_repeat_1.comb <- gsub("NA/","",data2$io19_repeat_1.comb)
describeFactors(data2$io19_repeat_1.comb)

data2$io19_repeat.comb____1 <- factor(data2$io19_repeat_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io19_repeat.comb____1)

data2$io20_liftlegs_1  #NULL 
data2$io20_liftlegs_1.comb <- mapply(paste, data2$io20_liftlegs_1.2mo, data2$io20_liftlegs_1.4mo, sep="/")

describeFactors(data2$io20_liftlegs_1.comb)
data2$io20_liftlegs_1.comb <- gsub("/NA","",data2$io20_liftlegs_1.comb)
data2$io20_liftlegs_1.comb <- gsub("NA/","",data2$io20_liftlegs_1.comb)
describeFactors(data2$io20_liftlegs_1.comb)

data2$io20_liftlegs.comb____1 <- factor(data2$io20_liftlegs_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io20_liftlegs.comb____1)


data2$io21_straightenarms_1  #NULL 
data2$io21_straightenarms_1.comb <- mapply(paste, data2$io21_straightenarms_1.2mo, data2$io21_straightenarms_1.4mo, sep="/")

describeFactors(data2$io21_straightenarms_1.comb)
data2$io21_straightenarms_1.comb <- gsub("/NA","",data2$io21_straightenarms_1.comb)
data2$io21_straightenarms_1.comb <- gsub("NA/","",data2$io21_straightenarms_1.comb)
describeFactors(data2$io21_straightenarms_1.comb)

data2$io21_straightenarms.comb____1 <- factor(data2$io21_straightenarms_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io21_straightenarms.comb____1)


data2$io22_roll_1  #NULL 
data2$io22_roll_1.comb <- mapply(paste, data2$io22_roll_1.2mo, data2$io22_roll_1.4mo, sep="/")

describeFactors(data2$io22_roll_1.comb)
data2$io22_roll_1.comb <- gsub("/NA","",data2$io22_roll_1.comb)
data2$io22_roll_1.comb <- gsub("NA/","",data2$io22_roll_1.comb)
describeFactors(data2$io22_roll_1.comb)

data2$io22_roll.comb____1 <- factor(data2$io22_roll_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io22_roll.comb____1)

data2$io23_lean_1  #NULL 
data2$io23_lean_1.comb <- mapply(paste, data2$io23_lean_1.2mo, data2$io23_lean_1.4mo, sep="/")

describeFactors(data2$io23_lean_1.comb)
data2$io23_lean_1.comb <- gsub("/NA","",data2$io23_lean_1.comb)
data2$io23_lean_1.comb <- gsub("NA/","",data2$io23_lean_1.comb)
describeFactors(data2$io23_lean_1.comb)

data2$io23_lean.comb____1 <- factor(data2$io23_lean_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io23_lean.comb____1)


data2$io24_supportweight_1  #NULL 
data2$io24_supportweight_1.comb <- mapply(paste, data2$io24_supportweight_1.2mo, data2$io24_supportweight_1.4mo, sep="/")

describeFactors(data2$io24_supportweight_1.comb)
data2$io24_supportweight_1.comb <- gsub("/NA","",data2$io24_supportweight_1.comb)
data2$io24_supportweight_1.comb <- gsub("NA/","",data2$io24_supportweight_1.comb)
describeFactors(data2$io24_supportweight_1.comb)

data2$io24_supportweight.comb____1 <- factor(data2$io24_supportweight_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io24_supportweight.comb____1)


data2$io25_crawling_1  #NULL 
data2$io25_crawling_1.comb <- mapply(paste, data2$io25_crawling_1.2mo, data2$io25_crawling_1.4mo, sep="/")

describeFactors(data2$io25_crawling_1.comb)
data2$io25_crawling_1.comb <- gsub("/NA","",data2$io25_crawling_1.comb)
data2$io25_crawling_1.comb <- gsub("NA/","",data2$io25_crawling_1.comb)
describeFactors(data2$io25_crawling_1.comb)

data2$io25_crawling.comb____1 <- factor(data2$io25_crawling_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io25_crawling.comb____1)


data2$io26_grab_1  #NULL 
data2$io26_grab_1.comb <- mapply(paste, data2$io26_grab_1.2mo, data2$io26_grab_1.4mo, sep="/")

describeFactors(data2$io26_grab_1.comb)
data2$io26_grab_1.comb <- gsub("/NA","",data2$io26_grab_1.comb)
data2$io26_grab_1.comb <- gsub("NA/","",data2$io26_grab_1.comb)
describeFactors(data2$io26_grab_1.comb)

data2$io26_grab.comb____1 <- factor(data2$io26_grab_1.comb, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io26_grab.comb____1)

data2$io27_bothhands_1  #NULL 
data2$io27_bothhands_1.comb <- mapply(paste, data2$io27_bothhands_1.2mo, data2$io27_bothhands_1.4mo, sep="/")

describeFactors(data2$io27_bothhands_1.comb)
data2$io27_bothhands_1.comb <- gsub("/NA","",data2$io27_bothhands_1.comb)
data2$io27_bothhands_1.comb <- gsub("NA/","",data2$io27_bothhands_1.comb)
describeFactors(data2$io27_bothhands_1.comb)

data2$io27_bothhands.comb____1 <- factor(data2$io27_bothhands_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io27_bothhands.comb____1)

data2$io28_touchcrumb_1  #NULL 
data2$io28_touchcrumb_1.comb <- mapply(paste, data2$io28_touchcrumb_1.2mo, data2$io28_touchcrumb_1.4mo, sep="/")

describeFactors(data2$io28_touchcrumb_1.comb)
data2$io28_touchcrumb_1.comb <- gsub("/NA","",data2$io28_touchcrumb_1.comb)
data2$io28_touchcrumb_1.comb <- gsub("NA/","",data2$io28_touchcrumb_1.comb)
describeFactors(data2$io28_touchcrumb_1.comb)

data2$io28_touchcrumb.comb____1 <- factor(data2$io28_touchcrumb_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io28_touchcrumb.comb____1)

data2$io29_smallt.4mo_1  #NULL 
data2$io29_smallt.4mo_1.comb <- mapply(paste, data2$io29_smallt.4mo_1.2mo, data2$io29_smallt.4mo_1.4mo, sep="/")

describeFactors(data2$io29_smallt.4mo_1.comb)
data2$io29_smallt.4mo_1.comb <- gsub("/NA","",data2$io29_smallt.4mo_1.comb)
data2$io29_smallt.4mo_1.comb <- gsub("NA/","",data2$io29_smallt.4mo_1.comb)
describeFactors(data2$io29_smallt.4mo_1.comb)

data2$io29_smallt.4mo.comb____1 <- factor(data2$io29_smallt.4mo_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io29_smallt.4mo.comb____1)

data2$io30_rakingcrumb_1  #NULL 
data2$io30_rakingcrumb_1.comb <- mapply(paste, data2$io30_rakingcrumb_1.2mo, data2$io30_rakingcrumb_1.4mo, sep="/")

describeFactors(data2$io30_rakingcrumb_1.comb)
data2$io30_rakingcrumb_1.comb <- gsub("/NA","",data2$io30_rakingcrumb_1.comb)
data2$io30_rakingcrumb_1.comb <- gsub("NA/","",data2$io30_rakingcrumb_1.comb)
describeFactors(data2$io30_rakingcrumb_1.comb)

data2$io30_rakingcrumb.comb____1 <- factor(data2$io30_rakingcrumb_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io30_rakingcrumb.comb____1)

data2$io31_onehand_1  #NULL 
data2$io31_onehand_1.comb <- mapply(paste, data2$io31_onehand_1.2mo, data2$io31_onehand_1.4mo, sep="/")

describeFactors(data2$io31_onehand_1.comb)
data2$io31_onehand_1.comb <- gsub("/NA","",data2$io31_onehand_1.comb)
data2$io31_onehand_1.comb <- gsub("NA/","",data2$io31_onehand_1.comb)
describeFactors(data2$io31_onehand_1.comb)

data2$io31_onehand.comb____1 <- factor(data2$io31_onehand_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io31_onehand.comb____1)

data2$io32_reach_1  #NULL 
data2$io32_reach_1.comb <- mapply(paste, data2$io32_reach_1.2mo, data2$io32_reach_1.4mo, sep="/")

describeFactors(data2$io32_reach_1.comb)
data2$io32_reach_1.comb <- gsub("/NA","",data2$io32_reach_1.comb)
data2$io32_reach_1.comb <- gsub("NA/","",data2$io32_reach_1.comb)
describeFactors(data2$io32_reach_1.comb)

data2$io32_reach.comb____1 <- factor(data2$io32_reach_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io32_reach.comb____1)

data2$io33_turnhead_1  #NULL 
data2$io33_turnhead_1.comb <- mapply(paste, data2$io33_turnhead_1.2mo, data2$io33_turnhead_1.4mo, sep="/")

describeFactors(data2$io33_turnhead_1.comb)
data2$io33_turnhead_1.comb <- gsub("/NA","",data2$io33_turnhead_1.comb)
data2$io33_turnhead_1.comb <- gsub("NA/","",data2$io33_turnhead_1.comb)
describeFactors(data2$io33_turnhead_1.comb)

data2$io33_turnhead.comb____1 <- factor(data2$io33_turnhead_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io33_turnhead.comb____1)


data2$io34_dropped_1  #NULL 
data2$io34_dropped_1.comb <- mapply(paste, data2$io34_dropped_1.2mo, data2$io34_dropped_1.4mo, sep="/")

describeFactors(data2$io34_dropped_1.comb)
data2$io34_dropped_1.comb <- gsub("/NA","",data2$io34_dropped_1.comb)
data2$io34_dropped_1.comb <- gsub("NA/","",data2$io34_dropped_1.comb)
describeFactors(data2$io34_dropped_1.comb)

data2$io34_dropped.comb____1 <- factor(data2$io34_dropped_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io34_dropped.comb____1)

data2$io35_mouth_1  #NULL 
data2$io35_mouth_1.comb <- mapply(paste, data2$io35_mouth_1.2mo, data2$io35_mouth_1.4mo, sep="/")

describeFactors(data2$io35_mouth_1.comb)
data2$io35_mouth_1.comb <- gsub("/NA","",data2$io35_mouth_1.comb)
data2$io35_mouth_1.comb <- gsub("NA/","",data2$io35_mouth_1.comb)
describeFactors(data2$io35_mouth_1.comb)

data2$io35_mouth.comb____1 <- factor(data2$io35_mouth_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io35_mouth.comb____1)


data2$io36_pass_1  #NULL 
data2$io36_pass_1.comb <- mapply(paste, data2$io36_pass_1.2mo, data2$io36_pass_1.4mo, sep="/")

describeFactors(data2$io36_pass_1.comb)
data2$io36_pass_1.comb <- gsub("/NA","",data2$io36_pass_1.comb)
data2$io36_pass_1.comb <- gsub("NA/","",data2$io36_pass_1.comb)
describeFactors(data2$io36_pass_1.comb)

data2$io36_pass.comb____1 <- factor(data2$io36_pass_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io36_pass.comb____1)


data2$io37_bang_1  #NULL 
data2$io37_bang_1.comb <- mapply(paste, data2$io37_bang_1.2mo, data2$io37_bang_1.4mo, sep="/")

describeFactors(data2$io37_bang_1.comb)
data2$io37_bang_1.comb <- gsub("/NA","",data2$io37_bang_1.comb)
data2$io37_bang_1.comb <- gsub("NA/","",data2$io37_bang_1.comb)
describeFactors(data2$io37_bang_1.comb)

data2$io37_bang.comb____1 <- factor(data2$io37_bang_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io37_bang.comb____1)


data2$io38_coomirror_1  #NULL 
data2$io38_coomirror_1.comb <- mapply(paste, data2$io38_coomirror_1.2mo, data2$io38_coomirror_1.4mo, sep="/")

describeFactors(data2$io38_coomirror_1.comb)
data2$io38_coomirror_1.comb <- gsub("/NA","",data2$io38_coomirror_1.comb)
data2$io38_coomirror_1.comb <- gsub("NA/","",data2$io38_coomirror_1.comb)
describeFactors(data2$io38_coomirror_1.comb)

data2$io38_coomirror.comb____1 <- factor(data2$io38_coomirror_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io38_coomirror.comb____1)


data2$io39_strangers_1  #NULL 
data2$io39_strangers_1.comb <- mapply(paste, data2$io39_strangers_1.2mo, data2$io39_strangers_1.4mo, sep="/")

describeFactors(data2$io39_strangers_1.comb)
data2$io39_strangers_1.comb <- gsub("/NA","",data2$io39_strangers_1.comb)
data2$io39_strangers_1.comb <- gsub("NA/","",data2$io39_strangers_1.comb)
describeFactors(data2$io39_strangers_1.comb)

data2$io39_strangers.comb____1 <- factor(data2$io39_strangers_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io39_strangers.comb____1)

data2$io40_footgrab_1  #NULL 
data2$io40_footgrab_1.comb <- mapply(paste, data2$io40_footgrab_1.2mo, data2$io40_footgrab_1.4mo, sep="/")

describeFactors(data2$io40_footgrab_1.comb)
data2$io40_footgrab_1.comb <- gsub("/NA","",data2$io40_footgrab_1.comb)
data2$io40_footgrab_1.comb <- gsub("NA/","",data2$io40_footgrab_1.comb)
describeFactors(data2$io40_footgrab_1.comb)

data2$io40_footgrab.comb____1 <- factor(data2$io40_footgrab_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io40_footgrab.comb____1)

data2$io41_patmirror_1  #NULL 
data2$io41_patmirror_1.comb <- mapply(paste, data2$io41_patmirror_1.2mo, data2$io41_patmirror_1.4mo, sep="/")

describeFactors(data2$io41_patmirror_1.comb)
data2$io41_patmirror_1.comb <- gsub("/NA","",data2$io41_patmirror_1.comb)
data2$io41_patmirror_1.comb <- gsub("NA/","",data2$io41_patmirror_1.comb)
describeFactors(data2$io41_patmirror_1.comb)

data2$io41_patmirror.comb____1 <- factor(data2$io41_patmirror_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io41_patmirror.comb____1)

data2$io42_footmouth_1  #NULL 
data2$io42_footmouth_1.comb <- mapply(paste, data2$io42_footmouth_1.2mo, data2$io42_footmouth_1.4mo, sep="/")

describeFactors(data2$io42_footmouth_1.comb)
data2$io42_footmouth_1.comb <- gsub("/NA","",data2$io42_footmouth_1.comb)
data2$io42_footmouth_1.comb <- gsub("NA/","",data2$io42_footmouth_1.comb)
describeFactors(data2$io42_footmouth_1.comb)

data2$io42_footmouth.comb____1 <- factor(data2$io42_footmouth_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io42_footmouth.comb____1)


data2$io43_reacht.4mo_1  #NULL #io443_reachtoy
data2$io43_reacht.4mo_1.comb <- mapply(paste, data2$io43_reacht.4mo_1.2mo, data2$io43_reacht.4mo_1.4mo, sep="/")

describeFactors(data2$io43_reacht.4mo_1.comb)
data2$io43_reacht.4mo_1.comb <- gsub("/NA","",data2$io43_reacht.4mo_1.comb)
data2$io43_reacht.4mo_1.comb <- gsub("NA/","",data2$io43_reacht.4mo_1.comb)
describeFactors(data2$io43_reacht.4mo_1.comb)

data2$io43_reacht.4mo.comb____1 <- factor(data2$io43_reacht.4mo_1.comb, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io43_reacht.4mo.comb____1)


data2$io44_hearswell_1.2mo  #NULL 
data2$io44_hearswell_1.4mo  #NULL
describeFactors(data2$io44_hearswell_1)

data2$io44_hearswell____1 <- factor(data2$io44_hearswell_1, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io44_hearswell____1)


data2$io44_handslegs_1  #NULL
data2$io44_handslegs_1.comb <- mapply(paste, data2$io44_handslegs_1.2mo, data2$io44_handslegs_1.4mo, sep="/")

describeFactors(data2$io44_handslegs_1.comb)
data2$io44_handslegs_1.comb <- gsub("/NA","",data2$io44_handslegs_1.comb)
data2$io44_handslegs_1.comb <- gsub("NA/","",data2$io44_handslegs_1.comb)
describeFactors(data2$io44_handslegs_1.comb)

data2$io44_handslegs.comb____1 <- factor(data2$io44_handslegs_1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io44_handslegs.comb____1)

data2$io45_bothhands_1.2mo  #NULL
data2$io45_bothhands_1.4mo  #NULL
describeFactors(data2$io45_bothhands_1)
data2$io45_bothhands____1 <- factor(data2$io45_bothhands_1, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io45_bothhands____1)

data2$io45_feetflat_1  #NULL
data2$io45_feetflat_1.comb <- mapply(paste, data2$io45_feetflat_1.2mo, data2$io45_feetflat_1.4mo, sep="/")

describeFactors(data2$io45_feetflat_1.comb)
data2$io45_feetflat_1.comb <- gsub("/NA","",data2$io45_feetflat_1.comb)
data2$io45_feetflat_1.comb <- gsub("NA/","",data2$io45_feetflat_1.comb)
describeFactors(data2$io45_feetflat_1.comb)

data2$io45_feetflat.comb____1 <- factor(data2$io45_feetflat_1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io45_feetflat.comb____1)

data2$io46_feetflat_1.2mo  #NULL
data2$io46_feetflat_1.4mo  #NULL
describeFactors(data2$io46_feetflat_1)

data2$io46_feetflat____1 <- factor(data2$io46_feetflat_1, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io46_feetflat____1)

data2$io46_quiet_1  #NULL
data2$io46_quiet_1.comb <- mapply(paste, data2$io46_quiet_1.2mo, data2$io46_quiet_1.4mo, sep="/")

describeFactors(data2$io46_quiet_1.comb)
data2$io46_quiet_1.comb <- gsub("/NA","",data2$io46_quiet_1.comb)
data2$io46_quiet_1.comb <- gsub("NA/","",data2$io46_quiet_1.comb)
describeFactors(data2$io46_quiet_1.comb)

data2$io46_quiet.comb____1 <- factor(data2$io46_quiet_1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io46_quiet.comb____1)

data2$io47_deafness.2mo_1  #NULL
data2$io47_deafness.2mo_1.comb <- mapply(paste, data2$io47_deafness.2mo_1.2mo, data2$io47_deafness.2mo_1.4mo, sep="/")

describeFactors(data2$io47_deafness.2mo_1.comb)
data2$io47_deafness.2mo_1.comb <- gsub("/NA","",data2$io47_deafness.2mo_1.comb)
data2$io47_deafness.2mo_1.comb <- gsub("NA/","",data2$io47_deafness.2mo_1.comb)
describeFactors(data2$io47_deafness.2mo_1.comb)

data2$io47_deafness.2mo.comb____1 <- factor(data2$io47_deafness.2mo_1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io47_deafness.2mo.comb____1)

data2$io48_vision_1  #NULL
data2$io48_vision_1.comb <- mapply(paste, data2$io48_vision_1.2mo, data2$io48_vision_1.4mo, sep="/")

describeFactors(data2$io48_vision_1.comb)
data2$io48_vision_1.comb <- gsub("/NA","",data2$io48_vision_1.comb)
data2$io48_vision_1.comb <- gsub("NA/","",data2$io48_vision_1.comb)
describeFactors(data2$io48_vision_1.comb)

data2$io48_vision.comb____1 <- factor(data2$io48_vision_1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io48_vision.comb____1)

data2$io49_medproblem_1  #NULL
data2$io49_medproblem_1.comb <- mapply(paste, data2$io49_medproblem_1.2mo, data2$io49_medproblem_1.4mo, sep="/")

describeFactors(data2$io49_medproblem_1.comb)
data2$io49_medproblem_1.comb <- gsub("/NA","",data2$io49_medproblem_1.comb)
data2$io49_medproblem_1.comb <- gsub("NA/","",data2$io49_medproblem_1.comb)
describeFactors(data2$io49_medproblem_1.comb)

data2$io49_medproblem.comb____1 <- factor(data2$io49_medproblem_1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io49_medproblem.comb____1)

data2$io50_wor.4mo_1  #NULL
data2$io50_wor.4mo_1.comb <- mapply(paste, data2$io50_wor.4mo_1.2mo, data2$io50_wor.4mo_1.4mo, sep="/")

describeFactors(data2$io50_wor.4mo_1.comb)
data2$io50_wor.4mo_1.comb <- gsub("/NA","",data2$io50_wor.4mo_1.comb)
data2$io50_wor.4mo_1.comb <- gsub("NA/","",data2$io50_wor.4mo_1.comb)
describeFactors(data2$io50_wor.4mo_1.comb)

data2$io50_wor.4mo.comb____1 <- factor(data2$io50_wor.4mo_1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io50_wor.4mo.comb____1)

data2$io51_concerns_1  #NULL
data2$io51_concerns_1.comb <- mapply(paste, data2$io51_concerns_1.2mo, data2$io51_concerns_1.4mo, sep="/")

describeFactors(data2$io51_concerns_1.comb)
data2$io51_concerns_1.comb <- gsub("/NA","",data2$io51_concerns_1.comb)
data2$io51_concerns_1.comb <- gsub("NA/","",data2$io51_concerns_1.comb)
describeFactors(data2$io51_concerns_1.comb)

data2$io51_concerns.comb____1 <- factor(data2$io51_concerns_1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io51_concerns.comb____1)



describeFactors(mapply(paste,data2$month_infant_follow_up_surv.4mo_infant_1_complete, data2$month_infant_follow_up_surv.4mo_infant_1_complete.2mo, data2$month_infant_follow_up_surv.4mo_infant_1_complete.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(month_infant_follow_up_surv.4mo_infant_1_complete.comb = case_when(
    apply(data2[,c("month_infant_follow_up_surv.4mo_infant_1_complete", "month_infant_follow_up_surv.4mo_infant_1_complete.2mo","month_infant_follow_up_surv.4mo_infant_1_complete.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$month_infant_follow_up_surv.4mo_infant_1_complete) & is.na(data2$month_infant_follow_up_surv.4mo_infant_1_complete.2mo) & is.na(data2$month_infant_follow_up_surv.4mo_infant_1_complete.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$month_infant_follow_up_surv.4mo_infant_1_complete.comb)
data2$month_infant_follow_up_surv.4mo_infant_complete.comb____1 <- factor(data2$month_infant_follow_up_surv.4mo_infant_1_complete.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$month_infant_follow_up_surv.4mo_infant_complete.comb____1)

#################################################################
#### 6-month Infant Follow Up Survey - Infant 2
#################################################################

describeFactors(data2$io1_height_2)  
data2$io1_height_2.2mo  #NULL
data2$io1_height_2.4mo  #NULL

describeFactors(data2$io1_height_cm_2)
data2$io1_height_cm_2.2mo  #NULL
data2$io1_height_cm_2.4mo  #NULL

data2$io1_height_inches_2   #NULL
data2$io1_height_inches_2.2mo  #NULL
data2$io1_height_inches_2.4mo  #NULL

data2$io1_height_cminches.comb____2 <- data2$io1_height_cm_2

data2$io2_weight_kg_2.2mo  #NULL
data2$io2_weight_kg_2.4mo  #NULL
describeFactors(data2$io2_weight_kg_2)


data2$io2_weight_lbs_2.2mo  #NULL
data2$io2_weight_lbs_2.4mo  #NULL

#LBS to KG: Pound (lbs) / 2.2046 = Result in Kilograms (kg)
describeFactors(data2$io2_weight_lbs_2)
data2$io2_weight_lbs_2_to_kg <- round(data2$io2_weight_lbs_2/ 2.2046,3)

data2$io2_weight_lbskg_2.comb <- mapply(paste, data2$io2_weight_lbs_2_to_kg, data2$io2_weight_kg_2, sep="/")
describeFactors(data2$io2_weight_lbskg_2.comb)
data2$io2_weight_lbskg_2.comb <- gsub("/NA","",data2$io2_weight_lbskg_2.comb)
data2$io2_weight_lbskg_2.comb <- gsub("NA/","",data2$io2_weight_lbskg_2.comb)
describeFactors(data2$io2_weight_lbskg_2.comb)

data2$io2_weight_lbskg.comb____2 <- as.numeric(data2$io2_weight_lbskg_2.comb)


data2$io3_feed_2.2mo  #NULL
data2$io3_feed_2.4mo  #NULL
describeFactors(data2$io3_feed_2)

data2$io3_feed.comb____2 <- factor(data2$io3_feed_2, levels = c(1,2,3,4,5,6), labels = c("Breastmilk only", "Formula only", "Breastmilk & formula", "Semi-solid foods & breast milk", "Semi-solid foods, breast milk & formula", "Semi-solid foods & formula"))
describeFactors(data2$io3_feed.comb____2)

data2$io4_routinev.2mo_2.2mo #NULL 
data2$io4_routinev.2mo_2.4mo #NULL 
describeFactors(data2$io4_routinev.2mo_2)
data2$io4_routinev.2mo.comb____2 <- factor(data2$io4_routinev.2mo_2, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io4_routinev.2mo.comb____2)


describeFactors(mapply(paste, data2$io5_wellchild_2___1, data2$io5_wellchild_2___1.2mo,data2$io5_wellchild_2___1.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_2___1.comb = case_when(
    apply(data2[,c("io5_wellchild_2___1", "io5_wellchild_2___1.2mo","io5_wellchild_2___1.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_2___1) & is.na(data2$io5_wellchild_2___1.2mo) & is.na(data2$io5_wellchild_2___1.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_2___1.comb)
data2$io5_wellchild___1.comb____2 <- factor(data2$io5_wellchild_2___1.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___1.comb____2)


describeFactors(mapply(paste, data2$io5_wellchild_2___2, data2$io5_wellchild_2___2.2mo,data2$io5_wellchild_2___2.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_2___2.comb = case_when(
    apply(data2[,c("io5_wellchild_2___2", "io5_wellchild_2___2.2mo","io5_wellchild_2___2.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_2___2) & is.na(data2$io5_wellchild_2___2.2mo) & is.na(data2$io5_wellchild_2___2.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_2___2.comb)
data2$io5_wellchild___2.comb____2 <- factor(data2$io5_wellchild_2___2.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___2.comb____2)


describeFactors(mapply(paste, data2$io5_wellchild_2___3, data2$io5_wellchild_2___3.2mo,data2$io5_wellchild_2___3.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_2___3.comb = case_when(
    apply(data2[,c("io5_wellchild_2___3", "io5_wellchild_2___3.2mo","io5_wellchild_2___3.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_2___3) & is.na(data2$io5_wellchild_2___3.2mo) & is.na(data2$io5_wellchild_2___3.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_2___3.comb)
data2$io5_wellchild___3.comb____2 <- factor(data2$io5_wellchild_2___3.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___3.comb____2)


describeFactors(mapply(paste, data2$io5_wellchild_2___4, data2$io5_wellchild_2___4.2mo,data2$io5_wellchild_2___4.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_2___4.comb = case_when(
    apply(data2[,c("io5_wellchild_2___4", "io5_wellchild_2___4.2mo","io5_wellchild_2___4.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_2___4) & is.na(data2$io5_wellchild_2___4.2mo) & is.na(data2$io5_wellchild_2___4.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_2___4.comb)
data2$io5_wellchild___4.comb____2 <- factor(data2$io5_wellchild_2___4.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___4.comb____2)


describeFactors(mapply(paste, data2$io5_wellchild_2___5, data2$io5_wellchild_2___5.2mo,data2$io5_wellchild_2___5.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_2___5.comb = case_when(
    apply(data2[,c("io5_wellchild_2___5", "io5_wellchild_2___5.2mo","io5_wellchild_2___5.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_2___5) & is.na(data2$io5_wellchild_2___5.2mo) & is.na(data2$io5_wellchild_2___5.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_2___5.comb)
data2$io5_wellchild___5.comb____2 <- factor(data2$io5_wellchild_2___5.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___5.comb____2)


describeFactors(mapply(paste, data2$io5_wellchild_2___998, data2$io5_wellchild_2___998.2mo,data2$io5_wellchild_2___998.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_2___998.comb = case_when(
    apply(data2[,c("io5_wellchild_2___998", "io5_wellchild_2___998.2mo","io5_wellchild_2___998.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_2___998) & is.na(data2$io5_wellchild_2___998.2mo) & is.na(data2$io5_wellchild_2___998.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_2___998.comb)
data2$io5_wellchild___998.comb____2 <- factor(data2$io5_wellchild_2___998.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___998.comb____2)


describeFactors(mapply(paste, data2$io5_wellchild_2___997, data2$io5_wellchild_2___997.2mo,data2$io5_wellchild_2___997.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_2___997.comb = case_when(
    apply(data2[,c("io5_wellchild_2___997", "io5_wellchild_2___997.2mo","io5_wellchild_2___997.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_2___997) & is.na(data2$io5_wellchild_2___997.2mo) & is.na(data2$io5_wellchild_2___997.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_2___997.comb)
data2$io5_wellchild___997.comb____2 <- factor(data2$io5_wellchild_2___997.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___997.comb____2)

describeFactors(mapply(paste, data2$io5_wellchild_2___999, data2$io5_wellchild_2___999.2mo,data2$io5_wellchild_2___999.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_2___999.comb = case_when(
    apply(data2[,c("io5_wellchild_2___999", "io5_wellchild_2___999.2mo","io5_wellchild_2___999.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_2___999) & is.na(data2$io5_wellchild_2___999.2mo) & is.na(data2$io5_wellchild_2___999.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$io5_wellchild_2___999.comb)
data2$io5_wellchild___999.comb____2 <- factor(data2$io5_wellchild_2___999.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___999.comb____2)

describeFactors(mapply(paste, data2$io5_wellchild_2___0, data2$io5_wellchild_2___0.2mo,data2$io5_wellchild_2___0.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(io5_wellchild_2___0.comb = case_when(
    apply(data2[,c("io5_wellchild_2___0", "io5_wellchild_2___0.2mo","io5_wellchild_2___0.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$io5_wellchild_2___0) & is.na(data2$io5_wellchild_2___0.2mo) & is.na(data2$io5_wellchild_2___0.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))

describeFactors(data2$io5_wellchild_2___0.comb)
data2$io5_wellchild___0.comb____2 <- factor(data2$io5_wellchild_2___0.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io5_wellchild___0.comb____2)


data2$io6_hosp_2.2mo    #NULL 
data2$io6_hosp_2.4mo    #NULL 
describeFactors(data2$io6_hosp_2)

data2$io6_hosp.comb____2 <- factor(data2$io6_hosp_2, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io6_hosp.comb____2)

data2$io8_er_2.2mo  #NULL
data2$io8_er_2.4mo  #NULL
describeFactors(data2$io8_er_2)

data2$io8_er.comb____2 <- factor(data2$io8_er_2, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io8_er.comb____2)


data2$io10_diag_2.2mo  #NULL 
data2$io10_diag_2.4mo  #NULL 
describeFactors(data2$io10_diag_2)
data2$io10_diag.comb____2 <- factor(data2$io10_diag_2, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io10_diag.comb____2)

data2$io12_meds_2.2mo #NULL 
data2$io12_meds_2.4mo #NULL 
describeFactors(data2$io12_meds_2)
data2$io12_meds.comb____2 <- factor(data2$io12_meds_2, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io12_meds.comb____2)

data2$io14_squeals_2.2mo #NULL 
data2$io14_squeals_2.4mo #NULL 
describeFactors(data2$io14_squeals_2)
data2$io14_squeals.comb____2 <- factor(data2$io14_squeals_2, levels = c(0,1), labels = c("Not yet", "Yes"))
describeFactors(data2$io14_squeals.comb____2)

data2$io15_deep_2.2mo #NULL
data2$io15_deep_2.4mo #NULL
describeFactors(data2$io15_deep_2)
data2$io15_deep.comb____2 <- factor(data2$io15_deep_2, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io15_deep.comb____2)

data2$io16_look_2.2mo #NULL 
data2$io16_look_2.4mo #NULL 
describeFactors(data2$io16_look_2)
data2$io16_look.comb____2 <- factor(data2$io16_look_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io16_look.comb____2)

data2$io17_loud_2.2mo  #NULL 
data2$io17_loud_2.4mo  #NULL 
describeFactors(data2$io17_loud_2)
data2$io17_loud.comb____2 <- factor(data2$io17_loud_2, levels = c(0,1), labels = c("Not yet", "Yes"))
describeFactors(data2$io17_loud.comb____2)

data2$io18_asounds_2.2mo #NULL 
data2$io18_asounds_2.4mo #NULL 
describeFactors(data2$io18_asounds_2)
data2$io18_asounds.comb____2 <- factor(data2$io18_asounds_2, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io18_asounds.comb____2)

data2$io19_repeat_2.2mo #NULL 
data2$io19_repeat_2.4mo #NULL 
describeFactors(data2$io19_repeat_2)
data2$io19_repeat.comb____2 <- factor(data2$io19_repeat_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io19_repeat.comb____2)

data2$io20_liftlegs_2.2mo #NULL
data2$io20_liftlegs_2.4mo #NULL
describeFactors(data2$io20_liftlegs_2)
data2$io20_liftlegs.comb____2 <- factor(data2$io20_liftlegs_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io20_liftlegs.comb____2)

data2$io21_straightenarms_2.2mo  #NULL 
data2$io21_straightenarms_2.4mo  #NULL 
describeFactors(data2$io21_straightenarms_2)
data2$io21_straightenarms.comb____2 <- factor(data2$io21_straightenarms_2, levels = c(0,1), labels = c("Not yet", "Yes"))
describeFactors(data2$io21_straightenarms.comb____2)

data2$io22_roll_2.2mo #NULL 
data2$io22_roll_2.4mo #NULL 
describeFactors(data2$io22_roll_2)
data2$io22_roll.comb____2 <- factor(data2$io22_roll_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io22_roll.comb____2)

data2$io23_lean_2.2mo #NULL 
data2$io23_lean_2.4mo #NULL 
describeFactors(data2$io23_lean_2)
data2$io23_lean.comb____2 <- factor(data2$io23_lean_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io23_lean.comb____2)

data2$io24_supportweight_2.2mo  #NULL 
data2$io24_supportweight_2.4mo  #NULL 
describeFactors(data2$io24_supportweight_2)
data2$io24_supportweight.comb____2 <- factor(data2$io24_supportweight_2, levels = c(0,1), labels = c("Not yet", "Yes"))
describeFactors(data2$io24_supportweight.comb____2)

data2$io25_crawling_2.2mo  #NULL 
data2$io25_crawling_2.4mo  #NULL 
describeFactors(data2$io25_crawling_2)
data2$io25_crawling.comb____2 <- factor(data2$io25_crawling_2, levels = c(0,2), labels = c("Not yet", "Sometimes"))
describeFactors(data2$io25_crawling.comb____2)

data2$io26_grab_2.2mo   #NULL 
data2$io26_grab_2.4mo   #NULL 
describeFactors(data2$io26_grab_2)
data2$io26_grab.comb____2 <- factor(data2$io26_grab_2, levels = c(0,1), labels = c("Not yet", "Yes"))
describeFactors(data2$io26_grab.comb____2)

data2$io27_bothhands_2.2mo  #NULL 
data2$io27_bothhands_2.4mo  #NULL 
describeFactors(data2$io27_bothhands_2)
data2$io27_bothhands.comb____2 <- factor(data2$io27_bothhands_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io27_bothhands.comb____2)

data2$io28_touchcrumb_2.2mo  #NULL
data2$io28_touchcrumb_2.4mo  #NULL
describeFactors(data2$io28_touchcrumb_2)
data2$io28_touchcrumb.comb____2 <- factor(data2$io28_touchcrumb_2, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io28_touchcrumb.comb____2)

data2$io29_smallt.4mo_2.2mo  #NULL 
data2$io29_smallt.4mo_2.4mo  #NULL 
describeFactors(data2$io29_smallt.4mo_2)
data2$io29_smallt.4mo.comb____2 <- factor(data2$io29_smallt.4mo_2, levels = c(0,1), labels = c("Not yet", "Yes"))
describeFactors(data2$io29_smallt.4mo.comb____2)

data2$io30_rakingcrumb_2.2mo
data2$io30_rakingcrumb_2.4mo
describeFactors(data2$io30_rakingcrumb_2)
data2$io30_rakingcrumb.comb____2 <- factor(data2$io30_rakingcrumb_2, levels = c(0,1), labels = c("Not yet", "Yes"))
describeFactors(data2$io30_rakingcrumb.comb____2)

data2$io31_onehand_2.2mo  #NULL 
data2$io31_onehand_2.4mo  #NULL 
describeFactors(data2$io31_onehand_2)
data2$io31_onehand.comb____2 <- factor(data2$io31_onehand_2, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io31_onehand.comb____2)

data2$io32_reach_2.2mo  #NULL 
data2$io32_reach_2.4mo  #NULL 
describeFactors(data2$io32_reach_2)
data2$io32_reach.comb____2 <- factor(data2$io32_reach_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io32_reach.comb____2)

data2$io33_turnhead_2.2mo  #NULL 
data2$io33_turnhead_2.4mo  #NULL 
describeFactors(data2$io33_turnhead_2)
data2$io33_turnhead.comb____2 <- factor(data2$io33_turnhead_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io33_turnhead.comb____2)

data2$io34_dropped_2.2mo  #NULL
data2$io34_dropped_2.4mo  #NULL
describeFactors(data2$io34_dropped_2)
data2$io34_dropped.comb____2 <- factor(data2$io34_dropped_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io34_dropped.comb____2)

data2$io35_mouth_2.2mo  #NULL
data2$io35_mouth_2.4mo  #NULL
describeFactors(data2$io35_mouth_2)
data2$io35_mouth.comb____2 <- factor(data2$io35_mouth_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io35_mouth.comb____2)

data2$io36_pass_2.2mo  #NULL
data2$io36_pass_2.4mo  #NULL
describeFactors(data2$io36_pass_2)
data2$io36_pass.comb____2 <- factor(data2$io36_pass_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io36_pass.comb____2)

data2$io37_bang_2.2mo  #NULL
data2$io37_bang_2.4mo  #NULL
describeFactors(data2$io37_bang_2)
data2$io37_bang.comb____2 <- factor(data2$io37_bang_2, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io37_bang.comb____2)

data2$io38_coomirror_2.2mo  #NULL
data2$io38_coomirror_2.4mo  #NULL
describeFactors(data2$io38_coomirror_2)
data2$io38_coomirror.comb____2 <- factor(data2$io38_coomirror_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io38_coomirror.comb____2)

data2$io39_strangers_2.2mo  #NULL 
data2$io39_strangers_2.4mo  #NULL 
describeFactors(data2$io39_strangers_2)
data2$io39_strangers.comb____2 <- factor(data2$io39_strangers_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io39_strangers.comb____2)

data2$io40_footgrab_2.2mo  #NULL
data2$io40_footgrab_2.4mo  #NULL
describeFactors(data2$io40_footgrab_2)
data2$io40_footgrab.comb____2 <- factor(data2$io40_footgrab_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io40_footgrab.comb____2)

data2$io41_patmirror_2.2mo  #NULL
data2$io41_patmirror_2.4mo  #NULL
describeFactors(data2$io41_patmirror_2)
data2$io41_patmirror.comb____2 <- factor(data2$io41_patmirror_2, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io41_patmirror.comb____2)

data2$io42_footmouth_2.2mo  #NULL
data2$io42_footmouth_2.4mo  #NULL
describeFactors(data2$io42_footmouth_2)
data2$io42_footmouth.comb____2 <- factor(data2$io42_footmouth_2, levels = c(0,1,2), labels = c("Not yet", "Yes", "Sometimes"))
describeFactors(data2$io42_footmouth.comb____2)

data2$io43_reacht.4mo_2.2mo  #NULL
data2$io43_reacht.4mo_2.4mo  #NULL
describeFactors(data2$io43_reacht.4mo_2)
data2$io43_reacht.4mo.comb____2 <- factor(data2$io43_reacht.4mo_2, levels = c(1,2), labels = c("Yes", "Sometimes"))
describeFactors(data2$io43_reacht.4mo.comb____2)

data2$io44_hearswell_2.2mo  #NULL 
data2$io44_hearswell_2.4mo  #NULL
data2$io44_hearswell_2 #NULL

data2$io44_handslegs_2.2mo  #NULL
data2$io44_handslegs_2.4mo  #NULL
describeFactors(data2$io44_handslegs_2)
data2$io44_handslegs.comb____2 <- factor(data2$io44_handslegs_2, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io44_handslegs.comb____2)

data2$io45_bothhands_2.2mo  #NULL
data2$io45_bothhands_2.4mo  #NULL
data2$io45_bothhands_2  #NULL

data2$io45_feetflat_2.2mo  #NULL
data2$io45_feetflat_2.4mo  #NULL
describeFactors(data2$io45_feetflat_2)
data2$io45_feetflat.comb____2 <- factor(data2$io45_feetflat_2, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io45_feetflat.comb____2)

data2$io46_feetflat_2.2mo  #NULL
data2$io46_feetflat_2.4mo  #NULL
data2$io46_feetflat_2  #NULL

data2$io46_quiet_2.2mo  #NULL
data2$io46_quiet_2.4mo  #NULL
describeFactors(data2$io46_quiet_2)
data2$io46_quiet.comb____2 <- factor(data2$io46_quiet_2, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io46_quiet.comb____2)

data2$io47_deafness.2mo_2.2mo  #NULL
data2$io47_deafness.2mo_2.4mo  #NULL
describeFactors(data2$io47_deafness.2mo_2)
data2$io47_deafness.2mo.comb____2 <- factor(data2$io47_deafness.2mo_2, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io47_deafness.2mo.comb____2)

data2$io48_vision_2.2mo  #NULL
data2$io48_vision_2.4mo  #NULL
describeFactors(data2$io48_vision_2)
data2$io48_vision.comb____2 <- factor(data2$io48_vision_2, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io48_vision.comb____2)

data2$io49_medproblem_2.2mo  #NULL
data2$io49_medproblem_2.4mo  #NULL
describeFactors(data2$io49_medproblem_2)
data2$io49_medproblem.comb____2 <- factor(data2$io49_medproblem_2, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io49_medproblem.comb____2)

data2$io50_wor.4mo_2.2mo  #NULL
data2$io50_wor.4mo_2.4mo  #NULL
describeFactors(data2$io50_wor.4mo_2)
data2$io50_wor.4mo.comb____2 <- factor(data2$io50_wor.4mo_2, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io50_wor.4mo.comb____2)

data2$io51_concerns_2.2mo  #NULL
data2$io51_concerns_2.4mo  #NULL
describeFactors(data2$io51_concerns_2)
data2$io51_concerns.comb____2 <- factor(data2$io51_concerns_2, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$io51_concerns.comb____2)



describeFactors(mapply(paste,data2$month_infant_follow_up_surv.4mo_infant_2_complete, data2$month_infant_follow_up_surv.4mo_infant_2_complete.2mo, data2$month_infant_follow_up_surv.4mo_infant_2_complete.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(month_infant_follow_up_surv.4mo_infant_2_complete.comb = case_when(
    apply(data2[,c("month_infant_follow_up_surv.4mo_infant_2_complete", "month_infant_follow_up_surv.4mo_infant_2_complete.2mo","month_infant_follow_up_surv.4mo_infant_2_complete.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$month_infant_follow_up_surv.4mo_infant_2_complete) & is.na(data2$month_infant_follow_up_surv.4mo_infant_2_complete.2mo) & is.na(data2$month_infant_follow_up_surv.4mo_infant_2_complete.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$month_infant_follow_up_surv.4mo_infant_2_complete.comb)
data2$month_infant_follow_up_surv.4mo_infant_complete.comb____2 <- factor(data2$month_infant_follow_up_surv.4mo_infant_2_complete.comb, levels = c(0,1), labels = c("No", "Yes"))
describeFactors(data2$month_infant_follow_up_surv.4mo_infant_complete.comb____2)


#################################################################
#### 6-month Infant Follow Up Survey - Infant 3
#################################################################

describeFactors(mapply(paste,data2$month_infant_follow_up_surv.4mo_infant_3_complete, data2$month_infant_follow_up_surv.4mo_infant_3_complete.2mo, data2$month_infant_follow_up_surv.4mo_infant_3_complete.4mo, sep="/"))

data2 <- data2 %>% 
  mutate(month_infant_follow_up_surv.4mo_infant_complete.comb____3 = case_when(
    apply(data2[,c("month_infant_follow_up_surv.4mo_infant_3_complete", "month_infant_follow_up_surv.4mo_infant_3_complete.2mo","month_infant_follow_up_surv.4mo_infant_3_complete.4mo")], 1, any) == "TRUE" ~ "1",
    is.na(data2$month_infant_follow_up_surv.4mo_infant_3_complete) & is.na(data2$month_infant_follow_up_surv.4mo_infant_3_complete.2mo) & is.na(data2$month_infant_follow_up_surv.4mo_infant_3_complete.4mo) == "TRUE" ~ "NA",
    TRUE ~ "0"
  ))
describeFactors(data2$month_infant_follow_up_surv.4mo_infant_complete.comb____3)


```

```{r exclusion criteria}

describeFactors(data2$dose1_preg)
#Before pregnancy        "444 (8.8%)"   
#During pregnancy        "2,858 (56.3%)"
#No vaccine NOT pregnant "50 (1.0%)"    
#No vaccine pregnant     "90 (1.8%)"    
#post-partum             "1,623 (32.0%)"
#Missing                 "7 (0.1%)"   


describeFactors(data2$dose2_preg)
#Before pregnancy             "125 (2.5%)"   
#During pregnancy             "2,266 (44.7%)"
#No D2                        "569 (11.2%)"  
#No vaccine NOT pregnant      "50 (1.0%)"    
#No vaccine pregnant          "90 (1.8%)"    
#post-partum/post-miscarriage "1,961 (38.7%)"
#Missing                      "11 (0.2%)"    

describeFactors(data2$dose1_BF)
#BF                      "3,516 (69.3%)"
#No vaccine NOT pregnant "50 (1.0%)"    
#No vaccine pregnant     "90 (1.8%)"    
#Not BF                  "1,409 (27.8%)"
#Missing                 "7 (0.1%)"     

describeFactors(data2$dose1_T)
#D1 before preg/BF       "178 (3.5%)"   
#D1 before preg/Not BF   "259 (5.1%)"   
#D1 during preg/BF       "1,728 (34.1%)"
#D1 during preg/Not BF   "1,137 (22.4%)"
#D1 post-partum/BF       "1,610 (31.7%)"
#D1 post-partum/Not BF   "13 (0.3%)"    
#No vaccine NOT pregnant "50 (1.0%)"    
#No vaccine pregnant     "90 (1.8%)"    
#Missing                 "7 (0.1%)"    


#TWO GROUPS TO COMPARE AGAINST: women who were vaccinated during pregnancy vs women who were not vaccinated during pregnancy (either no vaccination or vaccine during lactation; they must have answered yes to bl3_after_march as we only want pandemic era pregnancies). 

#View(data2[is.na(data2$dose1_preg) | is.na(data2$dose2_preg),c("record_id", "dose1_preg","dose2_preg")])

data2 <- data2 %>% 
  mutate(
    vacc_during_preg = case_when(
      data2$dose1_preg == "During pregnancy" | data2$dose2_preg == "During pregnancy" ~ "At least 1 dose during pregnancy",
      is.na(data2$dose1_preg) & is.na(data2$dose2_preg) ~ "NA",
      is.na(data2$dose1_preg) & data2$dose2_preg == "No D2" ~ "NA",
      TRUE ~ "No vaccination during pregnancy"
    )
  )
describeFactors(data2$vacc_during_preg)
data2$vacc_during_preg <- factor(data2$vacc_during_preg, levels = c("At least 1 dose during pregnancy", "No vaccination during pregnancy"))
describeFactors(data2$vacc_during_preg)


### EXCLUSION CRITERIA 

### 1. Exclude those not living in Canada (also exclude missing cases)
describeFactors(data2$bl16_count.4mo_res)
data2$bl16_count.4mo_res <- factor(data2$bl16_count.4mo_res, levels = c(1,2,4,998), labels = c("Canada", "Mexico", "United States of America", "Other"))
describeFactors(data2$bl16_count.4mo_res)

nrow(data2) #5072
data3 <- data2[data2$bl16_count.4mo_res == "Canada" & !is.na(data2$bl16_count.4mo_res),]
nrow(data3)  #5011

### 2. We only want to include women who have completed pregnancy
#View(data3[data3$dose1_preg == "No vaccine NOT pregnant",])
#Not pregnant only means, currently not pregnant... Most of those people have a child. 

#birthdate of baby
describeFactors(data3$i1_dob1.comb)
#NA         "1,693 (33.8%)"
sum(!data3$i1_dob1.comb=="NA") #3322


#describeFactors(data3$i1_dob1 == data3$i1_dob2)
#describeFactors(data3$i1_dob1.2mo == data3$i1_dob2.2mo)
#describeFactors(data3$i1_dob1.4mo == data3$i1_dob2.4mo)
#describeFactors(data3$i1_dob1.2mo == data3$i1_dob3)

#describeFactors(data3$p3ii_ba.4modob.2mo) #only preterm birth #included in the i1_dob1 variable
#Missing    "4,924 (97.0%)"
#sum(!is.na(data3$p3ii_ba.4modob.2mo))  #152


describeFactors(data3$bl1_currently_preg)
#0 "2,590 (51.7%)"
#1 "2,421 (48.3%)"

#Are you still pregnant
describeFactors(data3$fu1_pregnant.2mo)
#0       "2,894 (57.8%)"
#1       "1,282 (25.6%)"
#Missing "835 (16.7%)" 

describeFactors(data3$fu1_pregnant.4mo)
#0       "2,368 (47.3%)"
#1       "447 (8.9%)"   
#Missing "2,196 (43.8%)"

#exclude those who are still pregnant after 4 months. 
nrow(data3) #5011
data4 <- data3[!data3$fu1_pregnant.4mo == "1" | is.na(data3$fu1_pregnant.4mo),]
nrow(data4)  #4564



### 3. Exclude women who had COVID during pregnancy as we know this impacts pregnancy outcomes?
#bl34_covid_preg1  #Did you test positive during your current/most recent pregnancy?
#I guess we should just keep women with other conditions in pregnancy that can affect outcomes and make sure the rates are similar between those vaccinated vs not (e.g. Pre-eclampsia, GD, etc)
#6 month infant data will only be available for a subset of those with completed pregnancies and that’s fine. 

#Did you test positive during your current/most recent pregnancy?
describeFactors(data4$bl34_covid_preg1)
#0       "38 (0.8%)"    
#1       "57 (1.2%)"    
#Missing "4,469 (97.9%)"

data5 <- data4[!data4$bl34_covid_preg1 == "1" | is.na(data4$bl34_covid_preg1),]
nrow(data5)  #4507

### Covid infection since last survey? Was this Covid infection during pregnancy?
describeFactors(data5$fu4_covid_pos.2mo)
#0       "3,677 (81.6%)"
#1       "7 (0.2%)"     
#Missing "823 (18.3%)"  

data5$fu1_pregnant.2mo[data5$fu4_covid_pos.2mo == 1 & !is.na(data5$fu4_covid_pos.2mo)]  #0 0 1 0 1 0 0
data5$fu6_covid_date.2mo[data5$fu4_covid_pos.2mo == 1 & !is.na(data5$fu4_covid_pos.2mo)]  # "2021-09-05" "2021-08-31" "2021-09-10" "2021-08-25" "2021-08-23" "2021-10-05" "2021-10-23"
data5$i1_dob1[data5$fu4_covid_pos.2mo == 1 & !is.na(data5$fu4_covid_pos.2mo)]  # NA NA NA NA NA NA NA
data5$bl1a_delive.4mo_date[data5$fu4_covid_pos.2mo == 1 & !is.na(data5$fu4_covid_pos.2mo)]  #NA NA "2022-02-16" NA "2022-01-20" "2021-09-19" "2021-10-28"

data_Covid_during_preg_1 <- data5[data5$fu4_covid_pos.2mo == 1 & !is.na(data5$fu4_covid_pos.2mo), c("record_id","fu4_covid_pos.2mo","fu1_pregnant.2mo", "fu6_covid_date.2mo", "i1_dob1","bl1a_delive.4mo_date")]  #0 0 1 0 1 0 0
#View(data_Covid_during_preg_1)


data6 <- data5[!data5$fu4_covid_pos.2mo == "1" | is.na(data5$fu4_covid_pos.2mo),]
nrow(data6)  #4500

describeFactors(data6$fu4_covid_pos.4mo)
#0       "2,317 (51.5%)"
#1       "11 (0.2%)"    
#Missing "2,172 (48.3%)"

#data6[data6$fu4_covid_pos.4mo == 1 & !is.na(data6$fu4_covid_pos.4mo), c("record_id","fu4_covid_pos.4mo","fu1_pregnant.4mo", "fu6_covid_date.4mo", "i1_dob1","bl1a_delive.4mo_date")]  #0 0 1 0 1 0 0
data6$record_id[data6$fu4_covid_pos.4mo == 1 & !is.na(data6$fu4_covid_pos.4mo)]  #Covid infection before birth date or unknown:  587  1181 1336 1852 2290 2371 2379 2736 4080 # Covid infection after birth:  788  919

data_Covid_during_preg_2 <- data6[data6$record_id %in% c(587, 1181, 1336, 1852, 2290, 2371, 2379, 2736, 4080), c("record_id","fu4_covid_pos.4mo","fu1_pregnant.4mo", "fu6_covid_date.4mo", "i1_dob1","bl1a_delive.4mo_date")]
#View(data_Covid_during_preg_2)

data7 <- data6[!data6$record_id %in% c(587, 1181, 1336, 1852, 2290, 2371, 2379, 2736, 4080),] 
nrow(data7)  #4491


```




```{r preprocess table}
nrow(data7)#4491
data8 <- data7[!is.na(data7$vacc_during_preg),]
nrow(data8) #4489
```

```{r specification}
#describeFactors(data8$bl24_neuro_other)
data8$bl24_neuro_other <- factor(data8$bl24_neuro_other, levels = c(
  "A.D.D",
  "Acquired brain injury, seizure disorder", 
  "ADHD",
  #"Cerebral aneurysm",
  #"Chiari malformation, syringomyelia ",
  "Chronic Daily Migraine",
  "chronic migraine",
  "Chronic migraine",
  "Chronic migraine ",
  "Chronic Migraines",
  "Congenital Hydrocephalus ",
  "Epilepsy ",
  "Epilepsy",
  "Epilepsy  ",
  #"Generalized Epilepsy",
  "Intracranial hypertension ",
  "Isolated clinical syndrome of multiple sclerosis",
  "local seizure",
  "migraine",
  "Migraine",
  "Migraine ",
  "Migraines",
  "Migraines ",
  "Migraines with aura",
  "moya moya and chronic migraines ",
  "MS",
  "Multiple sclerosis",
  "Multiple Sclerosis ",
  "Multiple sclerosis ",
  "Multiple Sclerosis",
  "Narcolepsy",
  "Narcolepsy + cataplexy ",
  #"Occipital Neuralgia ",
  #"Pituitary tumour ",
  "Post concussive syndrome ",
  "RLS, Raynaud's",
  "S1-3 Neuropathy",
  "Severe migraines ",
  "Spinal predominant multiple sclerosis (recurrent transverse myelitis)",
  "Temporal lobe epilepsy ",
  "TIA",
  "Tourettes",
  "Trigeminal Neuralgia"
), labels = c(
  "A.D.D",
  "Acquired brain injury, seizure disorder", 
  "ADHD",
  #"Cerebral aneurysm",
  #"Chiari malformation, syringomyelia ",
  "Chronic Daily Migraine",
  "Chronic migraine",
  "Chronic migraine",
  "Chronic migraine",
  "Chronic migraine",
  "Congenital Hydrocephalus ",
  "Epilepsy",
  "Epilepsy",
  "Epilepsy",
  #"Generalized Epilepsy",
  "Intracranial hypertension ",
  "Isolated clinical syndrome of multiple sclerosis",
  "local seizure",
  "Migraine",
  "Migraine",
  "Migraine",
  "Migraine",
  "Migraine",
  "Migraines with aura",
  "moya moya and chronic migraines ",
  "Multiple sclerosis",
  "Multiple sclerosis",
  "Multiple sclerosis",
  "Multiple sclerosis",
  "Multiple sclerosis",
  "Narcolepsy",
  "Narcolepsy + cataplexy ",
  #"Occipital Neuralgia ",
  #"Pituitary tumour ",
  "Post concussive syndrome ",
  "RLS, Raynaud's",
  "S1-3 Neuropathy",
  "Severe migraines ",
  "Spinal predominant multiple sclerosis (recurrent transverse myelitis)",
  "Temporal lobe epilepsy ",
  "TIA",
  "Tourettes",
  "Trigeminal Neuralgia"
))
#describeFactors(data8$bl24_neuro_other)

#describeFactors(data8$bl24_autoimmune_other)
data8$bl24_autoimmune_other <- factor(data8$bl24_autoimmune_other, levels = c(
  " Thyroiditis ",
  #"Allergies",
  "allergies and eczema",
  "Alopecia ",
  "alopecia areata",
  "Ankylosing spondylitis",
  "Ankylosing Spondylitis",
  "Arthritis ",
  "atopic dermatitis",
  "Autoimmune hepatitis",
  "Autoimmune progesterone dermatitis",
  "B12 deficiency",
  "Basedow/Graves",
  #"Bechets syndrome",
  "celiac",
  "Celiac",
  "Celiac ",
  "Celiac (undiagnosed but following the diet) ",
  "celiac and endometriosis",
  "celiac disease",
  "Celiac disease",
  "Celiac Disease",
  "Celiac disease ",
  "Celiac disease, hypothyroidism",
  "Celiac; Urticaria Vasculitis",
  "Celiacs Disease",
  "Celiacs disease ",
  "Chronic fatigue and endorcine system but have not had significant symptoms in several years",
  "Chronic idiopathic urticaria",
  #"Chronic spontaneous urticaria",
  #"Chronic urticaria",
  #"Chronic urticaria ",
  "CIU",
  "Colitis",
  "colitis ",
  "Connective tissue disease",
  "Crohn's",
  "Crohn's ",
  "Crohn's and Hashimotos",
  "Crohn's disease",
  "Crohn's Disease",
  "Crohn's disease ",
  "Crohn's Disease ",
  "Crohns ",
  "Crohns and ankylosing spondilitis",
  "Crohns disease",
  "Crohns Disease",
  "Crohns Disease ",
  "Discoid lupus",
  "Dysautonomia",
  "eczema",
  "Eczema",
  "Eczema ",
  "Endometriosis, celiac disease",
  "Eosinophilic esophagitis",
  "Eosinophilic Esophagitis",
  "Eosonophilic esophagitis ",
  "Fibromyalgia",
  "Fibromyalgia; Myalgic Encephalitis",
  "Grave's",
  "Grave's hyperthyroidism",
  "Graves",
  "Graves ",
  "Graves disease",
  "Graves Disease",
  "Graves Disease ",
  #"Guttate Psoriasis",
  "Hashimoto",
  "Hashimoto's",
  "Hashimoto's Disease",
  "Hashimoto's thyroiditis",
  "Hashimoto's Thyroiditis",
  "Hashimoto's thyroiditis ",
  "Hashimoto disease",
  "Hashimoto thyroiditis",
  "hashimotos",
  "Hashimotos",
  "Hashimotos ",
  "Hashimotos Diesease",
  "Hashimotos Hypothyroidism",
  "Hashimotos Thiroiditis",
  "Hashimotos Thyroiditis",
  "Hashimotos, fibromyalgia ",
  "Henoch-Schonlein purpura, Lupus",
  "Hidradenitis suppuritiva",
  "Hidradentitis suppurativa",
  "Hydredenitis suppurativa",
  "Hypogammaglobulinemia",
  "Hypothyroidism (Hashimoto's)",
  "I believe MS is an autoimmune disorder ",
  "Idiopathic Angio Edema",
  "IGA immune deficiency",
  "Immune thrombocytopenic purpura",
  "Inflammatory arthritis",
  "Inflammatory arthritis ",
  "Inflammatory Bowel Disease",
  "Interstitial Cystitis",
  "Iritis, JRA",
  "Irritible bowel syndrome ",
  "ITP",
  "Juvenile arthritis",
  "Kidney disease ",
  "Lichen planopolaris ",
  "Lichen sclerosis and Graves' disease (see response for thyroid disease)",
  "Lichen sclerosis, Interstitial cystitis",
  "Lichen Sclerosus",
  "Lupus",
  "Lupus (LE)",
  #"Mast Cell Activation Syndrome",
  "Mixed connective tissue disorder ",
  "Multiple sclerosis",
  "Multiple Sclerosis",
  "Multiple sclerosis ",
  "Myesthenia Gravis",
  "Narcolepsy + cataplexy ",
  "Plaque psoriasis",
  "Psioriasis",
  "Psorasis",
  "psoriasis",
  "Psoriasis",
  "Psoriasis ",
  "Psoriasis and psoriatic arthritis",
  "Psoriasis, Ankylosing Spondylitis",
  "Psoriatic arthritis",
  "Psoriatic Arthritis",
  "RA",
  #"RA and hashimotos",
  "Raynauds",
  "Raynauds ",
  "Reactive arthritis ",
  "REHUMATOID ARTHRITIS",
  "Rheumatoid arthritis",
  "Rheumatoid Arthritis",
  "Rheumatoid arthritis ",
  "Rheumatoid Arthritis ",
  #"Ro anitbodies characteristic of Lupus & Sjogrens, intermittent symptoms, not yet diagnosed with specific disorder",
  "Sjodren's",
  "Sjogrens",
  "Sjogrens syndrome ",
  "Spinal Stenosis ",
  "Systemic Lupus Erythematosus ",
  "Type 1 diabetes",
  "Type 1 Diabetes",
  "ulcerative colitis",
  "Ulcerative colitis",
  "Ulcerative Colitis",
  "Ulcerative colitis ",
  "Ulcerative colitis and psoriasis ",
  "ulcerative colitis, alopecia areata  ",
  "Ulcerative Colitis, Psoriasis",
  "Ulcerative Proctitis",
  "Ulcerative Proctitisis",
  "Unclear. History with rheumatic fever, arthritis and mystery inflammatory conditions ",
  #"Uveitis",
  "Vitiligo",
  "Vitiligo ",
  "Vitilligo",
  "Working with Rheumatologist to get a diagnosis pre pregnancy "
), labels = c(
  "Thyroiditis",
  #"Allergies",
  "allergies and eczema",
  "Alopecia ",
  "Alopecia areata",
  "Ankylosing spondylitis",
  "Ankylosing spondylitis",
  "Arthritis ",
  "Atopic dermatitis",
  "Autoimmune hepatitis",
  "Autoimmune progesterone dermatitis",
  "B12 deficiency",
  "Basedow/Graves",
  #"Bechets syndrome",
  "Celiac disease",
  "Celiac disease",
  "Celiac disease",
  "Celiac (undiagnosed but following the diet)",
  "Celiac and endometriosis",
  "Celiac disease",
  "Celiac disease",
  "Celiac disease",
  "Celiac disease",
  "Celiac disease, hypothyroidism",
  "Celiac; Urticaria Vasculitis",
  "Celiac disease",
  "Celiac disease",
  "Chronic fatigue and endorcine system but have not had significant symptoms in several years",
  "Chronic idiopathic urticaria",
  #"Chronic spontaneous urticaria",
  #"Chronic urticaria",
  #"Chronic urticaria ",
  "Chronic idiopathic urticaria",
  "Colitis",
  "Colitis ",
  "Connective tissue disease",
  "Crohn's disease",
  "Crohn's disease",
  "Crohn's and Hashimotos",
  "Crohn's disease",
  "Crohn's disease",
  "Crohn's disease",
  "Crohn's disease",
  "Crohn's disease",
  "Crohns and ankylosing spondilitis",
  "Crohn's disease",
  "Crohn's disease",
  "Crohn's disease",
  "Discoid lupus",
  "Dysautonomia",
  "Eczema",
  "Eczema",
  "Eczema",
  "Endometriosis, celiac disease",
  "Eosinophilic esophagitis",
  "Eosinophilic esophagitis",
  "Eosonophilic esophagitis",
  "Fibromyalgia",
  "Fibromyalgia; Myalgic Encephalitis",
  "Grave's disease",
  "Grave's hyperthyroidism",
  "Grave's disease",
  "Grave's disease",
  "Grave's disease",
  "Grave's disease",
  "Grave's disease ",
  #"Guttate Psoriasis",
  "Hashimoto's disease",
  "Hashimoto's disease",
  "Hashimoto's disease",
  "Hashimoto's thyroiditis",
  "Hashimoto's thyroiditis",
  "Hashimoto's thyroiditis",
  "Hashimoto's disease",
  "Hashimoto's thyroiditis",
  "hashimoto's disease",
  "Hashimoto's disease",
  "Hashimoto's disease",
  "Hashimoto's disease",
  "Hashimoto's hypothyroidism",
  "Hashimoto's thiroiditis",
  "Hashimoto's thyroiditis",
  "Hashimoto's, fibromyalgia ",
  "Henoch-Schonlein purpura, Lupus",
  "Hidradenitis suppurativa",
  "Hidradenitis suppurativa",
  "Hidradenitis suppurativa",
  "Hypogammaglobulinemia",
  "Hashimoto's hypothyroidism",
  "I believe MS is an autoimmune disorder ",
  "Idiopathic Angio Edema",
  "IGA immune deficiency",
  "Immune thrombocytopenic purpura",
  "Inflammatory arthritis",
  "Inflammatory arthritis",
  "Inflammatory Bowel Disease",
  "Interstitial Cystitis",
  "Iritis, JRA",
  "Irritible bowel syndrome",
  "ITP",
  "Juvenile arthritis",
  "Kidney disease ",
  "Lichen planopolaris ",
  "Lichen sclerosis and Graves' disease (see response for thyroid disease)",
  "Lichen sclerosis, Interstitial cystitis",
  "Lichen Sclerosus",
  "Lupus",
  "Lupus (LE)",
  #"Mast Cell Activation Syndrome",
  "Mixed connective tissue disorder ",
  "Multiple sclerosis",
  "Multiple sclerosis",
  "Multiple sclerosis",
  "Myesthenia Gravis",
  "Narcolepsy + cataplexy ",
  "Plaque psoriasis",
  "Psioriasis",
  "Psorasis",
  "Psoriasis",
  "Psoriasis",
  "Psoriasis",
  "Psoriasis and psoriatic arthritis",
  "Psoriasis, Ankylosing Spondylitis",
  "Psoriatic arthritis",
  "Psoriatic arthritis",
  "RA",
  #"RA and hashimotos",
  "Raynauds",
  "Raynauds",
  "Reactive arthritis",
  "Rheumatoid arthritis",
  "Rheumatoid arthritis",
  "Rheumatoid arthritis",
  "Rheumatoid arthritis",
  "Rheumatoid arthritis",
  #"Ro anitbodies characteristic of Lupus & Sjogrens, intermittent symptoms, not yet diagnosed with specific disorder",
  "Sjodren's",
  "Sjogren's",
  "Sjogren's syndrome",
  "Spinal Stenosis ",
  "Systemic Lupus Erythematosus ",
  "Type 1 diabetes",
  "Type 1 diabetes",
  "Ulcerative colitis",
  "Ulcerative colitis",
  "Ulcerative colitis",
  "Ulcerative colitis",
  "Ulcerative colitis and psoriasis",
  "ulcerative colitis, alopecia areata",
  "Ulcerative Colitis, Psoriasis",
  "Ulcerative Proctitis",
  "Ulcerative Proctitis",
  "Unclear. History with rheumatic fever, arthritis and mystery inflammatory conditions ",
  #"Uveitis",
  "Vitiligo",
  "Vitiligo",
  "Vitiligo",
  "Working with Rheumatologist to get a diagnosis pre pregnancy "
))
#describeFactors(data8$bl24_autoimmune_other)

#describeFactors(data8$bl24_mh_other)

data8$bl24_mh_other <- factor(data8$bl24_mh_other, levels = c(
  "Acute anxiety/depression",
  "AD/HD inattentive type ",
  "Adhd",
  "ADHD",
  "ADHD ",
  "ADHD and anxiety",
  "Adhd, anxiety ",
  "Adhd, bipolar, ppd, ppa",
  "ADHD, some depression/anxiety",
  "ADHD/anxiety",
  "ADHD/social anxiety",
  "anxiety",
  "Anxiety",
  "anxiety ",
  "Anxiety ",
  "Anxiety & depression ",
  "Anxiety & Depression ",
  "Anxiety & OCD",
  "Anxiety & PMDD",
  "anxiety / depression",
  "Anxiety / Depression",
  "anxiety after loss and trauma",
  "Anxiety and ADHD",
  "anxiety and depression",
  "Anxiety and depression",
  "Anxiety and Depression",
  "Anxiety and depression ",
  "Anxiety and Depression ",
  "Anxiety and OCD",
  "Anxiety and postpartum depression ",
  "Anxiety and PTSD",
  "Anxiety as a child",
  "Anxiety depresision",
  "Anxiety depression ",
  "anxiety disorder",
  "Anxiety disorder",
  "Anxiety Disorder",
  "Anxiety disorder ",
  "Anxiety disorder with panic disorder",
  "anxiety in pregnancy",
  "Anxiety OCD",
  "Anxiety on and off ",
  "Anxiety with OCD tendencies",
  "Anxiety, borderline personality disorder ",
  "anxiety, depression",
  "Anxiety, depression",
  "Anxiety, Depression",
  "ANXIETY, DEPRESSION",
  "Anxiety, depression ",
  #"Anxiety, depression, ADHD",
  "Anxiety, depression, OCD",
  "Anxiety, Depression, PTSD, ADHD",
  "Anxiety, eating disorder ",
  #"Anxiety, OCD",
  "Anxiety, Panic Attacks",
  #"Anxiety, ptsd",
  "Anxiety, Type 2 Bipolar Disorder",
  "Anxiety/ depression",
  "anxiety/depression",
  "Anxiety/depression",
  "Anxiety/Depression",
  "Anxiety/depression ",
  "Anxiety/Depression ",
  "Anxiety/depression mild",
  "Anxiety/depression recovering",
  "Anxiety/depression, stopped medication when became pregnant",
  #"Anxiety/depression/ptsd",
  "Anxiety/History of Depressiom",
  "Anxiety/OCD",
  "Anxiety/OCD ",
  "Anxiety/Panic",
  "Asthma",
  #"Attention Deficit Hyperactivity Disorder ",
  "Bi-polar and PTSD",
  "Bi polar",
  "Bi Polar 2",
  "Bipolar",
  "Bipolar 1",
  "Bipolar 2",
  "Bipolar disorder",
  "Bipolar disorder ",
  "Bipolar disorder; anxiety disorder",
  "Bipolar ii",
  "Body Dysmorphia, anxiety",
  "Body dysmorphic disorder",
  "Borderline",
  "Borderline Personality Disorder",
  "BPD",
  "bpd,  depressive disorder ",
  #"BPD, depression, anxiety",
  "bulimia nervosa",
  "Bulimia nervosa",
  "bulimia, OCD, depression",
  "C-PTSD",
  #"Chronic major depressive disorder, anxiety",
  "Clinical Depression",
  #"Conversion Disorder/ Anxiety",
  "CPTSD",
  "DÃ©pression, anxiety",
  "DÃ©pression/OCD",
  "depression",
  "Depression",
  "depression ",
  "Depression ",
  "Depression & anxiety",
  "Depression & anxiety ",
  "Depression (12 years ago)",
  "Depression (managed/stable)",
  "Depression / Bipolar",
  "Depression /anxiety",
  "depression and anxiety",
  "Depression and anxiety",
  "Depression and anxiety ",
  "Depression and anxiety (postpartum and during pregnancy)",
  "Depression and anxiety, dissociative disorder",
  #"Depression Episode in 2002",
  "Depression Pre-existing",
  "depression, anxiety",
  "Depression, anxiety",
  "Depression, Anxiety",
  "Depression, anxiety ",
  "Depression, anxiety, ?OCD",
  "depression, anxiety, OCD, PTSD",
  "Depression, anxiety, ODD ",
  "Depression, Eating Disorder, Anxiety",
  "Depression. And anxiety",
  "Depression/ Anxiety",
  "Depression/ Anxiety ",
  "Depression/ Anxiety/ ADHD - inattentive type",
  "Depression/ PTSD",
  "depression/anxiety",
  "Depression/anxiety",
  "Depression/Anxiety",
  "Depression/anxiety ",
  "Depression/Anxiety ",
  "Depression/Anxiety/OCD",
  "Depression/GAD",
  "depression; anxiety; panic attacks (off meds due to pregnancy)",
  "Diagnosed with perinatal depression and anxiety disorder when 5 months pregnant",
  "Dysthymia & perinatal depression ",
  "Gad",
  "GAD",
  "GAD ",
  "GAD & MDD",
  "GAD and depression",
  "GAD depression ",
  "GAD, and PPD a couple years ago",
  "GAD, OCD, depression",
  "General anxiety",
  "General Anxiety",
  "general anxiety disorder",
  "General anxiety disorder",
  "General Anxiety Disorder",
  "GENERAL ANXIETY DISORDER",
  "General anxiety disorder and a traumatic brain injury ",
  "General Anxiety, OCD",
  "General anxiety/depression",
  "Generalized and social anxiety",
  "generalized anxiery",
  "generalized anxiety",
  "Generalized Anxiety",
  "Generalized Anxiety ",
  "Generalized Anxiety and Depression",
  "Generalized anxiety and depression ",
  "generalized anxiety disorder",
  "Generalized anxiety disorder",
  "Generalized Anxiety Disorder",
  "Generalized anxiety disorder ",
  "Generalized Anxiety disorder ",
  "Generalized Anxiety Disorder ",
  "Generalized Anxiety Disorder and Health Anxiety Disorder",
  "Generalized Anxiety Disorder, Episodic Depression",
  "generalized anxiety disorder, history of major depressive disorder",
  "Generalized anxiety disorder, major depressive disorder (in remission)",
  "Generalized Anxiety Disorder, OCD",
  "Generalized anxiety disorder, PTSD",
  "Generalized Anxiety Disorder; Obsessive-Compulsive Personality Disorder",
  #"Generalized Anxiety Disorder; occasional depression",
  "History of anxiety & pospartum depression",
  "History of anxiety and depression, good mental health during pregnancy",
  "History of Depression",
  "History of depression and anxiety, but not at present",
  #"History of depression/dysthymia",
  "History of mental illness in my family causes me to monitor my own.",
  #"History of minor depression ",
  "Hx anxiety",
  "HX depression and anxiety",
  "HX of anxiety and depression",
  "I experience anxiety but it is not diagnosed or medicated",
  "I had Bulimia in my early 20's",
  "Major depression",
  #"Major depression and Social Anxiety ",
  "Major depressive disorder, generalized anxiety disorder and post traumatic stress disorder",
  "MDD; GAD",
  "Mild anxiety",
  "Mild Anxiety",
  #"Mild depression",
  "mild depression & anxiety",
  "Mild Depression and anxiety",
  "Mild generalized anxiety",
  "Mood disorder, ADHD",
  "O.C.D, P.T.S.D, N.V.L.D, Depression, Anxiety",
  "Obsessive Compulsive Disorder",
  "Obsessive compulsive disorder ",
  "OCD",
  "OCD - Just Right/symmetry ",
  "OCD & GAD",
  "OCD and anxiety ",
  "OCD and eating disorder",
  "OCD PTSD Anxiety",
  "OCD, GAD, Depression",
  #"OCD, GAD. EDNOS",
  "OCD, PTSD",
  "OCD/ anxiety ",
  "OCD/depression",
  "One time, major depressive/anxiety  episode",
  "Panic attack disorder ",
  "Panic attacks, depression ",
  "Panic Disorder",
  "PMDD",
  #"Post partum",
  "Post partum anxiety",
  "Post Partum Anxiety",
  "Post partum Anxiety/anxiety",
  "Post partum anxiety/depression ",
  "Post partum depression",
  #"Postnatal PTSD, PPA, anxiety, depression",
  "Postpartum anxiety",
  "Postpartum anxiety ",
  "Postpartum Anxiety and Depression",
  "Postpartum anxiety previous pregnancy ",
  "Postpartum depression",
  "Postpartum Depression",
  "Postpartum depression ",
  "Postpartum Depression ",
  "Postpartum depression and anxiety",
  "Postpartum Depression and Anxiety",
  #"Postpartum depression, postpartum anxiety, postpartum ptsd ",
  "Postpartum depression/anxiety",
  "Postpartum depression/anxiety ",
  "Ppa",
  "PPA",
  "Ppa and ppd",
  "PPA, PPD",
  "PPA/PPD",
  "PPD",
  #"PPD, General anxiety history ",
  "PPD/PPA",
  "Prenatal depression ",
  "Previously diagnosed with anxiety/depression",
  "PTSD",
  "Ptsd ",
  "PTSD +GAD+ADHD",
  "PTSD, Anxiety, Depression",
  "PTSD, depression, anxiety",
  "PTSD/Bipolar II/Borderline Personality Disorder",
  "PTSD/BPD",
  "Seasonal affective disorder/depression.",
  "Seasonal depression",
  "Seasonal Depression",
  "Severe depression ",
  "Situational anxiety (currently not affecting me) and previously also depression, but no longer.",
  "Situational depression",
  "Situational depression twice",
  "Some depression",
  "Trichitillomania "
), labels = c(
  "Acute anxiety/depression",
  "AD/HD inattentive type ",
  "ADHD",
  "ADHD",
  "ADHD",
  "ADHD & anxiety",
  "ADHD & anxiety",
  "Adhd, bipolar, ppd, ppa",
  "ADHD, some depression/anxiety",
  "ADHD & anxiety",
  "ADHD/social anxiety",
  "Anxiety",
  "Anxiety",
  "Anxiety",
  "Anxiety",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & OCD",
  "Anxiety & PMDD",
  "anxiety & depression",
  "Anxiety & depression",
  "anxiety after loss and trauma",
  "ADHD & Anxiety",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety and OCD",
  "Anxiety and postpartum depression ",
  "Anxiety and PTSD",
  "Anxiety as a child",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety disorder",
  "Anxiety disorder",
  "Anxiety disorder",
  "Anxiety disorder",
  "Anxiety disorder with panic disorder",
  "anxiety in pregnancy",
  "Anxiety OCD",
  "Anxiety on and off",
  "Anxiety with OCD tendencies",
  "Anxiety, borderline personality disorder ",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  #"Anxiety, depression, ADHD",
  "Depression/Anxiety/OCD",
  "Anxiety, Depression, PTSD, ADHD",
  "Anxiety, eating disorder ",
  #"Anxiety, OCD",
  "Anxiety, Panic Attacks",
  #"Anxiety, ptsd",
  "Anxiety, Type 2 Bipolar Disorder",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety/depression mild",
  "Anxiety/depression recovering",
  "Anxiety/depression, stopped medication when became pregnant",
  #"Anxiety/depression/ptsd",
  "Anxiety/History of Depressiom",
  "Anxiety/OCD",
  "Anxiety/OCD",
  "Anxiety/Panic",
  "Asthma",
  #"Attention Deficit Hyperactivity Disorder ",
  "Bipolar and PTSD",
  "Bipolar",
  "Bi Polar 2",
  "Bipolar",
  "Bipolar 1",
  "Bipolar 2",
  "Bipolar disorder",
  "Bipolar disorder",
  "Bipolar disorder; anxiety disorder",
  "Bipolar 2",
  "Body Dysmorphia, anxiety",
  "Body dysmorphic disorder",
  "Borderline Personality Disorder (BPD)",
  "Borderline Personality Disorder (BPD)",
  "Borderline Personality Disorder (BPD)",
  "bpd,  depressive disorder ",
  #"BPD, depression, anxiety",
  "Bulimia nervosa",
  "Bulimia nervosa",
  "bulimia, OCD, depression",
  "C-PTSD",
  #"Chronic major depressive disorder, anxiety",
  "Clinical Depression",
  #"Conversion Disorder/ Anxiety",
  "CPTSD",
  "Anxiety & depression",
  "Depression/OCD",
  "Depression",
  "Depression",
  "Depression",
  "Depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Depression (12 years ago)",
  "Depression (managed/stable)",
  "Depression / Bipolar",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Depression and anxiety (postpartum and during pregnancy)",
  "Depression and anxiety, dissociative disorder",
  #"Depression Episode in 2002",
  "Depression Pre-existing",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Depression/Anxiety/OCD",
  "depression, anxiety, OCD, PTSD",
  "Depression/Anxiety/OCD",
  "Depression, Eating Disorder, Anxiety",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Depression/ Anxiety/ ADHD - inattentive type",
  "Depression/ PTSD",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Anxiety & depression",
  "Depression/Anxiety/OCD",
  "Depression/GAD",
  "depression; anxiety; panic attacks (off meds due to pregnancy)",
  "Diagnosed with perinatal depression and anxiety disorder when 5 months pregnant",
  "Dysthymia & perinatal depression ",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "GAD & MDD",
  "Generalized anxiety/depression",
  "Generalized anxiety/depression",
  "GAD, and PPD a couple years ago",
  "GAD, OCD, depression",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "General anxiety disorder and a traumatic brain injury ",
  "General Anxiety, OCD",
  "Generalized anxiety/depression",
  "Generalized and social anxiety",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety/depression",
  "Generalized anxiety/depression",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "Generalized anxiety disorder (GAD)",
  "Generalized Anxiety Disorder and Health Anxiety Disorder",
  "Generalized Anxiety Disorder, Episodic Depression",
  "generalized anxiety disorder, history of major depressive disorder",
  "Generalized anxiety disorder, major depressive disorder (in remission)",
  "Generalized Anxiety Disorder, OCD",
  "Generalized anxiety disorder, PTSD",
  "Generalized Anxiety Disorder; Obsessive-Compulsive Personality Disorder",
  #"Generalized Anxiety Disorder; occasional depression",
  "History of anxiety & pospartum depression",
  "History of anxiety and depression, good mental health during pregnancy",
  "History of Depression",
  "History of depression and anxiety, but not at present",
  #"History of depression/dysthymia",
  "History of mental illness in my family causes me to monitor my own.",
  #"History of minor depression ",
  "History of anxiety",
  "History of depression and anxiety",
  "History of depression and anxiety",
  "I experience anxiety but it is not diagnosed or medicated",
  "I had Bulimia in my early 20's",
  "Major depression",
  #"Major depression and Social Anxiety ",
  "Major depressive disorder, generalized anxiety disorder and post traumatic stress disorder",
  "MDD; GAD",
  "Mild anxiety",
  "Mild anxiety",
  #"Mild depression",
  "Mild depression & anxiety",
  "Mild depression & anxiety",
  "Mild generalized anxiety",
  "Mood disorder, ADHD",
  "O.C.D, P.T.S.D, N.V.L.D, Depression, Anxiety",
  "Obsessive compulsive disorder (OCD)",
  "Obsessive compulsive disorder (OCD)",
  "Obsessive compulsive disorder (OCD)",
  "OCD - Just Right/symmetry ",
  "OCD & GAD",
  "OCD & anxiety ",
  "OCD and eating disorder",
  "OCD PTSD Anxiety",
  "OCD, GAD, Depression",
  #"OCD, GAD. EDNOS",
  "OCD, PTSD",
  "OCD & anxiety ",
  "OCD/depression",
  "One time, major depressive/anxiety  episode",
  "Panic attack disorder",
  "Panic attacks, depression ",
  "Panic Disorder",
  "PMDD",
  #"Postpartum",
  "Postpartum anxiety",
  "Postpartum anxiety",
  "Postpartum anxiety",
  "Postpartum anxiety & depression",
  "Postpartum depression",
  #"Postnatal PTSD, PPA, anxiety, depression",
  "Postpartum anxiety",
  "Postpartum anxiety",
  "Postpartum anxiety & depression",
  "Postpartum anxiety previous pregnancy ",
  "Postpartum depression",
  "Postpartum depression",
  "Postpartum depression",
  "Postpartum depression",
  "Postpartum anxiety & depression",
  "Postpartum anxiety & depression",
  #"Postpartum depression, postpartum anxiety, postpartum ptsd ",
  "Postpartum anxiety & depression",
  "Postpartum anxiety & depression",
  "PPA",
  "PPA",
  "PPA & PPD",
  "PPA, PPD",
  "PPA & PPD",
  "PPD",
  #"PPD, General anxiety history",
  "PPA & PPD",
  "Prenatal depression",
  "Previously diagnosed with anxiety/depression",
  "PTSD",
  "PTSD",
  "PTSD +GAD+ADHD",
  "PTSD, Anxiety, Depression",
  "PTSD, depression, anxiety",
  "PTSD/Bipolar II/Borderline Personality Disorder",
  "PTSD/BPD",
  "Seasonal affective disorder/depression.",
  "Seasonal depression",
  "Seasonal depression",
  "Severe depression ",
  "Situational anxiety (currently not affecting me) and previously also depression, but no longer.",
  "Situational depression",
  "Situational depression twice",
  "Some depression",
  "Trichitillomania "
))
#describeFactors(data8$bl24_mh_other)


#describeFactors(data8$bl24_other_speci.4mo)

data8$bl24_other_speci.4mo <- factor(data8$bl24_other_speci.4mo, levels = c(
  "Acute angle glaucoma",
  "Adenomyosis ",
  "ADHD",
  "ADHD /Sleep apnea",
  "allergies",
  "Allergies",
  "Allergies ",
  "Allergies - sulpha and macrobid antibiotics ",
  "Allergy",
  #"Anaphylactic nut/peanut allergy",
  "Anemia",
  "Anxiety",
  "Anxiety; chronic pain",
  "Arachnoid web in spine and low blood pressure ",
  "Arrhythmia ",
  "Aspergers",
  "Asymptomatic heart murmur",
  #"Atypical Migraines",
  "Aura Migraines",
  "Autism 1",
  "Bariatric patient, Avascular Necrosis (Right hip replacement 2 years ago), 2.5 years recovering alcoholic, duodenal ulcers managed by medication",
  "Beta thalassemia trait",
  "Bile Salt Malabsorption; Reynaud's",
  "Blood clotting disorder",
  "Breast Cancer",
  "Cavernoma",
  "Celiac",
  "Celiac disease",
  "Celiac Disease ",
  #"Cervical cancer",
  "Cervical incompetence ",
  "Chiari Malformation",
  "Chronic Cluster Headaches",
  "Chronic Fatigue Syndrome",
  "Chronic hip pain",
  "Chronic Migraine",
  "Chronic migraines",
  "Chronic Migraines ",
  "chronic myofascial pain, chronic lower back pain",
  "Chronic pain",
  "Chronic Pain",
  "Chronic proteinuria",
  "Chronic Spontaneous Uticaria",
  "Chronic symptomatic PVCs. No cardiac disease.",
  "Chronic vitamin d deficiency",
  "Cipralex 20mg",
  "Cold uticaria ",
  "Congenital myasthenic syndrome",
  "Connective tissue disorder - ehlers Danlos hypermobile type",
  "Coronary artery aneurysms due to Kawasaki disease",
  "Crohn's disease",
  "Decreased kidney function in one kidney",
  "deep vein thromboses X3, small atrial septal defect",
  "Delayed Sleep Phase Disorder",
  "Depression",
  "Dermatographia",
  "Diabetes insipidus",
  "Diagnosed with gestational diabetes. Previously (over 5 yrs ago) had depression/anxiety mood disorder for approximately 10+ yrs",
  "Eating disorder",
  "eczema",
  "Eczema",
  "Eczema ",
  #"eczema, allergies",
  "Ehlers Dan Los Syndrome",
  "Ehlers Danlos",
  #"Elhers danlos type 3",
  "Endomestiosis ",
  "Endometriosis",
  "endometriosis ",
  "Endometriosis ",
  "Endometriosis & PCOS",
  "Endometriosis, anemia, adenomyosis ",
  "Endometriosis, PCOS",
  #"Endometriosis/adenomyosis",
  "Environmental Allergies",
  #"eosinophilic esophagitis",
  "Epilepsy ",
  "Essential Thrombycitosis",
  "Factor V Leiden",
  "Factor V Leiden (blood clotting disorder)",
  #"Familial Hypercholesterolemia",
  "Fatty liver disease",
  "Fibromyalgia",
  "Fibromyalgia ",
  "fibromyalgia (off meds due to pregnancy)",
  "Fibromylgia",
  "Food intollerances, excema",
  "G6PD",
  "GERD",
  "GERD, Eczema",
  "GERD, environmental allergies",
  #"Had one bout of Bells Palsy randomly ",
  "Hearing loss ",
  "Heart murmur",
  "Hemochromatosis",
  "hemochromotosis",
  "Herpes",
  "Herpes Simplex",
  "Hip dysplasia, chronic gastritis",
  "History of postpartum depression/anxiety",
  "HSV 1",
  "HSV2",
  #"Hypermobile Ehlers Danlos Syndrome ",
  #"Hypermobility spectrum disorder",
  "Hypermobility Spectrum Disorder",
  "Hypertriglyceridemia",
  "Hypotension",
  "I have a heart murmur",
  "IBS",
  "IBS-C",
  "IBS and GERD",
  "Ibs and visceral hypersensitivity ",
  "IBS, endometriosis ",
  "IBS, Gastritis, Acid Reflux, 3 Focal Nodular Hyperplasia in Liver",
  "IBS, gastroesophageal reflux",
  #"IBS, scoliosis, myofascial dysfunction",
  #"Ibs/irritable bladder/chronic pelvic pain/reynauds",
  "IBSD, Factor 5 Leiden",
  "Idiopathic Hypersomnia",
  #"idiopathic uveitis",
  "In remission from osteosarcoma diagnosis in 2006",
  "Infertility",
  "Insulin resistance",
  "Insulin Resistance",
  "iron def anemia ",
  "Iron deficiency",
  "Iron deficient anemia",
  "Iron levels have been slightly low since my second pregnancy (currently carrying my third child)",
  "Irritable Bowel",
  "Irritable Bowel Syndrome",
  "Joint Hypermobility Syndrome",
  "Kidney diseass",
  "Kidney stones",
  "L Central Retinal Vein Occulsion, HLAB27 positive",
  "Lichen sclerosis ",
  "Low iron",
  #"Low iron (had to get iron IV)",
  "Lyme disease ",
  "Migraine",
  "Migraine, Ankylosing Spondylitis ",
  "Migraines",
  "Migraines ",
  "Migraines and low BP (usually 100/60)",
  "Migraines with aura",
  "Mild Chrohns Disease",
  "Mild PCOS",
  "mild proctitis",
  "Minor Heart Murmur",
  "Moderately severe kidney condition",
  "Nasal polyps",
  "Non obese PCOS",
  "Once had a tentative diagnosis of Crohn's but it was never confirmed",
  "Pcos",
  "PCOS",
  "Pcos ",
  #"PCOS / Insulin resistance",
  "Pituitary Adenoma and PCOS",
  "Pituitary Adenoma and Thyroid Nodules",
  "Pityriasis lichenoides",
  "Pollen allergies",
  "Poly Cystic Ovary Syndrome",
  "Polycycstic Ovarian Syndrome (PCOS)",
  "Polycystic Ovarian Syndrome",
  "Polycystic Ovarian Syndrome (PCOS)",
  "Polycystic ovaries",
  "Porphyria",
  "Proctitis",
  "Prolactanemia ",
  "Prolactinoma",
  "Psoriasis",
  "Raynaud's and erythromelagia (vascular conditions)",
  "Recent excision for low risk melanoma",
  "Rhumatoid arthritis",
  #"Right Vericose Vein Ligation 2018",
  "Scoliosis",
  "Scoliosis ",
  "Scoliosis, poly cystic ovary syndrome",
  "Seasonal allergies",
  "Seasonal allergies ",
  "Seborrheic dermatitis",
  "Severe allergies",
  "Severe chronic eczema",
  "Severe sensorineural hearing loss",
  "Sick sinus syndrome",
  "Skeletal Dysplasia",
  "sleep apnea",
  "Solitary kidney due to Wilms Tumour (in remission since 1993)",
  "Splenectomy due to trauma",
  #"Sturge-Weber Syndrome (type 2)",
  #"TB - Permanent Scarring ",
  "Tda",
  "Thalassemia",
  "Thoracic Outlet Syndrome ",
  "Thrombosis",
  "Tumor",
  "Twin pregnancy-miscarried one baby in April 2020",
  "Ulcerative colitis",
  "Ulcerative Colitis",
  "Ulcerative proctitis",
  "Ulcerative proctitis ",
  "ureterovesical reflux",
  "Uterine fibroids",
  "Visual migraines",
  "Von Willebrands Disease",
  "Von Willebrands disease bleeding disorder",
  "VSD"
), labels = c(
  "Acute angle glaucoma",
  "Adenomyosis ",
  "ADHD",
  "ADHD /Sleep apnea",
  "Allergies",
  "Allergies",
  "Allergies",
  "Allergies - sulpha and macrobid antibiotics ",
  "Allergy",
  #"Anaphylactic nut/peanut allergy",
  "Anemia",
  "Anxiety",
  "Anxiety; chronic pain",
  "Arachnoid web in spine and low blood pressure ",
  "Arrhythmia",
  "Aspergers",
  "Asymptomatic heart murmur",
  #"Atypical Migraines",
  "Aura Migraines",
  "Autism 1",
  "Bariatric patient, Avascular Necrosis (Right hip replacement 2 years ago), 2.5 years recovering alcoholic, duodenal ulcers managed by medication",
  "Beta thalassemia trait",
  "Bile Salt Malabsorption; Reynaud's",
  "Blood clotting disorder",
  "Breast Cancer",
  "Cavernoma",
  "Celiac disease",
  "Celiac disease",
  "Celiac disease",
  #"Cervical cancer",
  "Cervical incompetence ",
  "Chiari Malformation",
  "Chronic Cluster Headaches",
  "Chronic Fatigue Syndrome",
  "Chronic hip pain",
  "Chronic migraine",
  "Chronic migraine",
  "Chronic migraine",
  "chronic myofascial pain, chronic lower back pain",
  "Chronic pain",
  "Chronic pain",
  "Chronic proteinuria",
  "Chronic Spontaneous Uticaria",
  "Chronic symptomatic PVCs. No cardiac disease.",
  "Chronic vitamin d deficiency",
  "Cipralex 20mg",
  "Cold uticaria ",
  "Congenital myasthenic syndrome",
  "Connective tissue disorder - ehlers Danlos hypermobile type",
  "Coronary artery aneurysms due to Kawasaki disease",
  "Crohn's disease",
  "Decreased kidney function in one kidney",
  "deep vein thromboses X3, small atrial septal defect",
  "Delayed Sleep Phase Disorder",
  "Depression",
  "Dermatographia",
  "Diabetes insipidus",
  "Diagnosed with gestational diabetes. Previously (over 5 yrs ago) had depression/anxiety mood disorder for approximately 10+ yrs",
  "Eating disorder",
  "Eczema",
  "Eczema",
  "Eczema",
  #"Eczema, allergies",
  "Ehlers Danlos Syndrome",
  "Ehlers Danlos Syndrome",
  #"Elhers danlos type 3",
  "Endometriosis",
  "Endometriosis",
  "endometriosis",
  "Endometriosis",
  "Endometriosis & PCOS",
  "Endometriosis, anemia, adenomyosis ",
  "Endometriosis, PCOS",
  #"Endometriosis/adenomyosis",
  "Environmental Allergies",
  #"eosinophilic esophagitis",
  "Epilepsy",
  "Essential Thrombycitosis",
  "Factor V Leiden",
  "Factor V Leiden",
  #"Familial Hypercholesterolemia",
  "Fatty liver disease",
  "Fibromyalgia",
  "Fibromyalgia",
  "fibromyalgia (off meds due to pregnancy)",
  "Fibromyalgia",
  "Food intollerances, excema",
  "G6PD",
  "GERD",
  "GERD, Eczema",
  "GERD, environmental allergies",
  #"Had one bout of Bells Palsy randomly ",
  "Hearing loss ",
  "Heart murmur",
  "Hemochromatosis",
  "Hemochromatosis",
  "Herpes",
  "Herpes Simplex",
  "Hip dysplasia, chronic gastritis",
  "History of postpartum depression/anxiety",
  "HSV 1",
  "HSV2",
  #"Hypermobile Ehlers Danlos Syndrome ",
  #"Hypermobility spectrum disorder",
  "Hypermobility Spectrum disorder",
  "Hypertriglyceridemia",
  "Hypotension",
  "Heart murmur",
  "IBS",
  "IBS-C",
  "IBS and GERD",
  "Ibs and visceral hypersensitivity ",
  "IBS, endometriosis ",
  "IBS, Gastritis, Acid Reflux, 3 Focal Nodular Hyperplasia in Liver",
  "IBS, gastroesophageal reflux",
  #"IBS, scoliosis, myofascial dysfunction",
  #"Ibs/irritable bladder/chronic pelvic pain/reynauds",
  "IBSD, Factor 5 Leiden",
  "Idiopathic Hypersomnia",
  #"Idiopathic uveitis",
  "In remission from osteosarcoma diagnosis in 2006",
  "Infertility",
  "Insulin resistance",
  "Insulin resistance",
  "Iron deficient anemia",
  "Iron deficiency",
  "Iron deficient anemia",
  "Iron levels have been slightly low since my second pregnancy (currently carrying my third child)",
  "Irritable Bowel Syndrome",
  "Irritable Bowel Syndrome",
  "Joint Hypermobility Syndrome",
  "Kidney disease",
  "Kidney stones",
  "L Central Retinal Vein Occulsion, HLAB27 positive",
  "Lichen sclerosis ",
  "Low iron",
  #"Low iron (had to get iron IV)",
  "Lyme disease ",
  "Migraine",
  "Migraine, Ankylosing Spondylitis ",
  "Migraine",
  "Migraine",
  "Migraines and low BP (usually 100/60)",
  "Migraines with aura",
  "Mild Chrohns Disease",
  "Mild PCOS",
  "mild proctitis",
  "Minor Heart Murmur",
  "Moderately severe kidney condition",
  "Nasal polyps",
  "Non obese PCOS",
  "Once had a tentative diagnosis of Crohn's but it was never confirmed",
  "Polycystic Ovarian Syndrome (PCOS)",
  "Polycystic Ovarian Syndrome (PCOS)",
  "Polycystic Ovarian Syndrome (PCOS)",
  #"PCOS / Insulin resistance",
  "Pituitary Adenoma and PCOS",
  "Pituitary Adenoma and Thyroid Nodules",
  "Pityriasis lichenoides",
  "Pollen allergies",
  "Poly Cystic Ovary Syndrome",
  "Polycystic Ovarian Syndrome (PCOS)",
  "Polycystic Ovarian Syndrome (PCOS)",
  "Polycystic Ovarian Syndrome (PCOS)",
  "Polycystic Ovarian Syndrome (PCOS)",
  "Porphyria",
  "Proctitis",
  "Prolactinemia",
  "Prolactinemia",
  "Psoriasis",
  "Raynaud's and erythromelagia (vascular conditions)",
  "Recent excision for low risk melanoma",
  "Rhumatoid arthritis",
  #"Right Vericose Vein Ligation 2018",
  "Scoliosis",
  "Scoliosis",
  "Scoliosis, poly cystic ovary syndrome",
  "Seasonal allergies",
  "Seasonal allergies",
  "Seborrheic dermatitis",
  "Severe allergies",
  "Severe chronic eczema",
  "Severe sensorineural hearing loss",
  "Sick sinus syndrome",
  "Skeletal Dysplasia",
  "sleep apnea",
  "Solitary kidney due to Wilms Tumour (in remission since 1993)",
  "Splenectomy due to trauma",
  #"Sturge-Weber Syndrome (type 2)",
  #"TB - Permanent Scarring ",
  "Tda",
  "Thalassemia",
  "Thoracic Outlet Syndrome ",
  "Thrombosis",
  "Tumor",
  "Twin pregnancy-miscarried one baby in April 2020",
  "Ulcerative colitis",
  "Ulcerative colitis",
  "Ulcerative proctitis",
  "Ulcerative proctitis ",
  "ureterovesical reflux",
  "Uterine fibroids",
  "Visual migraines",
  "Von Willebrands Disease",
  "Von Willebrands disease bleeding disorder",
  "VSD"
))

#describeFactors(data8$bl24_other_speci.4mo)


```

```{r}
nrow(data8)
nrow(data7)
#`r kable(data_Covid_during_preg_1)`
#`r kable(data_Covid_during_preg_2)`

```

We excluded `r nrow(data1)-nrow(data2)+nrow(data7)-nrow(data8)` of the `r nrow(data1)` participants because it was not clear if the COVID doses were before, after or during pregnancy. 
Moreover, we excluded additional `r nrow(data2)-nrow(data3)` study participant who do not live in Canada. Of the remaining `r nrow(data3)-nrow(data7)+nrow(data8)` women, we only included the `r nrow(data4)-nrow(data7)+nrow(data8)` participants with completed pregnancies who were no longer pregnant at the 4-month follow-up. As COVID during pregnancy affects pregnancy outcomes, we also excluded `r nrow(data4)-nrow(data7)` women for whom we could not ensure that the COVID infection occurred after the delivery date.

For the remaining `r nrow(data8)` women, we summarized all pregnancy and infant outcomes variables among women vaccinated during pregnancy. 

The data in Tables 2, 3 and 4 is for all infants together, we do not distinguish between only one baby, twins, triples or more babies, because we do not have a lot of multiple births.

For Tables 0-4, we removed those missing cases, where the question was not shown to the participants. 

Note: 

* As for the height of the mothers, we allowed all values between 125cm and 193cm (average height in Canada is 162.3 cm) and treated all others as missing. 
For the "bl25_height_inches" variable, values between 4.1 and 6.1 are treated as feet and values bigger than 125 as cm.
For the "bl25_height_cm" variable, values between 1.57 and 1.7 are treated as m, values between 5.4 and 5.6 as feet, and values between 53 and 65 as inches.
* For the "bl26_weight_lbs" variable, everything below 90 was set to NA, because we don't know if these are typos, kg or just real numbers. 
* For "i4_birthlength_in1", all values greater or equal than 42.5 are treated as cm.
For "i4_birthlength_cm1", all values smaller or equal than 27 are treated as inches.

* For "io1_height_cm_1", all values between 42 and 43.3 are set to NA because the unit is unclear. Values smaller or equal than 27.4 are treated as inches.
For "io1_height_inches_1", values 63 and 67 are considered cm. 
* For "io2_weight_kg_1", values 18.5 and 18.6 are considered lbs instead of kg.
For "io2_weight_lbs_1", values 6.4 and 7.3 are treated as kg and not as lbs.




<br>

<br>


```{r table 1 and 2 specify, include = TRUE}

getT1Stat <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[, varname], 
                        data8$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=FALSE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat.median <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[, varname], 
                        data8$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=FALSE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}

getT1Stat2 <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$v1_dose1_like.4mo == "I have already received a COVID-19 vaccine" & !is.na(data8$v1_dose1_like.4mo), varname], 
                        data8$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}


data8 <- as.data.frame(data8)
table_data <- list()

# Get the basic stats

table_data[["69: Specify other chronic lung disease"]] <- getT1Stat("bl24_otherlung_other", 1)
table_data[["76: Specify other cardiovascular disease"]] <- getT1Stat("bl24_othercardio_other", 1)
table_data[["80: Specify thyroid disease"]] <- getT1Stat("bl24_t.4moroid_other", 1)
table_data[["84: Specify neurological disorder"]] <- getT1Stat("bl24_neuro_other", 1)
table_data[["88: Specify autoimmune disorder"]] <- getT1Stat("bl24_autoimmune_other", 1)
table_data[["95: Specify other immune suppression"]] <- getT1Stat("bl24_otherimmune_other", 1)
table_data[["105: Specify mental health condition"]] <- getT1Stat("bl24_mh_other", 1)
table_data[["109: Specify other pre-existing health condition"]] <- getT1Stat("bl24_other_speci.4mo", 1)

table_data[["379: Specify other reason for C-section"]] <- getT1Stat("p14_emergcs_reason_other.comb", 1)
table_data[["384: Specify other complications"]] <- getT1Stat("p15_complications_info.comb", 1)
table_data[["403: Infant 1: Specify other infant health events"]] <- getT1Stat("i5_events_other_info1", 1)
table_data[["422: Infant 2: Specify other infant health events"]] <- getT1Stat("i5_events_other_info2", 1)
table_data[["441: Infant 3: Specify other infant health events"]] <- getT1Stat("i5_events_other_info3", 1)

table_data[["447: Infant 1: Specify diagnoses given in NICU"]] <- getT1Stat("n4_diagnoses_info.comb", 1)
table_data[["453: Infant 2: Specify diagnoses given in NICU"]] <- getT1Stat("n4_diagnoses_info_2.comb", 1)




# Now merge everything into a matrix
# and create the rgroup & n.rgroup variabels
rgroup <- c()
n.rgroup <- c()
output_data <- NULL
for (varlabel in names(table_data)) {
  output_data <- rbind(output_data, 
                       table_data[[varlabel]])
  rgroup <- c(rgroup, 
              varlabel)
  n.rgroup <- c(n.rgroup, 
                nrow(table_data[[varlabel]]))
}
 
# Add a column spanner for the death columns
cgroup <- c("", "Vaccination")
n.cgroup <- c(1,2)#c(1, 3)
#colnames(output_data) <- c("Total", "during pregnancy", "not during pregnancy") #colnames(output_data) #c("Have you ACCESSED this service and HOW?")
#colnames(output_data) <- gsub("[ ]*HIV Status", "", colnames(output_data))
 
htmlTable::htmlTable(output_data, align = "rrrr",
          rgroup = rgroup, n.rgroup = n.rgroup, 
          css.rgroup.sep = "", 
          cgroup = cgroup,
          n.cgroup = n.cgroup,
          rowlabel = "", 
          caption = "Table 1 and 2. Specification of pre-existing health conditions and infant health events", 
          #tfoot = "P-values are from Wilcoxon rank sum tests for continuous variables and Fisher's exact tests for categorical variables",
          ctable = TRUE) %>% htmltools::html_print()

```


<br>

<br>


```{r table 0a, include = TRUE}

getT1Stat <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[, varname], 
                        data8$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat.median <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[, varname], 
                        data8$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}


getT1Stat_20 <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl4_dose1 == 1 & !is.na(data8$bl4_dose1), varname], 
                        data8[data8$bl4_dose1 == 1 & !is.na(data8$bl4_dose1), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}

getT1Stat_gestage_dose1 <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl4_dose1 == 1 & data1$bl1_currently_preg == 1 & !is.na(data8$bl4_dose1), varname], 
                        data8[data8$bl4_dose1 == 1 & data1$bl1_currently_preg == 1 & !is.na(data8$bl4_dose1), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}

getT1Stat_27 <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl8_dose2 == 1 & !is.na(data8$bl8_dose2), varname], 
                        data8[data8$bl8_dose2 == 1 & !is.na(data8$bl8_dose2), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}

getT1Stat_gestage_dose2 <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl8_dose2 == 1 & data1$bl1_currently_preg == 1 & !is.na(data8$bl8_dose2), varname], 
                        data8[data8$bl8_dose2 == 1 & data1$bl1_currently_preg == 1 & !is.na(data8$bl8_dose2), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}


data8 <- as.data.frame(data8)
table_data <- list()

# Get the basic stats

table_data[["Timing of dosis 1"]] <- getT1Stat("dose1_preg", 1)
table_data[["Timing of dosis 2"]] <- getT1Stat("dose2_preg", 1)
table_data[["20: What type of vaccine did you receive? (dose 1)"]] <- getT1Stat_20("bl7_dose1_.4mope", 1)
#table_data[["Timing of dosis 1 during pregnancy"]] <- getT1Stat_gestage_dose1("gestational_age_dosis1", 1)
table_data[["27: What type of vaccine did you receive? (dose 2)"]] <- getT1Stat_27("bl11_dose2_.4mope", 1)
#table_data[["Timing of dosis 2 during pregnancy"]] <- getT1Stat_gestage_dose2("gestational_age_dosis2", 1)


# Now merge everything into a matrix
# and create the rgroup & n.rgroup variabels
rgroup <- c()
n.rgroup <- c()
output_data <- NULL
for (varlabel in names(table_data)) {
  output_data <- rbind(output_data, 
                       table_data[[varlabel]])
  rgroup <- c(rgroup, 
              varlabel)
  n.rgroup <- c(n.rgroup, 
                nrow(table_data[[varlabel]]))
}
 
# Add a column spanner for the death columns
cgroup <- c("", "Vaccination")
n.cgroup <- c(1,3)#c(1, 3)
#colnames(output_data) <- c("Total", "during pregnancy", "not during pregnancy", "p-value") #colnames(output_data) #c("Have you ACCESSED this service and HOW?")
#colnames(output_data) <- gsub("[ ]*HIV Status", "", colnames(output_data))
 
htmlTable::htmlTable(output_data, align = "rrrr",
          rgroup = rgroup, n.rgroup = n.rgroup, 
          css.rgroup.sep = "", 
          cgroup = cgroup,
          n.cgroup = n.cgroup,
          rowlabel = "", 
          caption = "Table 0. Vaccine data", 
          tfoot = "P-values are from Wilcoxon rank sum tests for continuous variables and Fisher's exact tests for categorical variables",
          ctable = TRUE)# %>% htmltools::html_print()

```

<br>

<br>

```{r table 0b, include = TRUE}

getT1Stat <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[, varname], 
                        data8$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=FALSE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat.median <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[, varname], 
                        data8$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=FALSE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}


getT1Stat_20 <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl4_dose1 == 1 & !is.na(data8$bl4_dose1), varname], 
                        data8[data8$bl4_dose1 == 1 & !is.na(data8$bl4_dose1), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=FALSE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}

getT1Stat_gestage_dose1 <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl4_dose1 == 1 & data8$bl1_currently_preg == 1 & !is.na(data8$bl4_dose1), varname], 
                        data8[data8$bl4_dose1 == 1 & data8$bl1_currently_preg == 1 & !is.na(data8$bl4_dose1), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=FALSE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}

getT1Stat_27 <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl8_dose2 == 1 & !is.na(data8$bl8_dose2), varname], 
                        data8[data8$bl8_dose2 == 1 & !is.na(data8$bl8_dose2), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=FALSE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}

getT1Stat_gestage_dose2 <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl8_dose2 == 1 & data8$bl1_currently_preg == 1 & !is.na(data8$bl8_dose2), varname], 
                        data8[data8$bl8_dose2 == 1 & data8$bl1_currently_preg == 1 & !is.na(data8$bl8_dose2), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=FALSE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}


data8 <- as.data.frame(data8)
table_data <- list()

# Get the basic stats

#table_data[["Timing of dosis 1"]] <- getT1Stat("dose1_preg", 1)
#table_data[["Timing of dosis 2"]] <- getT1Stat("dose2_preg", 1)
#table_data[["20: What type of vaccine did you receive? (dose 1)"]] <- getT1Stat_20("bl7_dose1_.4mope", 1)
table_data[["Timing of dosis 1 during pregnancy"]] <- getT1Stat_gestage_dose1("gestational_age_dosis1", 1)
table_data[["Timing of dosis 1 during pregnancy (trimester)"]] <- getT1Stat_gestage_dose1("trimester_dosis1", 1)

#table_data[["27: What type of vaccine did you receive? (dose 2)"]] <- getT1Stat_27("bl11_dose2_.4mope", 1)
table_data[["Timing of dosis 2 during pregnancy"]] <- getT1Stat_gestage_dose2("gestational_age_dosis2", 1)
table_data[["Timing of dosis 2 during pregnancy (trimester)"]] <- getT1Stat_gestage_dose2("trimester_dosis2", 1)


# Now merge everything into a matrix
# and create the rgroup & n.rgroup variabels
rgroup <- c()
n.rgroup <- c()
output_data <- NULL
for (varlabel in names(table_data)) {
  output_data <- rbind(output_data, 
                       table_data[[varlabel]])
  rgroup <- c(rgroup, 
              varlabel)
  n.rgroup <- c(n.rgroup, 
                nrow(table_data[[varlabel]]))
}
 
# Add a column spanner for the death columns
cgroup <- c("", "Vaccination")
n.cgroup <- c(1,2)#c(1, 3)
#colnames(output_data) <- c("Total", "during pregnancy", "not during pregnancy") #colnames(output_data) #c("Have you ACCESSED this service and HOW?")
#colnames(output_data) <- gsub("[ ]*HIV Status", "", colnames(output_data))
 
htmlTable::htmlTable(output_data, align = "rrrr",
          rgroup = rgroup, n.rgroup = n.rgroup, 
          css.rgroup.sep = "", 
          cgroup = cgroup,
          n.cgroup = n.cgroup,
          rowlabel = "", 
          caption = "Table 0. Vaccine data", 
          #tfoot = "P-values are from Wilcoxon rank sum tests for continuous variables and Fisher's exact tests for categorical variables",
          ctable = TRUE)# %>% htmltools::html_print()

```

<br>

<br>

```{r table 1, include = TRUE}

getT1Stat <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[, varname], 
                        data8$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat.median <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[, varname], 
                        data8$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}
getT1Stat_matage.median <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[!is.na(data8$p11_numbabies.comb), varname], 
                        data8[!is.na(data8$p11_numbabies.comb), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}
getT1Stat_numbabies <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$p1_situation___1.comb == "Yes" | data8$p1_situation___2.comb == "Yes" | data8$p1_situation___3.comb == "Yes", varname], 
                        data8[data8$p1_situation___1.comb == "Yes" | data8$p1_situation___2.comb == "Yes" | data8$p1_situation___3.comb == "Yes","vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat_diab <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl24_diabetes == "Yes" & !is.na(data8$bl24_diabetes), varname], 
                        data8[data8$bl24_diabetes == "Yes" & !is.na(data8$bl24_diabetes), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat_asthma <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl24_asthma == "Yes" & !is.na(data8$bl24_asthma), varname], 
                        data8[data8$bl24_asthma == "Yes" & !is.na(data8$bl24_asthma), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat_otherlung <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl24_otherlung == "Yes" & !is.na(data8$bl24_otherlung), varname], 
                        data8[data8$bl24_otherlung == "Yes" & !is.na(data8$bl24_otherlung), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat_htn <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl24_htn == "Yes" & !is.na(data8$bl24_htn), varname], 
                        data8[data8$bl24_htn == "Yes" & !is.na(data8$bl24_htn), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat_othercardio <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl24_othercardio == "Yes" & !is.na(data8$bl24_othercardio), varname], 
                        data8[data8$bl24_othercardio == "Yes" & !is.na(data8$bl24_othercardio), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat_thyroid <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl24_t.4moroid == "Yes" & !is.na(data8$bl24_t.4moroid), varname], 
                        data8[data8$bl24_t.4moroid == "Yes" & !is.na(data8$bl24_t.4moroid), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat_neuro <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl24_neuro == "Yes" & !is.na(data8$bl24_neuro), varname], 
                        data8[data8$bl24_neuro == "Yes" & !is.na(data8$bl24_neuro), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat_autoimmune <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl24_autoimmune == "Yes" & !is.na(data8$bl24_autoimmune), varname], 
                        data8[data8$bl24_autoimmune == "Yes" & !is.na(data8$bl24_autoimmune), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat_otherimmune <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl24_otherimmune == "Yes" & !is.na(data8$bl24_otherimmune), varname], 
                        data8[data8$bl24_otherimmune == "Yes" & !is.na(data8$bl24_otherimmune), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat_hepb <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl24_hepb == "Yes" & !is.na(data8$bl24_hepb), varname], 
                        data8[data8$bl24_hepb == "Yes" & !is.na(data8$bl24_hepb), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat_mh <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl24_mh == "Yes" & !is.na(data8$bl24_mh), varname], 
                        data8[data8$bl24_mh == "Yes" & !is.na(data8$bl24_mh), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat_other <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl24_other == "Yes" & !is.na(data8$bl24_other), varname], 
                        data8[data8$bl24_other == "Yes" & !is.na(data8$bl24_other), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat_drugs <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl30_other == "Yes" & !is.na(data8$bl30_other), varname], 
                        data8[data8$bl30_other == "Yes" & !is.na(data8$bl30_other), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat_timepreg <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl37_timespreg_unknown___999 == "No" & !is.na(data8$bl37_timespreg_unknown___999), varname], 
                        data8[data8$bl37_timespreg_unknown___999 == "No" & !is.na(data8$bl37_timespreg_unknown___999), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}


getT1Stat_nrlivebirth <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl38_livebirths_unknown___999 == "No" & !is.na(data8$bl38_livebirths_unknown___999), varname], 
                        data8[data8$bl38_livebirths_unknown___999 == "No" & !is.na(data8$bl38_livebirths_unknown___999), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}

#describeFactors(data8$bl38_livebirths == 0 & !is.na(data8$bl39_preterm))

getT1Stat_livebirthex <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl38_livebirths > 1 & !is.na(data8$bl38_livebirths), varname], 
                        data8[data8$bl38_livebirths >1 & !is.na(data8$bl38_livebirths), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}
getT1Stat_livebirthex2 <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl38_livebirths >= 1 & !is.na(data8$bl38_livebirths), varname], 
                        data8[data8$bl38_livebirths >= 1 & !is.na(data8$bl38_livebirths), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}
getT1Stat_preterm <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$p1_situation___1.comb == "Yes" | data8$p1_situation___2.comb == "Yes" | data8$p1_situation___3.comb == "Yes"| data8$p1_situation___6.comb == "Yes"| data8$p1_situation___7.comb == "Yes", varname], 
                        data8[data8$p1_situation___1.comb == "Yes" | data8$p1_situation___2.comb == "Yes" | data8$p1_situation___3.comb == "Yes"| data8$p1_situation___6.comb == "Yes"| data8$p1_situation___7.comb == "Yes","vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}


#data8$record_id[data8$p1_situation___1.comb == "No" & data8$p1_situation___2.comb == "No" & data8$p1_situation___3.comb == "No" & data8$p1_situation___6.comb == "No"& data8$p1_situation___7.comb == "No" & !is.na(data8$p3i_preterm.comb)] # 1536 1577

#View(data8[data8$record_id %in% c(1536, 1577), c("p1_situation___1.comb","p1_situation___2.comb","p1_situation___3.comb", "p1_situation___4.comb", "p1_situation___5.comb", "p1_situation___6.comb", "p1_situation___7.comb", "p1_situation___988.comb", "p1_situation___997.comb")])
#everywhere No... seems like the two people didn't answer this question. So they shouldn't also see "p3i_preterm.comb" but they actually did!


getT1Stat_gestagedel <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$bl1_currently_preg == 1 & data8$p3i_preterm.comb == "Yes" & !is.na(data8$p3i_preterm.comb), varname], 
                        data8[data8$bl1_currently_preg == 1 & data8$p3i_preterm.comb == "Yes" & !is.na(data8$p3i_preterm.comb), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}

getT1Stat_emergcs <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data8[data8$p12_delivered.comb == "C-section" & !is.na(data8$p12_delivered.comb), varname], 
                        data8[data8$p12_delivered.comb == "C-section" & !is.na(data8$p12_delivered.comb), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}



data8 <- as.data.frame(data8)
table_data <- list()

# Get the basic stats

table_data[["Maternal age at delivery"]] <- getT1Stat_matage.median("maternal_age_delivery", 1)

table_data[["61: Pre-existing health condition: Diabetes?"]] <- getT1Stat("bl24_diabetes", 1)
table_data[["62: Type of diabetes"]] <- getT1Stat_diab("bl24_diabetes_.4mope", 1)
table_data[["63: Medication for diabetes?"]] <- getT1Stat_diab("bl24_diabetes_med", 1)

table_data[["65: Pre-existing health condition: Asthma?"]] <- getT1Stat("bl24_asthma", 1)
table_data[["66: Medication for asthma?"]] <- getT1Stat_asthma("bl24_asthma_med", 1)

table_data[["68: Pre-existing health condition: Other chronic lung disease?"]] <- getT1Stat("bl24_otherlung", 1)
#table_data[["69: Specify other chronic lung disease"]] <- getT1Stat("bl24_otherlung_other", 1)
table_data[["70: Medication for other chronic lung disease?"]] <- getT1Stat_otherlung("bl24_otherlung_med", 1)

table_data[["72: Pre-existing health condition: Hypertension?"]] <- getT1Stat("bl24_htn", 1)
table_data[["73: Medication for hypertension?"]] <- getT1Stat_htn("bl24_htn_med", 1)

table_data[["75: Pre-existing health condition: Other cardiovascular disease?"]] <- getT1Stat("bl24_othercardio", 1)
#table_data[["76: Specify other cardiovascular disease"]] <- getT1Stat("bl24_othercardio_other", 1)
table_data[["77: Medication for other cardiovascular disease?"]] <- getT1Stat_othercardio("bl24_othercardio_med", 1)

table_data[["79: Pre-existing health condition: Thyroid disease"]] <- getT1Stat("bl24_t.4moroid", 1)
#table_data[["80: Specify thyroid disease"]] <- getT1Stat("bl24_t.4moroid_other", 1)
table_data[["81: Medication for thyroid disease"]] <- getT1Stat_thyroid("bl24_t.4moroid_med", 1)

table_data[["83: Pre-existing health condition: Neurological disorder"]] <- getT1Stat("bl24_neuro", 1)
#table_data[["84: Specify neurological disorder"]] <- getT1Stat("bl24_neuro_other", 1)
table_data[["85: Medication for neurological disorder"]] <- getT1Stat_neuro("bl24_neuro_med", 1)

table_data[["87: Pre-existing health condition: Autoimmune disorder"]] <- getT1Stat("bl24_autoimmune", 1)
#table_data[["88: Specify autoimmune disorder"]] <- getT1Stat("bl24_autoimmune_other", 1)
table_data[["89: Medication for autoimmune disorder"]] <- getT1Stat_autoimmune("bl24_autoimmune_med", 1)

table_data[["91: Pre-existing health condition: HIV"]] <- getT1Stat("bl24_hiv", 1)

table_data[["94: Pre-existing health condition: Other immune suppression"]] <- getT1Stat("bl24_otherimmune", 1)
#table_data[["95: Specify other immune suppression"]] <- getT1Stat("bl24_otherimmune_other", 1)
table_data[["96: Medication for other immune suppression"]] <- getT1Stat_otherimmune("bl24_otherimmune_med", 1)

table_data[["98: Pre-existing health condition: Hepatitis C"]] <- getT1Stat("bl24_hepc", 1)
table_data[["101: Pre-existing health condition: Hepatitis B"]] <- getT1Stat("bl24_hepb", 1)
table_data[["102: Medication for Hepatitis B"]] <- getT1Stat_hepb("bl24_hepb_med", 1)

table_data[["104: Pre-existing health condition: Mental health condition"]] <- getT1Stat("bl24_mh", 1)
#table_data[["105: Specify mental health condition"]] <- getT1Stat("bl24_mh_other", 1)
table_data[["106: Medication for mental health condition"]] <- getT1Stat_mh("bl24_mh_med", 1)

table_data[["108: Other pre-existing health condition"]] <- getT1Stat("bl24_other", 1)
#table_data[["109: Specify other pre-existing health condition"]] <- getT1Stat("bl24_other_speci.4mo", 1)
table_data[["110: Medication for other pre-existing health condition"]] <- getT1Stat_other("bl24_other_med", 1)

table_data[["113+114: Height"]] <- getT1Stat.median("bl25_height_comb", 1)
table_data[["116+117: Weight"]] <- getT1Stat.median("bl26_weight_comb", 1)
table_data[["BMI"]] <- getT1Stat.median("BMI", 1)

table_data[["119: Tobacco during most recent pregnancy"]] <- getT1Stat("bl27_tobacco", 1)
table_data[["120: Vape during most recent pregnancy"]] <- getT1Stat("bl28_vape", 1)
table_data[["121: Alcohol during most recent pregnancy"]] <- getT1Stat("bl29_alcohol", 1)
table_data[["123: Heroin during most recent pregnancy"]] <- getT1Stat("bl30_heroin", 1)
table_data[["124: Cocaine during most recent pregnancy"]] <- getT1Stat("bl30_cocaine", 1)
table_data[["125: Solvents during most recent pregnancy"]] <- getT1Stat("bl30_solvents", 1)
table_data[["126: Marijuana during most recent pregnancy"]] <- getT1Stat("bl30_marijuana", 1)
table_data[["127: Other drugs during most recent pregnancy"]] <- getT1Stat("bl30_other", 1)
table_data[["128: Specify other drugs during most recent pregnancy"]] <- getT1Stat_drugs("bl30_other_speci.4mo", 1)

table_data[["203: Number of pregnancies unknown?"]] <- getT1Stat("bl37_timespreg_unknown___999", 1)
table_data[["204: Number of pregnancies"]] <- getT1Stat_timepreg("bl37_timespreg", 1)
table_data[["206: Number of live births unknown?"]] <- getT1Stat("bl38_livebirths_unknown___999", 1)
table_data[["207: Number of live births"]] <- getT1Stat_nrlivebirth("bl38_livebirths", 1)
#table_data[["209: History of pre-term delivery"]] <- getT1Stat_livebirthex("bl39_preterm", 1)
table_data[["209: History of pre-term delivery"]] <- getT1Stat_livebirthex2("bl39_preterm", 1)
#table_data[["210: History of stillbirth"]] <- getT1Stat_livebirthex("bl39_stillbirth", 1)
table_data[["210: History of stillbirth"]] <- getT1Stat_livebirthex2("bl39_stillbirth", 1)
#table_data[["211: History of pre-eclampsia"]] <- getT1Stat_livebirthex("bl39_preeclampsia", 1)
table_data[["211: History of pre-eclampsia"]] <- getT1Stat_livebirthex2("bl39_preeclampsia", 1)

table_data[["281: Baby lives at home with mother"]] <- getT1Stat("p1_situation___1.comb", 1)
table_data[["281: Baby is still admitted to hospital"]] <- getT1Stat("p1_situation___2.comb", 1)
table_data[["281: Mother as gestational carrier/Adoption"]] <- getT1Stat("p1_situation___3.comb", 1)
table_data[["281: Miscarriage"]] <- getT1Stat("p1_situation___4.comb", 1)
table_data[["281: Termination of pregnancy or therapeutic abortion"]] <- getT1Stat("p1_situation___5.comb", 1)
table_data[["281: Stillborn baby"]] <- getT1Stat("p1_situation___6.comb", 1)
table_data[["281: Baby passed away after delivery"]] <- getT1Stat("p1_situation___7.comb", 1)
table_data[["281: Other situation"]] <- getT1Stat("p1_situation___988.comb", 1)
table_data[["281: Prefer not to answer"]] <- getT1Stat("p1_situation___997.comb", 1)
table_data[["Combinations of different situations"]] <- getT1Stat("p1_situation.comb", 1)

table_data[["284: Preterm birth (birth before 37 weeks of pregnancy)"]] <- getT1Stat_preterm("p3i_preterm.comb", 1)
table_data[["For preterm birth: Gestational age at delivery"]] <- getT1Stat_gestagedel("gestational_age_delivery", 1)
table_data[["For preterm birth: Gestational age at delivery (Categories)"]] <- getT1Stat_gestagedel("gestational_age_cat", 1)

table_data[["375: Number of delivered babies"]] <- getT1Stat_numbabies("p11_numbabies.comb", 1)
table_data[["376: How was the baby delivered?"]] <- getT1Stat_numbabies("p12_delivered.comb", 1)
table_data[["377: Did you have an emergency c-section?"]] <- getT1Stat_emergcs("p13_emergcs.comb", 1)

table_data[["378: Reason for C-section: Concerns about your health"]] <- getT1Stat_emergcs("p14_emergcs_reason___1.comb", 1)
table_data[["378: Reason for C-section: Concerns about the baby's health"]] <- getT1Stat_emergcs("p14_emergcs_reason___2.comb", 1)
table_data[["378: Reason for C-section: Carrying more than one baby"]] <- getT1Stat_emergcs("p14_emergcs_reason___3.comb", 1)
table_data[["378: Reason for C-section: Had C-section before"]] <- getT1Stat_emergcs("p14_emergcs_reason___4.comb", 1)
table_data[["378: Reason for C-section: Maternal choice"]] <- getT1Stat_emergcs("p14_emergcs_reason___5.comb", 1)
table_data[["378: Reason for C-section: Other"]] <- getT1Stat_emergcs("p14_emergcs_reason___998.comb", 1)
table_data[["378: Reason for C-section: Unknown"]] <- getT1Stat_emergcs("p14_emergcs_reason___999.comb", 1)
#table_data[["379: Specify other reason for C-section"]] <- getT1Stat("p14_emergcs_reason_other.comb", 1)

table_data[["381: Complications: Abnormal fetal heart rate resulting in medical intervention"]] <- getT1Stat_numbabies("p15_complications_fhr.comb", 1)
table_data[["382: Complications: Fever in labour"]] <- getT1Stat_numbabies("p15_complications_fever.comb", 1)
table_data[["383: Complications: Other"]] <- getT1Stat_numbabies("p15_complications_other.comb", 1)
#table_data[["384: Specify other complications"]] <- getT1Stat("p15_complications_info.comb", 1)


# Now merge everything into a matrix
# and create the rgroup & n.rgroup variabels
rgroup <- c()
n.rgroup <- c()
output_data <- NULL
for (varlabel in names(table_data)) {
  output_data <- rbind(output_data, 
                       table_data[[varlabel]])
  rgroup <- c(rgroup, 
              varlabel)
  n.rgroup <- c(n.rgroup, 
                nrow(table_data[[varlabel]]))
}
 
# Add a column spanner for the death columns
cgroup <- c("", "Vaccination")
n.cgroup <- c(1,3)#c(1, 3)
#colnames(output_data) <- c("Total", "during pregnancy", "not during pregnancy", "p-value") #colnames(output_data) #c("Have you ACCESSED this service and HOW?")
#colnames(output_data) <- gsub("[ ]*HIV Status", "", colnames(output_data))
 
htmlTable::htmlTable(output_data, align = "rrrr",
          rgroup = rgroup, n.rgroup = n.rgroup, 
          css.rgroup.sep = "", 
          cgroup = cgroup,
          n.cgroup = n.cgroup,
          rowlabel = "", 
          caption = "Table 1. Health condition of mother and delivery information (by vaccination during vs not during pregnancy)", 
          tfoot = "P-values are from Wilcoxon rank sum tests for continuous variables and Fisher's exact tests for categorical variables",
          ctable = TRUE)# %>% htmltools::html_print()

```

<br>

<br>



```{r preprocess extra dataset for babies only}

describeFactors(data8$month_infant_follow_up_surv.4mo_infant_complete.comb____3)
#0 "4,489 (100.0%)" 
#don't include it in here
describeFactors(data8$month_infant_follow_up_surv.4mo_infant_complete.comb____1)
#No  "3,844 (85.6%)"
#Yes "645 (14.4%)"  
describeFactors(data8$month_infant_follow_up_surv.4mo_infant_complete.comb____2)
#No  "4,483 (99.9%)"
#Yes "6 (0.1%)"     



data8$month_infant_follow_up_surv.4mo_infant_1_timestamp #NULL
data8$timestamp_6mo_followup____1 <- mapply(paste, data8$month_infant_follow_up_surv.4mo_infant_1_timestamp.2mo, data8$month_infant_follow_up_surv.4mo_infant_1_timestamp.4mo, sep="/")

describeFactors(data8$timestamp_6mo_followup____1)
data8$timestamp_6mo_followup____1 <- gsub("/NA","",data8$timestamp_6mo_followup____1)
data8$timestamp_6mo_followup____1 <- gsub("NA/","",data8$timestamp_6mo_followup____1)

describeFactors(data8$timestamp_6mo_followup____1)
data8$timestamp_6mo_followup____1[data8$timestamp_6mo_followup____1 == "NA"] <- NA
describeFactors(data8$timestamp_6mo_followup____1)

data8$month_infant_follow_up_surv.4mo_infant_2_timestamp.2mo  #NULL
data8$month_infant_follow_up_surv.4mo_infant_2_timestamp.4mo  #NULL
data8$timestamp_6mo_followup____2 <- data8$month_infant_follow_up_surv.4mo_infant_2_timestamp
describeFactors(data8$timestamp_6mo_followup____2)

data8$month_infant_follow_up_surv.4mo_infant_3_timestamp  #NULL
data8$month_infant_follow_up_surv.4mo_infant_3_timestamp.2mo  #NULL
data8$month_infant_follow_up_surv.4mo_infant_3_timestamp.4mo  #NULL


baby_col <- c("io1_height_cminches.comb____1", "io2_weight_lbskg.comb____1", "io3_feed.comb____1", "io4_routinev.2mo.comb____1", "io5_wellchild___1.comb____1", "io5_wellchild___2.comb____1", "io5_wellchild___3.comb____1", "io5_wellchild___4.comb____1", "io5_wellchild___5.comb____1", "io5_wellchild___998.comb____1", "io5_wellchild___997.comb____1", "io5_wellchild___999.comb____1", "io5_wellchild___0.comb____1", "io6_hosp.comb____1", "io8_er.comb____1", "io10_diag.comb____1", "io12_meds.comb____1", "io14_squeals.comb____1", "io15_deep.comb____1", "io16_look.comb____1", "io17_loud.comb____1", "io19_repeat.comb____1", "io18_asounds.comb____1", "io20_liftlegs.comb____1", "io21_straightenarms.comb____1", "io22_roll.comb____1", "io23_lean.comb____1", "io24_supportweight.comb____1", "io25_crawling.comb____1", "io26_grab.comb____1", "io27_bothhands.comb____1", "io28_touchcrumb.comb____1", "io29_smallt.4mo.comb____1", "io30_rakingcrumb.comb____1", "io31_onehand.comb____1", "io32_reach.comb____1", "io33_turnhead.comb____1", "io34_dropped.comb____1", "io35_mouth.comb____1", "io36_pass.comb____1", "io37_bang.comb____1", "io38_coomirror.comb____1", "io39_strangers.comb____1", "io40_footgrab.comb____1", "io41_patmirror.comb____1", "io42_footmouth.comb____1", "io43_reacht.4mo.comb____1", "io44_hearswell____1", "io44_handslegs.comb____1", "io45_bothhands____1", "io45_feetflat.comb____1", "io46_feetflat____1", "io46_quiet.comb____1", "io47_deafness.2mo.comb____1", "io48_vision.comb____1", "io49_medproblem.comb____1", "io50_wor.4mo.comb____1", "io51_concerns.comb____1", "io1_height_cminches.comb____2", "io2_weight_lbskg.comb____2", "io3_feed.comb____2", "io4_routinev.2mo.comb____2", "io5_wellchild___1.comb____2", "io5_wellchild___2.comb____2", "io5_wellchild___3.comb____2", "io5_wellchild___4.comb____2", "io5_wellchild___5.comb____2", "io5_wellchild___998.comb____2", "io5_wellchild___997.comb____2", "io5_wellchild___999.comb____2", "io5_wellchild___0.comb____2", "io6_hosp.comb____2", "io8_er.comb____2", "io10_diag.comb____2", "io12_meds.comb____2", "io14_squeals.comb____2", "io15_deep.comb____2", "io16_look.comb____2", "io17_loud.comb____2", "io18_asounds.comb____2", "io19_repeat.comb____2", "io20_liftlegs.comb____2", "io21_straightenarms.comb____2", "io22_roll.comb____2", "io23_lean.comb____2", "io24_supportweight.comb____2", "io25_crawling.comb____2", "io26_grab.comb____2", "io27_bothhands.comb____2", "io28_touchcrumb.comb____2", "io29_smallt.4mo.comb____2", "io30_rakingcrumb.comb____2", "io31_onehand.comb____2", "io32_reach.comb____2", "io33_turnhead.comb____2", "io34_dropped.comb____2", "io35_mouth.comb____2", "io36_pass.comb____2", "io37_bang.comb____2", "io38_coomirror.comb____2", "io39_strangers.comb____2", "io40_footgrab.comb____2", "io41_patmirror.comb____2", "io42_footmouth.comb____2", "io43_reacht.4mo.comb____2", "io44_handslegs.comb____2", "io45_feetflat.comb____2", "io46_quiet.comb____2", "io47_deafness.2mo.comb____2", "io48_vision.comb____2", "io49_medproblem.comb____2", "io50_wor.4mo.comb____2", "io51_concerns.comb____2",
"c1_covid.comb____1", "c2_result.comb____1", "c1_covid.comb____2", "c2_result.comb____2", "c1_covid.comb____3", "c2_result.comb____3", "n1_nicu.comb____1", "time_in_NICU____1", "n4_diagnoses.comb____1", "n1_nicu.comb____2", "time_in_NICU____2", "n4_diagnoses.comb____2", "n1_nicu.comb____3", "time_in_NICU____3", "n4_diagnoses.comb____3", "birthweight_in_g____1", "birthlength_in_cm____1", "i5_events.comb____1", "i5_events_jaundice.comb____1", "i5_events_photo.comb____1", "i5_events_seizures.comb____1", "i5_events_.4mopog.4mo.comb____1", "i5_events_fever.comb____1", "i5_events_vent.comb____1", "i5_events_other.comb____1", "birthweight_in_g____2", "birthlength_in_cm____2", "i5_events.comb____2", "i5_events_jaundice.comb____2", "i5_events_photo.comb____2", "i5_events_seizures.comb____2", "i5_events_.4mopog.4mo.comb____2", "i5_events_fever.comb____2", "i5_events_vent.comb____2", "i5_events_other.comb____2", "birthweight_in_g____3", "birthlength_in_cm____3", "i5_events.comb____3", "i5_events_jaundice.comb____3", "i5_events_seizures.comb____3", "i5_events_.4mopog.4mo.comb____3", "i5_events_fever.comb____3", "i5_events_vent.comb____3", "i5_events_other.comb____3", "timestamp_6mo_followup____1", "timestamp_6mo_followup____2")  #"month_infant_follow_up_surv.4mo_infant_complete.comb____1", "month_infant_follow_up_surv.4mo_infant_complete.comb____2", "month_infant_follow_up_surv.4mo_infant_complete.comb____3"


data_babies <- pivot_longer(
   data = data8[,c("vacc_during_preg", "p11_numbabies.comb","p1_situation___1.comb", "p1_situation___2.comb", "p1_situation___3.comb", baby_col)],   
   cols = all_of(baby_col), #ends_with("_knowledge"),
   names_to = c(".value", "infant"), #"survey_steps",
   #names_prefix = "wk",
   names_pattern =  "(.*)____(.)",  #"(.*)_knowledge",
   #values_to = "knowledge_score",
   values_drop_na = TRUE
 )
view(data_babies)

nrow(data_babies)  # 8979
nrow(data8) #4489
describeFactors(data_babies$infant)
#1 "4,489 (50.0%)"
#2 "4,489 (50.0%)"
#3 "1 (0.0%)"

```

```{r table 2 infant, include = TRUE}

getT1Stat <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data_babies[, varname], 
                        data_babies$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat.median <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data_babies[, varname], 
                        data_babies$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}

getT1Stat_baby <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data_babies[(data_babies$p1_situation___1.comb == "Yes" | data_babies$p1_situation___2.comb == "Yes" | data_babies$p1_situation___3.comb == "Yes") & !is.na(data_babies$p11_numbabies.comb) & 
(data_babies$infant == 1 | 
(data_babies$infant == 2 & (data_babies$p11_numbabies.comb == "twins" | data_babies$p11_numbabies.comb == "triplets or more"))|
(data_babies$infant == 3 & data_babies$p11_numbabies.comb == "triplets or more")), varname], 
                        data_babies[(data_babies$p1_situation___1.comb == "Yes" | data_babies$p1_situation___2.comb == "Yes" | data_babies$p1_situation___3.comb == "Yes") & !is.na(data_babies$p11_numbabies.comb) & 
(data_babies$infant == 1 | 
(data_babies$infant == 2 & (data_babies$p11_numbabies.comb == "twins" | data_babies$p11_numbabies.comb == "triplets or more"))|
(data_babies$infant == 3 & data_babies$p11_numbabies.comb == "triplets or more")), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}



getT1Stat_events <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data_babies[data_babies$i5_events.comb == "Yes" & !is.na(data_babies$i5_events.comb), varname], 
                        data_babies[data_babies$i5_events.comb == "Yes" & !is.na(data_babies$i5_events.comb), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}
getT1Stat_photo <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data_babies[data_babies$i5_events_jaundice.comb == "Yes" & !is.na(data_babies$i5_events_jaundice.comb), varname], 
                        data_babies[data_babies$i5_events_jaundice.comb == "Yes" & !is.na(data_babies$i5_events_jaundice.comb), "vacc_during_preg"],
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}

data_babies <- as.data.frame(data_babies)
table_data <- list()

# Get the basic stats
table_data[["Birthweight in g"]] <- getT1Stat_baby("birthweight_in_g", 1)
#table_data[["Birthweight in g (with missing)"]] <- getT1Stat.median("birthweight_in_g", 1)
table_data[["Birthlength in cm"]] <- getT1Stat_baby("birthlength_in_cm", 1)
#table_data[["Birthlength in cm (with missing)"]] <- getT1Stat.median("birthlength_in_cm", 1)

table_data[["Health events between birth and discharge?"]] <- getT1Stat_baby("i5_events.comb", 1)
#table_data[["Health events between birth and discharge? (with missing)"]] <- getT1Stat("i5_events.comb", 1)
table_data[["Jaundice?"]] <- getT1Stat_events("i5_events_jaundice.comb", 1)
#table_data[["Jaundice? (with missing)"]] <- getT1Stat("i5_events_jaundice.comb", 1)
table_data[["Phototherapy required?"]] <- getT1Stat_photo("i5_events_photo.comb", 1)
#table_data[["Phototherapy required?(with missing)"]] <- getT1Stat("i5_events_photo.comb", 1)
table_data[["Any seizures?"]] <- getT1Stat_events("i5_events_seizures.comb", 1)
#table_data[["Any seizures? (with missing)"]] <- getT1Stat("i5_events_seizures.comb", 1)
table_data[["Hypoglycemia (low blood sugar)?"]] <- getT1Stat_events("i5_events_.4mopog.4mo.comb", 1)
#table_data[["Hypoglycemia (low blood sugar)? (with missing)"]] <- getT1Stat("i5_events_.4mopog.4mo.comb", 1)
table_data[["Fever and/or need antibiotics?"]] <- getT1Stat_events("i5_events_fever.comb", 1)
#table_data[["Fever and/or need antibiotics? (with missing)"]] <- getT1Stat("i5_events_fever.comb", 1)
table_data[["Breathing/mechanical ventilation support needed?"]] <- getT1Stat_events("i5_events_vent.comb", 1)
#table_data[["Breathing/mechanical ventilation support needed? (with missing)"]] <- getT1Stat("i5_events_vent.comb", 1)
table_data[["Other infant health events?"]] <- getT1Stat_events("i5_events_other.comb", 1)
#table_data[["Other infant health events? (with missing)"]] <- getT1Stat("i5_events_other.comb", 1)
#table_data[["Specify other infant health events"]] <- getT1Stat("i5_events_other_info1", 1)


# Now merge everything into a matrix
# and create the rgroup & n.rgroup variabels
rgroup <- c()
n.rgroup <- c()
output_data <- NULL
for (varlabel in names(table_data)) {
  output_data <- rbind(output_data, 
                       table_data[[varlabel]])
  rgroup <- c(rgroup, 
              varlabel)
  n.rgroup <- c(n.rgroup, 
                nrow(table_data[[varlabel]]))
}
 
# Add a column spanner for the death columns
cgroup <- c("", "Vaccination")
n.cgroup <- c(1,3)#c(1, 3)
#colnames(output_data) <- c("Total", "during pregnancy", "not during pregnancy", "p-value") #   colnames(output_data) #c("Have you ACCESSED this service and HOW?")
#colnames(output_data) <- gsub("[ ]*HIV Status", "", colnames(output_data))
 
htmlTable::htmlTable(output_data, align = "rrrr",
          rgroup = rgroup, n.rgroup = n.rgroup, 
          css.rgroup.sep = "", 
          cgroup = cgroup,
          n.cgroup = n.cgroup,
          rowlabel = "", 
          caption = "Table 2. Birth data and health events (by vaccination during vs not during pregnancy)", 
          tfoot = "P-values are from Wilcoxon rank sum tests for continuous variables and Fisher's exact tests for categorical variables",
          ctable = TRUE)# %>% htmltools::html_print()

```


<br>

<br>

```{r table 3, include = TRUE}

getT1Stat <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data_babies[, varname], 
                        data_babies$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat.median <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data_babies[, varname], 
                        data_babies$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}
getT1Stat_nicu <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data_babies[data_babies$n1_nicu.comb == "Yes" & !is.na(data_babies$n1_nicu.comb), varname], 
                        data_babies[data_babies$n1_nicu.comb == "Yes" & !is.na(data_babies$n1_nicu.comb), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}
getT1Stat_test <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data_babies[data_babies$c1_covid.comb == "Yes" & !is.na(data_babies$c1_covid.comb), varname], 
                        data_babies[data_babies$c1_covid.comb == "Yes" & !is.na(data_babies$c1_covid.comb), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}

getT1Stat_baby <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data_babies[(data_babies$p1_situation___1.comb == "Yes" | data_babies$p1_situation___2.comb == "Yes" | data_babies$p1_situation___3.comb == "Yes") & !is.na(data_babies$p11_numbabies.comb) & 
(data_babies$infant == 1 | 
(data_babies$infant == 2 & (data_babies$p11_numbabies.comb == "twins" | data_babies$p11_numbabies.comb == "triplets or more"))|
(data_babies$infant == 3 & data_babies$p11_numbabies.comb == "triplets or more")), varname], 
                        data_babies[(data_babies$p1_situation___1.comb == "Yes" | data_babies$p1_situation___2.comb == "Yes" | data_babies$p1_situation___3.comb == "Yes") & !is.na(data_babies$p11_numbabies.comb) & 
(data_babies$infant == 1 | 
(data_babies$infant == 2 & (data_babies$p11_numbabies.comb == "twins" | data_babies$p11_numbabies.comb == "triplets or more"))|
(data_babies$infant == 3 & data_babies$p11_numbabies.comb == "triplets or more")), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}



#getT1Stat_baby2 <- function(varname, digits=0, useNA = "ifany"){
#  getDescriptionStatsBy(data_babies[(data_babies$p1_situation___1.comb == "Yes" | data_babies$p1_situation___2.comb == "Yes" | #data_babies$p1_situation___3.comb == "Yes") & 
#(data_babies$infant == 1 | 
#(data_babies$infant == 2 & (data_babies$p11_numbabies.comb == "twins" | data_babies$p11_numbabies.comb == "triplets or more"))|
#(data_babies$infant == 3 & data_babies$p11_numbabies.comb == "triplets or more")), varname], 
#                        data_babies[(data_babies$p1_situation___1.comb == "Yes" | data_babies$p1_situation___2.comb == "Yes" | #data_babies$p1_situation___3.comb == "Yes") &
#(data_babies$infant == 1 | 
#(data_babies$infant == 2 & (data_babies$p11_numbabies.comb == "twins" | data_babies$p11_numbabies.comb == "triplets or more"))|
#(data_babies$infant == 3 & data_babies$p11_numbabies.comb == "triplets or more")), "vacc_during_preg"], 
#                        add_total_col=TRUE,
#                        show_all_values=TRUE, 
#                        hrzl_prop=FALSE,
#                        statistics=TRUE, 
#                        html=TRUE, 
#                        useNA = useNA,
#                        header_count = TRUE,
#                        digits=digits,
#                        continuous_fn=describeMedian)
#}

#View(data_babies[(data_babies$p1_situation___1.comb == "No" & data_babies$p1_situation___2.comb == "No" & data_babies$p1_situation___3.comb == "No") & !is.na(data_babies$p11_numbabies.comb) & 
#(data_babies$infant == 1 | 
#(data_babies$infant == 2 & (data_babies$p11_numbabies.comb == "twins" | data_babies$p11_numbabies.comb == "triplets or more"))|
#(data_babies$infant == 3 & data_babies$p11_numbabies.comb == "triplets or more")),])

#View(data_babies[!is.na(data_babies$infant) &is.na(data_babies$p11_numbabies.comb) & 
#(data_babies$infant == 1 | 
#(data_babies$infant == 2 & (data_babies$p11_numbabies.comb == "twins" | data_babies$p11_numbabies.comb == "triplets or #more"))|
#(data_babies$infant == 3 & data_babies$p11_numbabies.comb == "triplets or more")), c("infant", "p11_numbabies.comb", #"p1_situation___1.comb", "p1_situation___2.comb", "p1_situation___3.comb", "c2_result.comb")])

#describeFactors(data_babies$c2_result.comb[(!is.na(data_babies$infant) &is.na(data_babies$p11_numbabies.comb) & 
#(data_babies$infant == 1 | 
#(data_babies$infant == 2 & (data_babies$p11_numbabies.comb == "twins" | data_babies$p11_numbabies.comb == "triplets or #more"))|
#(data_babies$infant == 3 & data_babies$p11_numbabies.comb == "triplets or more")))& is.na(data_babies$c2_result.comb)])


data_babies <- as.data.frame(data_babies)
table_data <- list()

# Get the basic stats
table_data[["Was your baby admitted to NICU?"]] <- getT1Stat_baby("n1_nicu.comb", 1)
#table_data[["Was your baby admitted to NICU? (with missing)"]] <- getT1Stat("n1_nicu.comb", 1)
table_data[["Number of days in NICU"]] <- getT1Stat_nicu("time_in_NICU", 1)
#table_data[["Number of days in NICU (with missing)"]] <- getT1Stat.median("time_in_NICU", 1)
table_data[["Any diagnoses given in NICU?"]] <- getT1Stat_nicu("n4_diagnoses.comb", 1)
#table_data[["Any diagnoses given in NICU? (with missing)"]] <- getT1Stat("n4_diagnoses.comb", 1)

table_data[["Was your baby tested for COVID-19?"]] <- getT1Stat_baby("c1_covid.comb", 1)
#table_data[["Was your baby tested for COVID-19? (with missing)"]] <- getT1Stat("c1_covid.comb", 1)
table_data[["What was the result?"]] <- getT1Stat_test("c2_result.comb", 1)
#table_data[["What was the result? (with missing)"]] <- getT1Stat("c2_result.comb", 1)



# Now merge everything into a matrix
# and create the rgroup & n.rgroup variabels
rgroup <- c()
n.rgroup <- c()
output_data <- NULL
for (varlabel in names(table_data)) {
  output_data <- rbind(output_data, 
                       table_data[[varlabel]])
  rgroup <- c(rgroup, 
              varlabel)
  n.rgroup <- c(n.rgroup, 
                nrow(table_data[[varlabel]]))
}
 
# Add a column spanner for the death columns
cgroup <- c("", "Vaccination")
n.cgroup <- c(1,3)#c(1, 3)
#colnames(output_data) <- c("Total", "during pregnancy", "not during pregnancy", "p-value") #colnames(output_data) #c("Have you ACCESSED this service and HOW?")
#colnames(output_data) <- gsub("[ ]*HIV Status", "", colnames(output_data))
 
htmlTable::htmlTable(output_data, align = "rrrr",
          rgroup = rgroup, n.rgroup = n.rgroup, 
          css.rgroup.sep = "", 
          cgroup = cgroup,
          n.cgroup = n.cgroup,
          rowlabel = "", 
          caption = "Table 3. INFORMATION about NICU admission and INFANT COVID-19 TESTING (by vaccination during vs not during pregnancy)", 
          tfoot = "P-values are from Wilcoxon rank sum tests for continuous variables and Fisher's exact tests for categorical variables",
          ctable = TRUE)# %>% htmltools::html_print()

```


<br>

<br>

```{r preprocess table 4}

View(data_babies[data_babies$io5_wellchild___3.comb == "Yes" & is.na(data_babies$timestamp_6mo_followup),])
data_babies$timestamp_6mo_followup[data_babies$io5_wellchild___3.comb == "Yes" & is.na(data_babies$timestamp_6mo_followup)] <- "[not complete]"

```


```{r table 4, include = TRUE}

getT1Stat <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data_babies[, varname], 
                        data_babies$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits)
}
getT1Stat.median <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data_babies[, varname], 
                        data_babies$vacc_during_preg, 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}

getT1Stat.median.baby <- function(varname, digits=0, useNA = "ifany"){
  getDescriptionStatsBy(data_babies[!is.na(data_babies$timestamp_6mo_followup), varname], 
                        data_babies[!is.na(data_babies$timestamp_6mo_followup), "vacc_during_preg"], 
                        add_total_col=TRUE,
                        show_all_values=TRUE, 
                        hrzl_prop=FALSE,
                        statistics=TRUE, 
                        html=TRUE, 
                        useNA = useNA,
                        header_count = TRUE,
                        digits=digits,
                        continuous_fn=describeMedian)
}

  
data_babies <- as.data.frame(data_babies)
table_data <- list()

# Get the basic stats
table_data[["Infant's height in cm"]] <- getT1Stat.median.baby("io1_height_cminches.comb", 1)
table_data[["Infant's weight in kg"]] <- getT1Stat.median.baby("io2_weight_lbskg.comb", 1)
table_data[["What do you mostly feed your infant?"]] <- getT1Stat.median.baby("io3_feed.comb", 1)
table_data[["Has your infant received all their routine immunizations to date?"]] <- getT1Stat.median.baby("io4_routinev.2mo.comb", 1)
table_data[["Infant attended well-child visit after 1 week"]] <- getT1Stat.median.baby("io5_wellchild___1.comb", 1)
table_data[["Infant attended well-child visit after 2 months"]] <- getT1Stat.median.baby("io5_wellchild___2.comb", 1)
table_data[["Infant attended well-child visit after 4 months"]] <- getT1Stat.median.baby("io5_wellchild___3.comb", 1)
table_data[["Infant attended well-child visit after 6 months"]] <- getT1Stat.median.baby("io5_wellchild___4.comb", 1)
table_data[["Infant attended well-child visit virtual"]] <- getT1Stat.median.baby("io5_wellchild___5.comb", 1)
table_data[["Infant attended well-child visit: Other"]] <- getT1Stat.median.baby("io5_wellchild___998.comb", 1)
table_data[["Infant attended well-child visit: Prefer not to answer"]] <- getT1Stat.median.baby("io5_wellchild___997.comb", 1)
table_data[["Infant attended well-child visit: Don't know"]] <- getT1Stat.median.baby("io5_wellchild___999.comb", 1)
table_data[["Infant attended no well-child visit"]] <- getT1Stat.median.baby("io5_wellchild___0.comb", 1)

table_data[["Has your infant been hospitalized since being discharged at birth?"]] <- getT1Stat.median.baby("io6_hosp.comb", 1)
table_data[["Have you had to attend the emergency room with your infant since birth?"]] <- getT1Stat.median.baby("io8_er.comb", 1)
table_data[["Has your infant been diagnosed with ANY medical condition?"]] <- getT1Stat.median.baby("io10_diag.comb", 1)
table_data[["Is your infant taking any medications?"]] <- getT1Stat.median.baby("io12_meds.comb", 1)
table_data[["Does your baby make high-pitched squeals?"]] <- getT1Stat.median.baby("io14_squeals.comb", 1)
table_data[["When playing with sounds, does your baby make grunting, growling, or other deep-toned sounds?"]] <- getT1Stat.median.baby("io15_deep.comb", 1)
table_data[["If you call your baby when you are out of sight, does she/he look in the direction of your voice?"]] <- getT1Stat.median.baby("io16_look.comb", 1)
table_data[["When a loud noise occurs, does your baby turn to see where the sound came from?"]] <- getT1Stat.median.baby("io17_loud.comb", 1)
table_data[["Does your baby make sounds like \"da,\" \"ga,\" \"ka,\" and \"ba\"?"]] <- getT1Stat.median.baby("io18_asounds.comb", 1)
table_data[["If you copy the sounds your baby makes, does your baby repeat the sounds back to you?"]] <- getT1Stat.median.baby("io19_repeat.comb", 1)
table_data[["While on his/her back, does your baby lift his/her legs high enough to see his/her feet?"]] <- getT1Stat.median.baby("io20_liftlegs.comb", 1)
table_data[["When she/he is on her/his tummy, does your baby straighten both arms and push his/her whole chest off the bed or floor?"]] <- getT1Stat.median.baby("io21_straightenarms.comb", 1)
table_data[["Does your baby roll from his/her back to his/her tummy, getting both arms out from under him/her?"]] <- getT1Stat.median.baby("io22_roll.comb", 1)
table_data[["When you put him/her on the floor, does your baby lean on his/her hands while sitting?"]] <- getT1Stat.median.baby("io23_lean.comb", 1)
table_data[["If you hold both hands just to balance her/him, does your baby support her/his own weight while standing?"]] <- getT1Stat.median.baby("io24_supportweight.comb", 1)
table_data[["Does your baby get into a crawling position by getting up on her/his hands and knees?"]] <- getT1Stat.median.baby("io25_crawling.comb", 1)
table_data[["Does your baby grab a toy you offer and look at it, wave it about, or chew on it for about 1 minute?"]] <- getT1Stat.median.baby("io26_grab.comb", 1)
table_data[["Does your baby reach for or grasp a toy by using both hands at once?"]] <- getT1Stat.median.baby("io27_bothhands.comb", 1)
table_data[["Does your baby reach for a crumb or Cheerio and touch it with his/her finger? ("]] <- getT1Stat.median.baby("io28_touchcrumb.comb", 1)
table_data[["Does your baby pick up a small toy, holding it in the center of his/her hands with his/her fingers around it?"]] <- getT1Stat.median.baby("io29_smallt.4mo.comb", 1)
table_data[["Does your baby try to pick up a crumb or Cheerio by using his/her thumb and all his/her fingers in a raking motion, even if he/she isn't able to pick it up?"]] <- getT1Stat.median.baby("io30_rakingcrumb.comb", 1)
table_data[["Does your baby usually pick up a small toy with only one hand?"]] <- getT1Stat.median.baby("io31_onehand.comb", 1)
table_data[["When a toy is in front of her/him, does your baby reach for it with both hands?"]] <- getT1Stat.median.baby("io32_reach.comb", 1)
table_data[["When he/she is on his/her back, does your baby turn his/her head to look for a toy when he/she drops it?"]] <- getT1Stat.median.baby("io33_turnhead.comb", 1)
table_data[["When he/she is on his/her back, does your baby try to get a toy she has dropped if he/she can see it?"]] <- getT1Stat.median.baby("io34_dropped.comb", 1)
table_data[["Does your baby often pick up toys and put them in his/her mouth?"]] <- getT1Stat.median.baby("io35_mouth.comb", 1)
table_data[["Does your baby pass a toy back and forth from one hand to the other?"]] <- getT1Stat.median.baby("io36_pass.comb", 1)
table_data[["Does your baby play by banging a toy up and down on the floor or table?"]] <- getT1Stat.median.baby("io37_bang.comb", 1)
table_data[["When in front of a large mirror, does your baby smile or coo at herself/himself?"]] <- getT1Stat.median.baby("io38_coomirror.comb", 1)
table_data[["Does your baby act differently towards strangers than he/she does with you and other familiar people?"]] <- getT1Stat.median.baby("io39_strangers.comb", 1)
table_data[["While lying on her/his back, does your baby play by grabbing her/his foot?"]] <- getT1Stat.median.baby("io40_footgrab.comb", 1)
table_data[["When in front of a large mirror, does your baby reach out to pat the mirror?"]] <- getT1Stat.median.baby("io41_patmirror.comb", 1)
table_data[["While on his/her back, does your baby put his foot in his/her mouth?"]] <- getT1Stat.median.baby("io42_footmouth.comb", 1)
table_data[["Does your baby try to get a toy that is out of reach?"]] <- getT1Stat.median.baby("io43_reacht.4mo.comb", 1)
table_data[["Do you think your child hears well?"]] <- getT1Stat.median.baby("io44_hearswell", 1)
table_data[["Does your baby use both hands and legs equally well?"]] <- getT1Stat.median.baby("io44_handslegs.comb", 1)
table_data[["Does your baby use both hands equally well?"]] <- getT1Stat.median.baby("io45_bothhands", 1)
table_data[["When you help your baby stand, are his/her feet flat on the surface most of the time?"]] <- getT1Stat.median.baby("io45_feetflat.comb", 1)
table_data[["When you help your baby stand, are his/her feet flat on the surface most of the time?"]] <- getT1Stat.median.baby("io46_feetflat", 1)
table_data[["Do you have concerns that your baby is too quiet or does not make sounds like other babies?"]] <- getT1Stat.median.baby("io46_quiet.comb", 1)
table_data[["Does either parent have a family history of childhood deafness or hearing impairment?"]] <- getT1Stat.median.baby("io47_deafness.2mo.comb", 1)
table_data[["Do you have concerns about your child's vision?"]] <- getT1Stat.median.baby("io48_vision.comb", 1)
table_data[["Has your child had any medical problems in the last several months?"]] <- getT1Stat.median.baby("io49_medproblem.comb", 1)
table_data[["Does anything about your child worry you?"]] <- getT1Stat.median.baby("io50_wor.4mo.comb", 1)
table_data[["Do you have any concerns about your baby's behaviour?"]] <- getT1Stat.median.baby("io51_concerns.comb", 1)
#table_data[["Complete 6 months infant 1 follow up survey"]] <- getT1Stat.median.baby("month_infant_follow_up_surv.4mo_infant_complete.comb", 1)




# Now merge everything into a matrix
# and create the rgroup & n.rgroup variabels
rgroup <- c()
n.rgroup <- c()
output_data <- NULL
for (varlabel in names(table_data)) {
  output_data <- rbind(output_data, 
                       table_data[[varlabel]])
  rgroup <- c(rgroup, 
              varlabel)
  n.rgroup <- c(n.rgroup, 
                nrow(table_data[[varlabel]]))
}
 
# Add a column spanner for the death columns
cgroup <- c("", "Vaccination")
n.cgroup <- c(1,3)#c(1, 3)
#colnames(output_data) <- c("Total", "during pregnancy", "not during pregnancy", "p-value") #colnames(output_data) #c("Have you ACCESSED this service and HOW?")
#colnames(output_data) <- gsub("[ ]*HIV Status", "", colnames(output_data))
 
htmlTable::htmlTable(output_data, align = "rrrr",
          rgroup = rgroup, n.rgroup = n.rgroup, 
          css.rgroup.sep = "", 
          cgroup = cgroup,
          n.cgroup = n.cgroup,
          rowlabel = "", 
          caption = "Table 4. 6-month Infant Follow Up Survey (by vaccination during vs not during pregnancy)", 
          tfoot = "P-values are from Wilcoxon rank sum tests for continuous variables and Fisher's exact tests for categorical variables",
          ctable = TRUE)# %>% htmltools::html_print()

```



